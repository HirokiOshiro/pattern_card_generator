<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Éë„Çø„Éº„É≥„Ç´„Éº„ÉâÁîüÊàê„ÉÑ„Éº„É´</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: '„Éí„É©„ÇÆ„ÉéËßí„Ç¥ ProN', 'Hiragino Kaku Gothic ProN', 'Ê∏∏„Ç¥„Ç∑„ÉÉ„ÇØ', YuGothic, '„É°„Ç§„É™„Ç™', Meiryo, sans-serif;
            background: #f5f7fa;
            color: #333;
            line-height: 1.6;
            overflow-x: auto;
        }
        
        .header {
            background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 25%, #CDDC39 50%, #FFC107 75%, #ff0c9ea6 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            font-size: 1.8em;
            font-weight: 700;
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: #4CAF50;
            color: white;
        }
        
        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #dee2e6;
        }
        
        .header .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
            box-sizing: border-box;
        }
        
        /* 1200px‰ª•‰∏ã„Åß„ÅØÂÖ®ÂπÖ‰ΩøÁî® */
        @media (max-width: 1200px) {
            .container {
                max-width: 100vw;
                margin: 0;
            }
        }
        
        .main-content {
            display: flex;
            gap: 30px;
            margin-top: 20px;
            width: 100%;
            max-width: 100%;
            align-items: flex-start;
        }
        
        .sidebar {
            flex: 0 0 350px;
            min-width: 300px;
        }
        
        .main-area {
            flex: 1;
            min-width: 0;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        .sidebar {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
            font-size: 14px;
        }
        
        .form-group select,
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
            font-family: inherit;
        }
        
        .form-group select:focus,
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        /* „Éï„Ç©„É≥„ÉàÈÅ∏ÊäûÁâπÊúâ„ÅÆ„Çπ„Çø„Ç§„É´ */
        #fontSelect {
            font-weight: 500;
            background: #fafbfc;
        }
        
        #fontSelect option {
            padding: 8px;
        }
        
        .templates {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .template-btn {
            aspect-ratio: 3/2;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 500;
            background: white;
            position: relative;
            overflow: hidden;
        }
        
        .template-btn:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
        }
        
        .template-btn.active {
            border: 3px solid #667eea;
            background: #f8f9ff;
            color: #667eea;
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.25);
            font-weight: 600;
        }
        
        .template-btn.active::before {
            content: '‚úì';
            position: absolute;
            top: 4px;
            right: 6px;
            font-size: 14px;
            font-weight: bold;
            color: #667eea;
            background: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 6px rgba(102, 126, 234, 0.3);
        }
        
        .template-academic { background: linear-gradient(135deg, #ffffff, #d0d0d0); }
        .template-nature { background: linear-gradient(135deg, #259e56, #f4f269); }
        .template-warm { background: linear-gradient(135deg, #fff95b, #ff930f); }
        .template-elegant { background: linear-gradient(135deg, #d4af37, #c0c0c0); }
        .template-pastel { background: linear-gradient(135deg, #e9e9b7, #d3f3f1); }
        .template-spring { background: linear-gradient(135deg, #fce9d7, #eed4e8); }
        .template-summer { background: linear-gradient(135deg, #f6f6f6, #2c6cbc); }
        .template-autumn { background: linear-gradient(135deg, #fdd57e, #924e8c); }
        .template-winter { background: linear-gradient(135deg, #f1f5f9, #475569); }
        .template-custom { background: linear-gradient(135deg, #f5f5f5, #e8e8e8); }
        
        /* „Ç´„É©„Éº„Ç´„Çπ„Çø„Éû„Ç§„Ç∫Áî®„Çπ„Çø„Ç§„É´ */
        .color-customization {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
            background: #fafafa;
        }
        
        .color-inputs {
            display: grid;
            gap: 10px;
        }
        
        .color-input-group {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .color-input-group label {
            font-size: 12px;
            color: #555;
            margin: 0;
        }
        
        .color-input-group input[type="color"] {
            width: 50px;
            height: 30px;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            padding: 0;
        }
        
        .palette-management {
            border-top: 1px solid #e0e0e0;
            margin-top: 10px;
            padding-top: 10px;
        }
        
        .saved-palette {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 5px 8px;
            margin: 5px 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .palette-colors {
            display: flex;
            gap: 3px;
        }
        
        .palette-color-dot {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 1px solid #ccc;
        }
        
        .palette-actions {
            display: flex;
            gap: 3px;
        }
        
        .palette-action-btn {
            padding: 2px 6px;
            font-size: 10px;
            border: 1px solid #ccc;
            background: white;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .palette-action-btn:hover {
            background: #f0f0f0;
        }
        
        /* „Ç´„É©„Éº„Ç´„Çπ„Çø„Éû„Ç§„Ç∫Â∞ÇÁî®„Çπ„Çø„Ç§„É´ */
        .custom-color-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 10px;
            background: #f8f9fa;
            border: 1px solid #e1e8ed;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 12px;
            font-size: 13px;
            font-weight: 500;
        }
        
        .custom-color-toggle:hover {
            background: #f0f4f8;
            border-color: #d1d9e0;
        }
        
        .custom-color-toggle input[type="checkbox"] {
            width: 16px;
            height: 16px;
            margin: 0;
            cursor: pointer;
        }
        
        .custom-color-toggle.active {
            background: #e8f4f8;
            border-color: #667eea;
            color: #2c5aa0;
        }
        .template-custom { background: #ffffff; border: 2px solid #e1e8ed; }
        
        
        .preview-section {
            margin-bottom: 30px;
        }
        
        .preview-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .preview-header h2 {
            font-size: 1.4em;
            color: #444;
        }
        
        .canvas-container {
            border: 2px solid #e1e8ed;
            border-radius: 12px;
            overflow: hidden;
            background: #fafbfc;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            max-width: 100%;
            width: 100%;
            margin: 0 auto;
            min-height: 200px;
        }
        
        #cardCanvas {
            border: 1px solid #ddd;
            display: block;
            margin: 0 auto;
            max-width: 100%;
            max-height: 80vh;
        }
        
        .batch-section {
            border-top: 2px solid #f1f3f4;
            padding-top: 30px;
        }
        
        .batch-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .pattern-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            padding: 15px;
            background: #fafbfc;
        }
        
        .pattern-item {
            padding: 4px 6px;
            border: 1px solid #e1e8ed;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            text-align: center;
            font-size: 11px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 60px;
            word-wrap: break-word;
            overflow: hidden;
            position: relative;
        }
        
        .pattern-item:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(102, 126, 234, 0.12);
        }
        
        .pattern-item.selected {
            background: #f8f9ff;
            color: #667eea;
            border: 2px solid #667eea;
            font-weight: 600;
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.2);
        }
        
        .pattern-item.selected::before {
            content: '‚úì';
            position: absolute;
            top: 2px;
            right: 3px;
            font-size: 10px;
            font-weight: bold;
            color: #667eea;
            background: white;
            border-radius: 50%;
            width: 14px;
            height: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 1px 3px rgba(102, 126, 234, 0.3);
            z-index: 1;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e1e8ed;
            border-radius: 3px;
            overflow: hidden;
            margin: 20px 0;
            display: none;
        }
        
        .progress-fill {
            height: 100%;
            background: #4CAF50;
            transition: width 0.3s ease;
            width: 0%;
        }
        
        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú: 1024px‰ª•‰∏ãÔºà‰∏≠Âûã„Çø„Éñ„É¨„ÉÉ„ÉàÔºâ */
        @media (max-width: 1024px) {
            .container {
                padding: 15px;
            }
            
            .main-content {
                gap: 20px;
            }
            
            .sidebar {
                flex: 0 0 280px;
                min-width: 250px;
                position: static;
            }
            
            #cardCanvas {
                max-width: 100%;
                width: auto !important;
                height: auto !important;
            }
            
            .canvas-container {
                padding: 15px;
                min-height: 150px;
            }
        }
        
        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú: 900px‰ª•‰∏ãÔºàÂ∞èÂûã„Çø„Éñ„É¨„ÉÉ„ÉàÁ∏¶Âêë„ÅçÔºâ */
        @media (max-width: 900px) {
            .sidebar {
                flex: 0 0 260px;
                min-width: 240px;
            }
            
            .main-content {
                gap: 15px;
            }
        }
        
        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú: 768px‰ª•‰∏ãÔºà„Çø„Éñ„É¨„ÉÉ„ÉàÁ∏¶Âêë„ÅçÔºâ */
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .sidebar {
                flex: none;
                width: 100%;
                min-width: unset;
                padding: 25px;
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            }
            
            .main-area {
                width: 100%;
                padding: 25px;
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
                padding: 0 10px;
            }
            
            .header-actions {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            #cardCanvas {
                max-width: 100%;
                width: auto !important;
                height: auto !important;
            }
            
            .canvas-container {
                padding: 15px;
                min-height: 120px;
            }
            
            .pattern-grid {
                grid-template-columns: repeat(6, 1fr);
            }
            
            .csv-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .file-name-controls {
                margin-left: 0 !important;
                margin-top: 10px;
            }
        }
        
        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú: 600px‰ª•‰∏ãÔºàÂ∞èÂûã„Çø„Éñ„É¨„ÉÉ„ÉàÁ∏¶Âêë„ÅçÔºâ */
        @media (max-width: 600px) {
            .container {
                padding: 12px;
            }
            
            .sidebar {
                padding: 20px;
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            }
            
            .main-area {
                padding: 20px;
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            }
        }
        
        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú: iPhone */
        @media (max-width: 480px) {
            .header-content {
                padding: 0 8px;
            }
            
            .header h1 {
                font-size: 1.4em;
            }
            
            .header-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .btn {
                padding: 8px 16px;
                font-size: 13px;
            }
            
            .container {
                padding: 10px;
            }
            
            .sidebar {
                padding: 15px;
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            }
            
            .main-area {
                padding: 15px;
                border-radius: 12px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            }
            
            #cardCanvas {
                max-width: 100%;
                width: auto !important;
                height: auto !important;
            }
            
            .canvas-container {
                padding: 10px;
                min-height: 100px;
            }
            
            .pattern-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 6px;
                padding: 10px;
            }
            
            .pattern-item {
                min-height: 50px;
                font-size: 10px;
                padding: 3px 5px;
            }
            
            .form-group {
                margin-bottom: 20px;
            }
            
            .form-group label {
                font-size: 13px;
            }
            
            .form-group select,
            .form-group input,
            .form-group textarea {
                padding: 10px;
                font-size: 13px;
            }
        }
        
        .info-panel {
            background: #f8f9ff;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .info-panel h3 {
            color: #667eea;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .info-panel p {
            font-size: 13px;
            color: #666;
            line-height: 1.5;
        }
        
        /* CSVÁ∑®ÈõÜÈñ¢ÈÄ£„Çπ„Çø„Ç§„É´ */
        .csv-row-editing {
            background: #fff3cd !important;
            border: 2px solid #ffc107 !important;
        }
        
        .csv-edit-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 10px;
            transition: all 0.2s ease;
        }
        
        .csv-edit-button:hover {
            background: #5a6fd8;
            transform: translateY(-1px);
        }

        /* AIÊ¥ªÁî®„Ç¨„Ç§„ÉâÈñ¢ÈÄ£„Çπ„Çø„Ç§„É´ */
        .ai-guide-section {
            margin-bottom: 30px;
            border: 2px solid #e8f4fd;
            border-radius: 12px;
            background: linear-gradient(135deg, #f8fcff, #e8f4fd);
            overflow: hidden;
        }

        .ai-guide-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .ai-guide-header:hover {
            background: linear-gradient(135deg, #5a6fd8, #6842a0);
        }

        .ai-guide-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 16px;
        }

        .ai-guide-toggle {
            font-size: 18px;
            transition: transform 0.3s ease;
        }

        .ai-guide-toggle.expanded {
            transform: rotate(180deg);
        }

        .ai-guide-content {
            padding: 20px;
            display: none;
        }

        .ai-guide-content.expanded {
            display: block;
        }

        .template-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .template-card {
            border: 1px solid #e0e7ff;
            border-radius: 8px;
            padding: 15px;
            background: white;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
            border-color: #667eea;
        }

        .template-card h4 {
            color: #667eea;
            margin: 0 0 10px 0;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .template-textarea {
            width: 100%;
            min-height: 120px;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            resize: vertical;
            background: #f9fafb;
        }

        .copy-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        .copy-button:hover {
            background: #5a6fd8;
        }

        .copy-button.copied {
            background: #10b981;
        }

        .step-guide {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .step-guide h4 {
            color: #0369a1;
            margin: 0 0 10px 0;
        }

        .step-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .step-list li {
            padding: 5px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .step-number {
            background: #667eea;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* „Éï„Ç°„Ç§„É´Âêç„Ç´„Çπ„Çø„Éû„Ç§„Ç∫Èñ¢ÈÄ£„Çπ„Çø„Ç§„É´ */
        .file-name-controls {
            border: 1px solid #e0e7ff;
            border-radius: 6px;
            padding: 8px 12px;
            background: #f8fcff;
        }

        .file-name-controls input {
            transition: border-color 0.3s ease;
        }

        .file-name-controls input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
        }

        /* „Çπ„ÉÜ„ÉÉ„Éó„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº */
        .step-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0 30px 0;
            padding: 20px 15px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow-x: auto;
            flex-wrap: nowrap;
        }

        @media (max-width: 570px) {
            .step-indicator {
                padding: 15px 10px;
                justify-content: flex-start;
            }
        }

        .step-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            min-width: 80px;
            flex-shrink: 0;
        }

        @media (max-width: 570px) {
            .step-item {
                min-width: 90px;
            }
        }

        .step-circle {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e9ecef;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 8px;
            transition: all 0.3s ease;
        }

        @media (max-width: 570px) {
            .step-circle {
                width: 32px;
                height: 32px;
                font-size: 14px;
                margin-bottom: 6px;
            }
        }

        .step-item.active .step-circle {
            background: #667eea;
            color: white;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

        .step-item.completed .step-circle {
            background: #28a745;
            color: white;
        }

        .step-label {
            font-size: 12px;
            font-weight: 500;
            color: #6c757d;
        }

        @media (max-width: 570px) {
            .step-label {
                font-size: 10px;
                line-height: 1.2;
                width: 100%;
                word-wrap: break-word;
                hyphens: auto;
            }
        }

        .step-item.active .step-label {
            color: #667eea;
            font-weight: 600;
        }

        .step-arrow {
            color: #dee2e6;
            font-size: 20px;
            margin: 0 8px;
            flex-shrink: 0;
        }

        @media (max-width: 570px) {
            .step-arrow {
                margin: 0 5px;
                font-size: 16px;
            }
        }

        /* „Ç´„Çπ„Çø„É†„É¢„Éº„ÉÄ„É´ */
        .custom-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e1e8ed;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.3s ease;
        }

        .modal-close:hover {
            background-color: #f5f5f5;
        }

        .modal-body {
            text-align: left;
            line-height: 1.6;
            font-size: 14px;
            color: #333;
        }

        .modal-body h3 {
            color: #667eea;
            margin: 20px 0 10px 0;
            font-size: 16px;
        }

        .modal-body ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .modal-body li {
            margin: 8px 0;
        }

        @media (max-width: 570px) {
            .modal-content {
                margin: 10px;
                width: calc(100% - 20px);
                max-height: 90vh;
                padding: 15px;
            }
            
            .modal-title {
                font-size: 16px;
            }
            
            .modal-body {
                font-size: 13px;
            }
        }

        /* ÁèæÂú®„ÅÆ„Çπ„ÉÜ„ÉÉ„ÉóÊÉÖÂ†± */
        .current-step-info {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9ff, #e8f4fd);
            border-radius: 12px;
            border-left: 4px solid #667eea;
            margin-bottom: 20px;
        }

        .step-icon {
            font-size: 24px;
            margin-top: 2px;
        }

        .step-description h4,
        .step-description strong {
            color: #667eea;
            margin-bottom: 8px;
        }

        .step-description p {
            margin: 0;
            color: #555;
            line-height: 1.5;
        }

        /* „Éò„É´„Éó„Éú„Çø„É≥ */
        .help-button {
            background: rgba(255,255,255,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            color: white !important;
            padding: 6px 10px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            margin-left: 10px;
        }

        .help-button:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.1);
        }

        /* „Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó„Ç®„É™„Ç¢ */
        .file-drop-zone {
            border: 2px dashed #667eea;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            background: linear-gradient(135deg, #f8f9ff, #e8f4fd);
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 20px;
        }

        .file-drop-zone:hover,
        .file-drop-zone.dragover {
            border-color: #4CAF50;
            background: linear-gradient(135deg, #f0fff4, #e8f5e8);
            transform: scale(1.02);
        }

        .drop-zone-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .drop-zone-icon {
            font-size: 48px;
            color: #667eea;
        }

        .drop-zone-text strong {
            color: #667eea;
            font-size: 16px;
        }

        .drop-zone-formats {
            font-size: 12px;
            color: #6c757d;
            background: white;
            padding: 6px 12px;
            border-radius: 20px;
            border: 1px solid #e9ecef;
        }

        .link-button {
            background: none;
            border: none;
            color: #667eea;
            text-decoration: underline;
            cursor: pointer;
            font-size: inherit;
        }

        .link-button:hover {
            color: #5a67d8;
        }

        /* „Ç®„É©„Éº„Éë„Éç„É´ */
        .error-panel {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            background: #fff5f5;
            border: 1px solid #feb2b2;
            border-radius: 8px;
            margin: 10px 0;
        }

        .error-icon {
            font-size: 20px;
            color: #e53e3e;
        }

        .error-content {
            flex: 1;
        }

        .error-message {
            font-weight: 600;
            color: #e53e3e;
            margin-bottom: 5px;
        }

        .error-solution {
            color: #555;
            font-size: 14px;
        }

        /* ÊàêÂäü„Éë„Éç„É´ */
        .success-panel {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            background: #f0fff4;
            border: 1px solid #9ae6b4;
            border-radius: 8px;
            margin: 10px 0;
        }

        .success-icon {
            font-size: 20px;
            color: #38a169;
        }

        /* „ÉÜ„É≥„Éó„É¨„Éº„Éà„É¢„Éº„ÉâÈÅ∏Êäû */
        .template-mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .mode-btn {
            padding: 10px 20px;
            border: 2px solid #667eea;
            border-radius: 25px;
            background: white;
            color: #667eea;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .mode-btn.active {
            background: #667eea;
            color: white;
        }

        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        /* „ÉÜ„É≥„Éó„É¨„Éº„Éà„Ç´„Éº„Éâ„ÅÆÊîπÂñÑ */
        .template-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .recommended-badge {
            background: #ff6b6b;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
        }

        .template-preview {
            background: #f8f9ff;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 3px solid #667eea;
        }

        .template-preview p {
            margin: 0;
            font-size: 12px;
            color: #555;
        }

        .highlight-text {
            background: #fff3cd;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 600;
        }

        .template-textarea.simple {
            height: 120px;
        }

        .template-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .expand-button {
            background: #f8f9fa;
            color: #667eea;
            border: 1px solid #dee2e6;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .expand-button:hover {
            background: #e9ecef;
            transform: translateY(-1px);
        }

        /* „ÇØ„Ç§„ÉÉ„ÇØ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ */
        .quick-navigation {
            background: linear-gradient(135deg, #f8f9ff, #e8f4fd);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 40px;
            border: 2px solid #e1e8ed;
        }

        .nav-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .nav-header h2 {
            color: #333;
            margin-bottom: 8px;
            font-size: 24px;
        }

        .nav-header p {
            color: #666;
            margin: 0;
            font-size: 16px;
        }

        .nav-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .nav-option {
            background: white;
            border-radius: 12px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #e9ecef;
            display: flex;
            align-items: center;
            gap: 20px;
            position: relative;
            overflow: hidden;
        }

        .nav-option:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
            border-color: #667eea;
        }

        .nav-option:first-child {
            border-color: #4CAF50;
        }

        .nav-option:first-child:hover {
            border-color: #45a049;
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.15);
        }

        .nav-icon {
            font-size: 48px;
            min-width: 60px;
            text-align: center;
        }

        .nav-content {
            flex: 1;
        }

        .nav-content h3 {
            margin: 0 0 8px 0;
            color: #333;
            font-size: 18px;
            font-weight: 600;
        }

        .nav-content p {
            margin: 0;
            color: #666;
            font-size: 14px;
        }

        .nav-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
        }

        .nav-badge.recommended {
            background: #4CAF50;
        }

        .nav-arrow {
            font-size: 24px;
            color: #667eea;
            font-weight: bold;
        }

        .nav-option:first-child .nav-arrow {
            color: #4CAF50;
        }

        @media (max-width: 768px) {
            .nav-options {
                grid-template-columns: 1fr;
            }
            
            .nav-option {
                padding: 20px;
                gap: 15px;
            }
            
            .nav-icon {
                font-size: 36px;
                min-width: 50px;
            }
        }

        /* CSV „Çª„ÇØ„Ç∑„Éß„É≥„ÅÆÊîπÂñÑ„Çπ„Çø„Ç§„É´ */
        .csv-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .csv-header h2 {
            color: #333;
            margin: 0;
            font-size: 22px;
        }

        .csv-badges {
            display: flex;
            gap: 8px;
        }

        .feature-badge {
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 11px;
            font-weight: 600;
        }

        .feature-badge.recommended {
            background: #4CAF50;
        }

        .info-panel.enhanced {
            background: linear-gradient(135deg, #f8f9ff, #e8f4fd);
            border: 2px solid #e1e8ed;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .info-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .info-icon {
            font-size: 24px;
            min-width: 32px;
            text-align: center;
        }

        .info-content h4 {
            margin: 0 0 4px 0;
            color: #333;
            font-size: 14px;
            font-weight: 600;
        }

        .info-content p {
            margin: 0;
            color: #666;
            font-size: 12px;
            line-height: 1.4;
        }

        .format-guide {
            border-top: 1px solid #e1e8ed;
            padding-top: 20px;
        }

        .format-guide h4 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 14px;
            font-weight: 600;
        }

        .format-example {
            background: #f1f3f4;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 15px;
            font-family: 'Courier New', monospace;
            border-left: 3px solid #667eea;
        }

        .format-example code {
            color: #333;
            font-size: 13px;
            word-wrap: break-word;
            white-space: pre-wrap;
            overflow-wrap: break-word;
        }

        .format-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
        }

        .format-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .format-label {
            font-weight: 600;
            color: #667eea;
            font-size: 12px;
        }

        .format-desc {
            color: #666;
            font-size: 11px;
            line-height: 1.3;
        }

        @media (max-width: 768px) {
            .csv-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .format-details {
                grid-template-columns: 1fr;
            }
        }

        /* Áõ∏‰∫í„É™„É≥„ÇØ„Çπ„Çø„Ç§„É´ */
        .section-link {
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 12px;
            border: 1px solid #b3e5fc;
            text-align: center;
        }

        .link-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }

        .link-content span {
            color: #666;
            font-size: 14px;
            font-weight: 500;
        }

        .link-button-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .link-button-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
            background: linear-gradient(135deg, #5a67d8, #6b46c1);
        }

        @media (max-width: 768px) {
            .link-content {
                gap: 10px;
            }
            
            .link-button-primary {
                padding: 10px 20px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1>„Éë„Çø„Éº„É≥„Éª„Ç´„Éº„ÉâÁîüÊàê„ÉÑ„Éº„É´</h1>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="resetAll()">
                    üîÑ „É™„Çª„ÉÉ„Éà
                </button>
                <button class="btn btn-primary" onclick="exportCurrentCard()">
                    üìÇ ÁèæÂú®„ÅÆ„Ç´„Éº„Éâ„Çí‰øùÂ≠ò
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="main-content">
            <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
            <div class="sidebar">
                <div class="info-panel">
                    <h3>üìö ‰∫ïÂ∫≠Â¥áÂÖàÁîü„ÅÆ„Éë„Çø„Éº„É≥„Éª„É©„É≥„Ç≤„Éº„Ç∏„ÇíÊ¥ªÁî®„Åó„Åü„ÇØ„É™„Ç®„ÉÜ„Ç£„Éñ„Éª„É©„Éº„Éã„É≥„Ç∞„ÅÆËÄÉ„Åà„Åã„ÇâÁùÄÊÉ≥„ÇíÂæó„Åü„ÉÑ„Éº„É´</h3>
                    <p>‰∫ïÂ∫≠ÂÖàÁîü„ÅÆÂâµÈÄ†ÁöÑÂ≠¶Áøí„ÅÆ„Åü„ÇÅ„ÅÆ40„ÅÆ„Éë„Çø„Éº„É≥„Ç´„Éº„Éâ„Åã„ÇâÈÅ∏Êäû„Åó„Åü„Ç´„Éº„Éâ„ÇíÂá∫Âäõ„Åó„Åü„Çä„ÄÅ„Ç™„É™„Ç∏„Éä„É´„ÅÆ„Éë„Çø„Éº„É≥„Ç´„Éº„Éâ„Çí‰ΩúÊàê„Åó„Å¶Âá∫Âäõ„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ</p>
                </div>

                <div class="form-group">
                    <label for="patternSelect">„Éë„Çø„Éº„É≥ÈÅ∏Êäû</label>
                    <select id="patternSelect" onchange="loadPatternData()">
                        <option value="">„Ç´„Çπ„Çø„É†ÔºàÁã¨Ëá™‰ΩúÊàêÔºâ</option>
                        <option value="0">0. Â≠¶Áøí„Çí„Éá„Ç∂„Ç§„É≥„Åô„Çã</option>
                        <option value="1">1. Ê©ü‰ºö„Çí„Å§„Åè„Çã</option>
                        <option value="2">2. ÂâµÈÄ†ÁöÑ„Å™„Éó„É≠„Ç∏„Çß„ÇØ„Éà</option>
                        <option value="3">3. „Ç™„Éº„Éó„É≥„Éó„É≠„Çª„Çπ„Å™Â≠¶„Å≥</option>
                        <option value="4">4. „Åæ„Åö„ÅØ„Å§„Åã„Çã</option>
                        <option value="5">5. Ë¶ã„Åæ„Å≠Â≠¶Áøí</option>
                        <option value="6">6. ÂäπÊûúÁöÑ„Å™Ë≥™Âïè</option>
                        <option value="7">7. „Ç¢„Ç¶„Éà„Éó„ÉÉ„ÉàÂøóÂêë„ÅÆÂ≠¶Áøí</option>
                        <option value="8">8. ÊØéÊó•Â§ñÂõΩË™û</option>
                        <option value="9">9. ÈÅä„Å≥ÂøÉ„ÅÆ„ÅÇ„ÇãÂ≠¶Áøí</option>
                        <option value="10">10. Ë∫´‰ΩìÂåñ„Åï„Çå„Åü„Çπ„Ç≠„É´</option>
                        <option value="11">11. Ë®ÄËëâ„ÅÆ„Ç∑„É£„ÉØ„Éº</option>
                        <option value="12">12. ÊúâÂΩ¢„ÅÆËìÑÁ©ç</option>
                        <option value="13">13. Â≠¶Áøí„ÅÆÁ´úÂ∑ª</option>
                        <option value="14">14. ‰∏âËßí„Çπ„Ç±„Éº„É™„É≥„Ç∞</option>
                        <option value="15">15. ËààÂ•Æ„ÅÆÈÄ£ÈéñÔºÅ</option>
                        <option value="16">16. Ë°åÂãï„ÅÆ‰∏≠„Åß„ÅÆÊÄùËÄÉ</option>
                        <option value="17">17. „Éó„É≠„Éà„Çø„Ç§„Éî„É≥„Ç∞</option>
                        <option value="18">18. „Éï„Ç£„Éº„É´„Éâ„ÉÄ„Ç§„Éì„É≥„Ç∞</option>
                        <option value="19">19. „Éû„É´„ÉÅ„Ç´„É°„É©ÊíÆÂΩ±</option>
                        <option value="20">20. È≥•„ÅÆÁõÆ„ÉªËô´„ÅÆÁõÆ</option>
                        <option value="21">21. Èö†„Çå„Åü„Å§„Å™„Åå„Çä</option>
                        <option value="22">22. „Éï„É≠„É≥„ÉÜ„Ç£„Ç¢Áô∫Ë¶ãËÄÖ</option>
                        <option value="23">23. ÂâµÈÄ†ÁöÑ„Çπ„Ç§„ÉÉ„ÉÅ</option>
                        <option value="24">24. ÊûúÁâ©Ëæ≤Ê•≠</option>
                        <option value="25">25. ÂàùÁ®ø„ÅØÈÅìÂçä„Å∞</option>
                        <option value="26">26. È≠ÖÂäõÁöÑË°®Áèæ</option>
                        <option value="27">27. Ê¨°„Å∏„ÅÆÂä†ÈÄü</option>
                        <option value="28">28. Â≠¶Áøí„ÅÆ„Ç≥„Éü„É•„Éã„ÉÜ„Ç£</option>
                        <option value="29">29. ÂÅ∂ÁÑ∂„ÅÆÂá∫‰ºö„ÅÑ</option>
                        <option value="30">30. ËâØ„Åç„É©„Ç§„Éê„É´</option>
                        <option value="31">31. Ë©±„ÅôÊÄùËÄÉËÄÖ</option>
                        <option value="32">32. Êïô„Åà„Çã„Åì„Å®„Å´„Çà„ÇãÂ≠¶Áøí</option>
                        <option value="33">33. Á¢∫Âõ∫„Åü„ÇãÊ±∫ÊÑè</option>
                        <option value="34">34. ÁñëÂïè„ÇíÊåÅ„Å§ÂøÉ</option>
                        <option value="35">35. Ê≠£„Åó„ÅÑÊñπÊ≥ï</option>
                        <option value="36">36. ÂãáÊï¢„Å™Â§âÂåñ</option>
                        <option value="37">37. Êé¢Ê§úÂÆ∂„ÅÆÊÉÖÁÜ±</option>
                        <option value="38">38. Ëá™Â∑±„Éó„É≠„Éá„É•„Éº„Çµ„Éº</option>
                        <option value="39">39. Ê•µÁ´Ø„Å´„Å™„ÇåÔºÅ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>„Éá„Ç∂„Ç§„É≥„ÉÜ„É≥„Éó„É¨„Éº„Éà</label>
                    <div class="templates">
                        <!-- Âü∫Êú¨„ÉÜ„Éº„Éû -->
                        <div class="template-btn template-academic active" data-template="academic" onclick="selectTemplate('academic')">
                            „Ç¢„Ç´„Éá„Éü„ÉÉ„ÇØ
                        </div>
                        <div class="template-btn template-nature" data-template="nature" onclick="selectTemplate('nature')">
                            „Éä„ÉÅ„É•„É©„É´
                        </div>
                        <div class="template-btn template-warm" data-template="warm" onclick="selectTemplate('warm')">
                            „Ç¶„Ç©„Éº„É†
                        </div>
                        <div class="template-btn template-elegant" data-template="elegant" onclick="selectTemplate('elegant')">
                            „Ç®„É¨„Ç¨„É≥„Éà
                        </div>
                        
                        <!-- Êñ∞„ÉÜ„Éº„Éû -->
                        <div class="template-btn template-pastel" data-template="pastel" onclick="selectTemplate('pastel')">
                            „Éë„Çπ„ÉÜ„É´
                        </div>
                        
                        <!-- Â≠£ÁØÄ„ÉÜ„Éº„Éû -->
                        <div class="template-btn template-spring" data-template="spring" onclick="selectTemplate('spring')">
                            üå∏ Êò•
                        </div>
                        <div class="template-btn template-summer" data-template="summer" onclick="selectTemplate('summer')">
                            üåª Â§è
                        </div>
                        <div class="template-btn template-autumn" data-template="autumn" onclick="selectTemplate('autumn')">
                            üçÇ Áßã
                        </div>
                        <div class="template-btn template-winter" data-template="winter" onclick="selectTemplate('winter')">
                            ‚ùÑÔ∏è ÂÜ¨
                        </div>
                        
                        <!-- „Ç´„Çπ„Çø„É† -->
                        <div class="template-btn template-custom" data-template="custom" onclick="selectTemplate('custom')">
                            üõ†Ô∏è „Ç´„Çπ„Çø„É†
                        </div>
                    </div>
                </div>

                <div class="form-group" id="customBackgroundGroup" style="display: none;">
                    <label for="backgroundUpload">ËÉåÊôØÁîªÂÉè„Çí„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ</label>
                    <input type="file" id="backgroundUpload" accept="image/*" onchange="handleBackgroundUpload(event)">
                    <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">
                        Êé®Â•®„Çµ„Ç§„Ç∫: 888√ó600px „Åæ„Åü„ÅØÂêå„ÅòÊØîÁéá„ÅÆÁîªÂÉè
                    </small>
                </div>

                <div class="form-group">
                    <label for="fontSelect">„Éï„Ç©„É≥„ÉàÈÅ∏Êäû</label>
                    <select id="fontSelect" onchange="changeFont()">
                        <option value="hiragino">„Éí„É©„ÇÆ„ÉéËßí„Ç¥ÔºàÊ®ôÊ∫ñÔºâ</option>
                        <option value="yugothic">Ê∏∏„Ç¥„Ç∑„ÉÉ„ÇØ</option>
                        <option value="noto">Noto Sans JP</option>
                        <option value="arial">ArialÔºàËã±Ë™ûÔºâ</option>
                        <option value="roboto">RobotoÔºàËã±Ë™ûÔºâ</option>
                        <option value="opensans">Open SansÔºàËã±Ë™ûÔºâ</option>
                        <option value="comic">„Ç≥„Éü„ÉÉ„ÇØÈ¢®</option>
                        <option value="serif">ÊòéÊúù‰ΩìÔºà„Çª„É™„ÉïÔºâ</option>
                    </select>
                    <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">
                        ÈÅ∏Êäû„Åó„Åü„Éï„Ç©„É≥„Éà„ÅØ„Ç´„Éº„ÉâÂÖ®‰Ωì„ÅÆ„ÉÜ„Ç≠„Çπ„Éà„Å´ÈÅ©Áî®„Åï„Çå„Åæ„Åô
                    </small>
                </div>

                <!-- „Ç´„É©„Éº„Ç´„Çπ„Çø„Éû„Ç§„Ç∫Ê©üËÉΩ -->
                <div class="form-group">
                    <label>üé® „Ç´„É©„Éº„Ç´„Çπ„Çø„Éû„Ç§„Ç∫</label>
                    <div class="color-customization">
                        <!-- „Ç´„Çπ„Çø„É†„Ç´„É©„ÉºÊúâÂäπÂåñ -->
                        <div class="custom-color-toggle" onclick="toggleCustomColorsUI()">
                            <input type="checkbox" id="enableCustomColors" onchange="toggleCustomColors()" onclick="event.stopPropagation()">
                            <span>„Ç´„Çπ„Çø„É†„Ç´„É©„Éº„Çí‰ΩøÁî®</span>
                        </div>
                        
                        <!-- „Ç´„É©„Éº„Éî„ÉÉ„Ç´„ÉºÔºàÂàùÊúü„ÅØÈùûË°®Á§∫Ôºâ -->
                        <div id="customColorsPanel" style="display: none;">
                            <div class="color-inputs">
                                <div class="color-input-group">
                                    <label for="primaryColor">ËÉåÊôØÈñãÂßãËâ≤</label>
                                    <input type="color" id="primaryColor" value="#e6f8ff" onchange="updateCustomColors()">
                                </div>
                                <div class="color-input-group">
                                    <label for="secondaryColor">ËÉåÊôØÁµÇ‰∫ÜËâ≤</label>
                                    <input type="color" id="secondaryColor" value="#0077ff" onchange="updateCustomColors()">
                                </div>
                                <div class="color-input-group">
                                    <label for="accentColor">Ë¶ÅÁ¥†ËÉåÊôØËâ≤</label>
                                    <input type="color" id="accentColor" value="#ffffff" onchange="updateCustomColors()">
                                </div>
                            </div>
                            
                            <!-- „Ç´„Çπ„Çø„É†„Éë„É¨„ÉÉ„Éà‰øùÂ≠ò -->
                            <div class="palette-management">
                                <div style="display: flex; gap: 5px; margin-top: 10px;">
                                    <input type="text" id="paletteNameInput" placeholder="„Éë„É¨„ÉÉ„ÉàÂêç" style="flex: 1; padding: 4px;">
                                    <button type="button" onclick="saveCustomPalette()" style="padding: 4px 8px; font-size: 12px;">‰øùÂ≠ò</button>
                                </div>
                                
                                <!-- ‰øùÂ≠òÊ∏à„Åø„Éë„É¨„ÉÉ„Éà‰∏ÄË¶ß -->
                                <div id="savedPalettes" style="margin-top: 10px;"></div>
                            </div>
                        </div>
                    </div>
                    <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">
                        Áã¨Ëá™„ÅÆ„Éñ„É©„É≥„Éâ„Ç´„É©„Éº„Åß„Ç´„Éº„Éâ„Çí„Ç´„Çπ„Çø„Éû„Ç§„Ç∫„Åß„Åç„Åæ„ÅôÔºàÊúÄÂ§ß6ÂÄã‰øùÂ≠òÂèØËÉΩÔºâ
                    </small>
                </div>

                <div class="form-group">
                    <label for="resolutionSelect">Âá∫Âäõ„Çµ„Ç§„Ç∫</label>
                    <select id="resolutionSelect" disabled>
                        <option value="1.5" selected>‰∏≠Ëß£ÂÉèÂ∫¶ (888√ó600px) - Âç∞Âà∑ÊúÄÈÅ©Âåñ</option>
                    </select>
                    <small style="color: #666; font-size: 12px; display: block; margin-top: 5px;">
                        Âç∞Âà∑„Å®WebË°®Á§∫„ÅÆ‰∏°Êñπ„Å´ÈÅ©„Åó„ÅüÊúÄÈÅ©Âåñ„Çµ„Ç§„Ç∫„Å´Âõ∫ÂÆö„Åï„Çå„Å¶„ÅÑ„Åæ„Åô
                    </small>
                </div>

                <div class="form-group">
                    <label for="patternTitle">„Éë„Çø„Éº„É≥Âêç</label>
                    <input type="text" id="patternTitle" placeholder="„Éë„Çø„Éº„É≥Âêç„ÇíÂÖ•Âäõ" oninput="updateCard()">
                </div>

                <div class="form-group">
                    <label for="patternDescription">Ë™¨Êòé</label>
                    <textarea id="patternDescription" placeholder="„Éë„Çø„Éº„É≥„ÅÆË™¨Êòé„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ..." oninput="updateCard()"></textarea>
                </div>

                <div class="form-group">
                    <label for="patternContext">Â†¥Èù¢„ÉªÁä∂Ê≥Å</label>
                    <textarea id="patternContext" placeholder="„Éë„Çø„Éº„É≥„ÅåÈÅ©Áî®„Åï„Çå„ÇãÂ†¥Èù¢„ÇÑÁä∂Ê≥Å„ÇíË®òËø∞..." oninput="updateCard()"></textarea>
                </div>

                <div class="form-group">
                    <label for="patternSolution">Â∑•Â§´„Éª„Éà„É©„Ç§„Ç¢„É´</label>
                    <textarea id="patternSolution" placeholder="Ë™≤È°å„Å´ÂØæ„Åô„ÇãÂ∑•Â§´„ÇÑË©¶„Åó„Å¶„Åø„Åü„ÅÑ„Åì„Å®„ÇíË®òËø∞..." oninput="updateCard()"></textarea>
                </div>
            </div>

            <!-- „É°„Ç§„É≥„Ç®„É™„Ç¢ -->
            <div class="main-area">
                <!-- „Éó„É¨„Éì„É•„Éº„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <div class="preview-section">
                    <div class="preview-header">
                        <h2>„Éó„É¨„Éì„É•„Éº</h2>
                        <span style="color: #666; font-size: 14px;">Âõ∫ÂÆö„Çµ„Ç§„Ç∫Ôºà888√ó600pxÔºâ</span>
                    </div>
                    <div class="canvas-container">
                        <canvas id="cardCanvas"></canvas>
                    </div>
                </div>

                <!-- „ÇØ„Ç§„ÉÉ„ÇØ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ -->
                <div class="quick-navigation">
                    <div class="nav-header">
                        <h2>üöÄ „Éë„Çø„Éº„É≥„Ç´„Éº„Éâ‰ΩúÊàêÊñπÊ≥ï„ÇíÈÅ∏Êäû</h2>
                        <p>Áî®ÈÄî„Å´Âøú„Åò„Å¶ÊúÄÈÅ©„Å™ÊñπÊ≥ï„Çí„ÅäÈÅ∏„Å≥„Åè„Å†„Åï„ÅÑ</p>
                    </div>
                    <div class="nav-options">
                        <div class="nav-option" onclick="scrollToSection('csv-section')">
                            <div class="nav-icon">üìÅ</div>
                            <div class="nav-content">
                                <h3>Êó¢Â≠ò„Éï„Ç°„Ç§„É´</h3>
                                <p>CSV„Éï„Ç°„Ç§„É´„Çí„ÅäÊåÅ„Å°„ÅÆÂ†¥Âêà</p>
                                <span class="nav-badge recommended">„Åä„Åô„Åô„ÇÅ</span>
                            </div>
                            <div class="nav-arrow">‚Üí</div>
                        </div>
                        <div class="nav-option" onclick="scrollToSection('ai-guide-section')">
                            <div class="nav-icon">ü§ñ</div>
                            <div class="nav-content">
                                <h3>AI„ÅßÊñ∞Ë¶è‰ΩúÊàê</h3>
                                <p>Êõ∏Á±ç„ÇÑ„ÉÜ„Éº„Éû„Åã„ÇâÁîüÊàêAI„ÅßÁîüÊàê</p>
                                <span class="nav-badge">ÂàùÂõûÂêë„Åë</span>
                            </div>
                            <div class="nav-arrow">‚Üí</div>
                        </div>
                    </div>
                </div>

                <!-- ‰∏ÄÊã¨ÁîüÊàê„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <div class="batch-section">
                    <!-- AIÊ¥ªÁî®„Ç¨„Ç§„Éâ„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <div class="ai-guide-section">
                        <div class="ai-guide-header" onclick="toggleAIGuide()">
                            <div class="ai-guide-title">
                                <span>ü§ñ</span>
                                <span>AI„ÇíÊ¥ªÁî®„Åó„Åü„Éë„Çø„Éº„É≥„Éª„Ç´„Éº„Éâ„ÅÆ‰ΩúÊàê - CSVËá™ÂãïÁîüÊàê„Éó„É≠„É≥„Éó„Éà</span>
                                <button class="help-button" onclick="event.stopPropagation(); showAIHelp()" title="‰Ωø„ÅÑÊñπ„Ç¨„Ç§„Éâ„ÇíË°®Á§∫">?</button>
                            </div>
                            <span class="ai-guide-toggle" id="aiGuideToggle">‚ñº</span>
                        </div>
                        <div class="ai-guide-content" id="aiGuideContent">
                            <!-- „Çπ„ÉÜ„ÉÉ„Éó„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº -->
                            <div class="step-indicator">
                                <div class="step-item active" data-step="1">
                                    <div class="step-circle">1</div>
                                    <div class="step-label">„ÉÜ„É≥„Éó„É¨„Éº„ÉàÈÅ∏Êäû</div>
                                </div>
                                <div class="step-arrow">‚Üí</div>
                                <div class="step-item" data-step="2">
                                    <div class="step-circle">2</div>
                                    <div class="step-label">„Éó„É≠„É≥„Éó„ÉàÂÆüË°å</div>
                                </div>
                                <div class="step-arrow">‚Üí</div>
                                <div class="step-item" data-step="3">
                                    <div class="step-circle">3</div>
                                    <div class="step-label">„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø</div>
                                </div>
                                <div class="step-arrow">‚Üí</div>
                                <div class="step-item" data-step="4">
                                    <div class="step-circle">4</div>
                                    <div class="step-label">„Ç´„Éº„ÉâÁîüÊàê</div>
                                </div>
                            </div>
                            
                            <div class="step-guide">
                                <div class="current-step-info" id="currentStepInfo">
                                    <div class="step-icon">üìù</div>
                                    <div class="step-description">
                                        <strong>„Çπ„ÉÜ„ÉÉ„Éó1Ôºö„Éó„É≠„É≥„Éó„Éà„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÈÅ∏Êäû</strong>
                                        <p>‰ª•‰∏ã„Åã„ÇâÁõÆÁöÑ„Å´Âêà„Å£„Åü„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑ„ÄÇÊõ∏Á±çÂêç„ÇÑ„ÉÜ„Éº„Éû„ÇíÊåáÂÆö„Åô„Çã„Å†„Åë„Åß„ÄÅAI„ÅåËá™ÂãïÁöÑ„Å´„Éë„Çø„Éº„É≥„Ç´„Éº„Éâ„ÅÆ„Éá„Éº„Çø„ÇíÁîüÊàê„Åó„Åæ„Åô„ÄÇ</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="template-grid">
                                <!-- Êõ∏Á±çÊåáÂÆöÁî®„ÉÜ„É≥„Éó„É¨„Éº„Éà -->
                                <div class="template-card">
                                    <h4>üìö Êõ∏Á±çÊåáÂÆöÁî®</h4>
                                    <textarea class="template-textarea" readonly>„Äå[Êõ∏Á±çÂêç„ÇíÂÖ•Âäõ]„Äç„ÅÆÂÜÖÂÆπ„Åã„Çâ„ÄÅÂÄã‰∫∫„ÅÆÂ≠¶Áøí„ÉªÊàêÈï∑„Çí‰øÉÈÄ≤„Åô„ÇãË°åÂãï„Éë„Çø„Éº„É≥„Çí10-15ÂÄãÊäΩÂá∫„Åó„ÄÅ‰ª•‰∏ã„ÅÆCSVÂΩ¢Âºè„ÅßÂá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

CSV„Éò„ÉÉ„ÉÄ„ÉºÔºö
pattern_number,title,description,context,solution

Êù°‰ª∂Ôºö
- pattern_number„ÅØ1„Åã„ÇâÈÄ£Áï™„ÅßÁï™Âè∑„ÇíÊåØ„Çã
- title„ÅØ„Éë„Çø„Éº„É≥Âêç„ÇíÁ∞°ÊΩî„Å´ÔºàÂÖ®Ëßí28ÊñáÂ≠ó‰ª•ÂÜÖÔºâ
- description„ÅØË™¨ÊòéÊñá„ÇíÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖ„ÅßÁ∞°ÊΩî„Å´
- context„ÅØ„Äå„Äú„Å™Áä∂Ê≥Å„Åß„Äç„Å®„ÅÑ„ÅÜÂΩ¢„ÅßË®òËø∞ÔºàÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖÔºâ
- solution„ÅØÂÖ∑‰ΩìÁöÑ„Å™Ë°åÂãï„Å®„Åó„Å¶Ë®òËø∞ÔºàÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖÔºâ

Âá∫ÂäõÂΩ¢ÂºèÔºö
‰ª•‰∏ã„ÅÆÊù°‰ª∂„ÅßCSV„Éï„Ç°„Ç§„É´„ÅÆÂÜÖÂÆπ„ÅÆ„Åø„ÄÅ„Éï„Ç°„Ç§„É´„Çí.csvÂΩ¢Âºè„ÇÇ„Åó„Åè„ÅØ.txtÂΩ¢Âºè„Åß„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åß„Åç„Çã„Çà„ÅÜ„Å´Âá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö
„Éª„Ç¢„Éº„ÉÜ„Ç£„Éï„Ç°„ÇØ„Éà„ÅÆtype„Çí"text/csv"„Å´Ë®≠ÂÆö„Åô„Çã
„ÉªMIME„Çø„Ç§„Éó„ÇíCSVÂΩ¢Âºè„Å®„Åó„Å¶Ë™çË≠ò„Åï„Åõ„Çã
„ÉªÂèØËÉΩ„Å™Â†¥Âêà„ÅØ„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÁî®CSV„Éï„Ç°„Ç§„É´„Çí‰ΩúÊàê„Åó„Å¶„ÄÅ„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÁî®„ÅÆ„É™„É≥„ÇØ„ÇíÁô∫Ë°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ
„Éª1Ë°åÁõÆÔºö„Éò„ÉÉ„ÉÄ„ÉºË°åÔºàpattern_number,title,description,context,solutionÔºâ
„Éª2Ë°åÁõÆ‰ª•ÈôçÔºö„Éá„Éº„ÇøË°åÔºà„Ç´„É≥„ÉûÂå∫Âàá„Çä„ÄÅÊîπË°åÂå∫Âàá„ÇäÔºâ
„ÉªË™¨ÊòéÊñá„ÇÑ„Åù„ÅÆ‰ªñ„ÅÆ„ÉÜ„Ç≠„Çπ„Éà„ÅØ‰∏ÄÂàáÂê´„ÇÅ„Å™„ÅÑ
„ÉªCSV„Éá„Éº„Çø„ÅÆ„Åø„ÇíÂá∫Âäõ„Åô„Çã

‰æãÔºö
pattern_number,title,description,context,solution
1,ÁñëÂïèÈßÜÂãïÂûã„ÅÆÂ≠¶Áøí,„Äå„Å™„ÅúÔºü„Äç„ÇíËµ∑ÁÇπ„ÉªË∂≥Â†¥„Å´„Åó„Å™„Åå„ÇâÊ∑±„ÅÑÁêÜËß£„Å∏„ÅÆÈÅìÁ≠ã„ÇíÊé¢„Çã,Êñ∞„Åó„ÅÑÊ¶ÇÂøµ„Å´Âá∫‰ºö„Å£„Åü„Åå„Åù„ÅÆÊú¨Ë≥™„ÅåË¶ã„Åà„Å™„ÅÑÁä∂Ê≥Å„Åß,„Åæ„Åö„Äå„Åì„Çå„ÅØ‰Ωï„ÅÆ„Åü„ÇÅ„Å´„ÅÇ„Çã„ÅÆ„ÅãÔºü„Å™„ÅÑ„Å®„Å©„ÅÜ„Å™„Çã„ÅÆ„ÅãÔºü„Äç„Å®Âïè„ÅÑ„Åã„ÅëÈñ¢ÈÄ£ÊÄß„ÇíÊé¢„Å£„Å¶„Åø„Çã</textarea>
                                    <button class="copy-button" onclick="copyTemplate(this, 'book')">üìã „Ç≥„Éî„Éº</button>
                                </div>

                                <!-- Ë≥áÊñô„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÁî®„ÉÜ„É≥„Éó„É¨„Éº„Éà -->
                                <div class="template-card">
                                    <h4>üìÑ Ë≥áÊñô„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÁî®</h4>
                                    <textarea class="template-textarea" readonly>„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åó„ÅüË≥áÊñô„ÅÆÂÜÖÂÆπ„Åã„Çâ„ÄÅÂÄã‰∫∫„ÅÆÂ≠¶Áøí„ÉªÊàêÈï∑„Çí‰øÉÈÄ≤„Åô„ÇãË°åÂãï„Éë„Çø„Éº„É≥„Çí10-15ÂÄãÊäΩÂá∫„Åó„ÄÅ‰ª•‰∏ã„ÅÆCSVÂΩ¢Âºè„ÅßÂá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

CSV„Éò„ÉÉ„ÉÄ„ÉºÔºö
pattern_number,title,description,context,solution

Êù°‰ª∂Ôºö
- pattern_number„ÅØ1„Åã„ÇâÈÄ£Áï™„ÅßÁï™Âè∑„ÇíÊåØ„Çã
- title„ÅØ„Éë„Çø„Éº„É≥Âêç„ÇíÁ∞°ÊΩî„Å´ÔºàÂÖ®Ëßí28ÊñáÂ≠ó‰ª•ÂÜÖÔºâ
- description„ÅØË™¨ÊòéÊñá„ÇíÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖ„ÅßÁ∞°ÊΩî„Å´
- context„ÅØ„Äå„Äú„Å™Áä∂Ê≥Å„Åß„Äç„Å®„ÅÑ„ÅÜÂΩ¢„ÅßË®òËø∞ÔºàÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖÔºâ
- solution„ÅØÂÖ∑‰ΩìÁöÑ„Å™Ë°åÂãï„Å®„Åó„Å¶Ë®òËø∞ÔºàÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖÔºâ

Âá∫ÂäõÂΩ¢ÂºèÔºö
‰ª•‰∏ã„ÅÆÊù°‰ª∂„ÅßCSV„Éï„Ç°„Ç§„É´„ÅÆÂÜÖÂÆπ„ÅÆ„Åø„ÄÅ„Éï„Ç°„Ç§„É´„Çí.csvÂΩ¢Âºè„ÇÇ„Åó„Åè„ÅØ.txtÂΩ¢Âºè„Åß„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åß„Åç„Çã„Çà„ÅÜ„Å´Âá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö
„Éª„Ç¢„Éº„ÉÜ„Ç£„Éï„Ç°„ÇØ„Éà„ÅÆtype„Çí"text/csv"„Å´Ë®≠ÂÆö„Åô„Çã
„ÉªMIME„Çø„Ç§„Éó„ÇíCSVÂΩ¢Âºè„Å®„Åó„Å¶Ë™çË≠ò„Åï„Åõ„Çã
„ÉªÂèØËÉΩ„Å™Â†¥Âêà„ÅØ„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÁî®CSV„Éï„Ç°„Ç§„É´„Çí‰ΩúÊàê„Åó„Å¶„ÄÅ„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÁî®„ÅÆ„É™„É≥„ÇØ„ÇíÁô∫Ë°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ
„Éª1Ë°åÁõÆÔºö„Éò„ÉÉ„ÉÄ„ÉºË°åÔºàpattern_number,title,description,context,solutionÔºâ
„Éª2Ë°åÁõÆ‰ª•ÈôçÔºö„Éá„Éº„ÇøË°åÔºà„Ç´„É≥„ÉûÂå∫Âàá„Çä„ÄÅÊîπË°åÂå∫Âàá„ÇäÔºâ
„ÉªË™¨ÊòéÊñá„ÇÑ„Åù„ÅÆ‰ªñ„ÅÆ„ÉÜ„Ç≠„Çπ„Éà„ÅØ‰∏ÄÂàáÂê´„ÇÅ„Å™„ÅÑ
„ÉªCSV„Éá„Éº„Çø„ÅÆ„Åø„ÇíÂá∫Âäõ„Åô„Çã

‰æãÔºö
pattern_number,title,description,context,solution
1,‰æ°ÂÄ§Âü∫Ê∫ñ„ÅÆË¶ãÊ•µ„ÇÅ,Êú¨ÂΩì„Å´ÈáçË¶Å„Å™„Åì„Å®„ÇíÂà§Êñ≠„Åô„ÇãÊÄùËÄÉ„Éó„É≠„Çª„Çπ„ÇíÂëº„Å≥Ëµ∑„Åì„Åô,Â§ö„Åè„ÅÆ„Çø„Çπ„ÇØ„Å´ËøΩ„Çè„Çå‰Ωï„Åã„ÇâÊâã„Çí„Å§„Åë„Çã„Åπ„Åç„ÅãËø∑„ÅÜÁä∂Ê≥Å„Åß,„Äå„Åì„Çå„ÅØËá™ÂàÜ„ÅÆÁõÆÊ®ô„Å´„Å©„ÅÜÁµê„Å≥„Å§„Åë„Çâ„Çå„Çã„ÅÆ„ÅãÔºü„Äç„Å®Ëá™Âïè„Åó„Å¶ÈÅ∏Êäû„Åó„Å¶„Åø„Çã</textarea>
                                    <button class="copy-button" onclick="copyTemplate(this, 'document')">üìã „Ç≥„Éî„Éº</button>
                                </div>

                                <!-- „Ç¶„Çß„Éñ„É™„É≥„ÇØÁî®„ÉÜ„É≥„Éó„É¨„Éº„Éà -->
                                <div class="template-card">
                                    <h4>üîó „Ç¶„Çß„Éñ„É™„É≥„ÇØÁî®</h4>
                                    <textarea class="template-textarea" readonly>Ê¨°„ÅÆ„É™„É≥„ÇØÂÖà„ÅÆÂÜÖÂÆπ„Åã„Çâ„ÄÅÂÄã‰∫∫„ÅÆÂ≠¶Áøí„ÉªÊàêÈï∑„Çí‰øÉÈÄ≤„Åô„ÇãË°åÂãï„Éë„Çø„Éº„É≥„Çí10-15ÂÄãÊäΩÂá∫„Åó„ÄÅ‰ª•‰∏ã„ÅÆCSVÂΩ¢Âºè„ÅßÂá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ‚Üí[URL „ÇíÂÖ•Âäõ]

CSV„Éò„ÉÉ„ÉÄ„ÉºÔºö
pattern_number,title,description,context,solution

Êù°‰ª∂Ôºö
- pattern_number„ÅØ1„Åã„ÇâÈÄ£Áï™„ÅßÁï™Âè∑„ÇíÊåØ„Çã
- title„ÅØ„Éë„Çø„Éº„É≥Âêç„ÇíÁ∞°ÊΩî„Å´ÔºàÂÖ®Ëßí28ÊñáÂ≠ó‰ª•ÂÜÖÔºâ
- description„ÅØË™¨ÊòéÊñá„ÇíÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖ„ÅßÁ∞°ÊΩî„Å´
- context„ÅØ„Äå„Äú„Å™Áä∂Ê≥Å„Åß„Äç„Å®„ÅÑ„ÅÜÂΩ¢„ÅßË®òËø∞ÔºàÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖÔºâ
- solution„ÅØÂÖ∑‰ΩìÁöÑ„Å™Ë°åÂãï„Å®„Åó„Å¶Ë®òËø∞ÔºàÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖÔºâ

Âá∫ÂäõÂΩ¢ÂºèÔºö
‰ª•‰∏ã„ÅÆÊù°‰ª∂„ÅßCSV„Éï„Ç°„Ç§„É´„ÅÆÂÜÖÂÆπ„ÅÆ„Åø„ÄÅ„Éï„Ç°„Ç§„É´„Çí.csvÂΩ¢Âºè„ÇÇ„Åó„Åè„ÅØ.txtÂΩ¢Âºè„Åß„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åß„Åç„Çã„Çà„ÅÜ„Å´Âá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö
„Éª„Ç¢„Éº„ÉÜ„Ç£„Éï„Ç°„ÇØ„Éà„ÅÆtype„Çí"text/csv"„Å´Ë®≠ÂÆö„Åô„Çã
„ÉªMIME„Çø„Ç§„Éó„ÇíCSVÂΩ¢Âºè„Å®„Åó„Å¶Ë™çË≠ò„Åï„Åõ„Çã
„ÉªÂèØËÉΩ„Å™Â†¥Âêà„ÅØ„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÁî®CSV„Éï„Ç°„Ç§„É´„Çí‰ΩúÊàê„Åó„Å¶„ÄÅ„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÁî®„ÅÆ„É™„É≥„ÇØ„ÇíÁô∫Ë°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ
„Éª1Ë°åÁõÆÔºö„Éò„ÉÉ„ÉÄ„ÉºË°åÔºàpattern_number,title,description,context,solutionÔºâ
„Éª2Ë°åÁõÆ‰ª•ÈôçÔºö„Éá„Éº„ÇøË°åÔºà„Ç´„É≥„ÉûÂå∫Âàá„Çä„ÄÅÊîπË°åÂå∫Âàá„ÇäÔºâ
„ÉªË™¨ÊòéÊñá„ÇÑ„Åù„ÅÆ‰ªñ„ÅÆ„ÉÜ„Ç≠„Çπ„Éà„ÅØ‰∏ÄÂàáÂê´„ÇÅ„Å™„ÅÑ
„ÉªCSV„Éá„Éº„Çø„ÅÆ„Åø„ÇíÂá∫Âäõ„Åô„Çã

‰æãÔºö
pattern_number,title,description,context,solution
1,ÂÜÖÁô∫ÁöÑÂãïÊ©ü„ÅÆÁô∫Ë¶ã,„Äå„Å™„Åú„Åì„Çå„Çí„ÇÑ„Çä„Åü„ÅÑ„ÅÆ„ÅãÔºü„Äç„ÇíÂïè„ÅÑ„Åã„ÅëÁ¢∫Ë™ç„Åó„Å™„Åå„ÇâÈÄ≤„ÇÄ,Êñ∞„Åó„ÅÑÁøíÊÖ£„ÇíÂßã„ÇÅ„Å¶„ÇÇ„É¢„ÉÅ„Éô„Éº„Ç∑„Éß„É≥„ÅåÁ∂ö„Åã„Å™„ÅÑÁä∂Ê≥Å„Åß,„Äå„Åì„Çå„ÅåÈÅîÊàê„Åï„Çå„Åü„ÇâËá™ÂàÜ„ÅÆ‰Ωï„Åå„Å©„ÅÜÂ§â„Çè„Çä„Åù„ÅÜ„ÅãÔºü„Äç„Å®ÊÉ≥ÂÉè„Åó„Å¶„Åø„Çã</textarea>
                                    <button class="copy-button" onclick="copyTemplate(this, 'web')">üìã „Ç≥„Éî„Éº</button>
                                </div>

                                <!-- Ëá™Áî±„ÉÜ„Éº„ÉûÁî®„ÉÜ„É≥„Éó„É¨„Éº„Éà -->
                                <div class="template-card">
                                    <h4>üí≠ Ëá™Áî±„ÉÜ„Éº„ÉûÁî®</h4>
                                    <textarea class="template-textarea" readonly>„Äå[„ÉÜ„Éº„Éû„ÇíÂÖ•ÂäõÔºà‰æãÔºö„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞Â≠¶Áøí„ÄÅË™ûÂ≠¶ÁøíÂæó„ÄÅ„Ç≠„É£„É™„Ç¢ÈñãÁô∫„Å™„Å©Ôºâ„Äç„Å´Èñ¢„Åô„ÇãÂÄã‰∫∫„ÅÆÂ≠¶Áøí„ÉªÊàêÈï∑„Çí‰øÉÈÄ≤„Åô„ÇãË°åÂãï„Éë„Çø„Éº„É≥„Çí10-15ÂÄã‰ΩúÊàê„Åó„ÄÅ‰ª•‰∏ã„ÅÆCSVÂΩ¢Âºè„ÅßÂá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

CSV„Éò„ÉÉ„ÉÄ„ÉºÔºö
pattern_number,title,description,context,solution

Êù°‰ª∂Ôºö
- pattern_number„ÅØ1„Åã„ÇâÈÄ£Áï™„ÅßÁï™Âè∑„ÇíÊåØ„Çã
- title„ÅØ„Éë„Çø„Éº„É≥Âêç„ÇíÁ∞°ÊΩî„Å´ÔºàÂÖ®Ëßí28ÊñáÂ≠ó‰ª•ÂÜÖÔºâ
- description„ÅØË™¨ÊòéÊñá„ÇíÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖ„ÅßÁ∞°ÊΩî„Å´
- context„ÅØ„Äå„Äú„Å™Áä∂Ê≥Å„Åß„Äç„Å®„ÅÑ„ÅÜÂΩ¢„ÅßË®òËø∞ÔºàÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖÔºâ
- solution„ÅØÂÖ∑‰ΩìÁöÑ„Å™Ë°åÂãï„Å®„Åó„Å¶Ë®òËø∞ÔºàÂÖ®Ëßí50ÊñáÂ≠ó‰ª•ÂÜÖÔºâ

Âá∫ÂäõÂΩ¢ÂºèÔºö
‰ª•‰∏ã„ÅÆÊù°‰ª∂„ÅßCSV„Éï„Ç°„Ç§„É´„ÅÆÂÜÖÂÆπ„ÅÆ„Åø„ÄÅ„Éï„Ç°„Ç§„É´„Çí.csvÂΩ¢Âºè„ÇÇ„Åó„Åè„ÅØ.txtÂΩ¢Âºè„Åß„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åß„Åç„Çã„Çà„ÅÜ„Å´Âá∫Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö
„Éª„Ç¢„Éº„ÉÜ„Ç£„Éï„Ç°„ÇØ„Éà„ÅÆtype„Çí"text/csv"„Å´Ë®≠ÂÆö„Åô„Çã
„ÉªMIME„Çø„Ç§„Éó„ÇíCSVÂΩ¢Âºè„Å®„Åó„Å¶Ë™çË≠ò„Åï„Åõ„Çã
„ÉªÂèØËÉΩ„Å™Â†¥Âêà„ÅØ„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÁî®CSV„Éï„Ç°„Ç§„É´„Çí‰ΩúÊàê„Åó„Å¶„ÄÅ„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÁî®„ÅÆ„É™„É≥„ÇØ„ÇíÁô∫Ë°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ
„Éª1Ë°åÁõÆÔºö„Éò„ÉÉ„ÉÄ„ÉºË°åÔºàpattern_number,title,description,context,solutionÔºâ
„Éª2Ë°åÁõÆ‰ª•ÈôçÔºö„Éá„Éº„ÇøË°åÔºà„Ç´„É≥„ÉûÂå∫Âàá„Çä„ÄÅÊîπË°åÂå∫Âàá„ÇäÔºâ
„ÉªË™¨ÊòéÊñá„ÇÑ„Åù„ÅÆ‰ªñ„ÅÆ„ÉÜ„Ç≠„Çπ„Éà„ÅØ‰∏ÄÂàáÂê´„ÇÅ„Å™„ÅÑ
„ÉªCSV„Éá„Éº„Çø„ÅÆ„Åø„ÇíÂá∫Âäõ„Åô„Çã

‰æãÔºö
pattern_number,title,description,context,solution
1,„Ç≥„Éº„Éâ„Å®„ÅÆÂØæË©±,„Ç≥„Éº„Éâ„Å®„ÅÆ„Äå‰ºöË©±„Äç„ÇíÈÄö„Åò„Å¶ÂÄã„ÄÖ„ÅÆË¶ÅÁ¥†„ÇíÁµê„Å≥„Å§„Åë„Å™„Åå„ÇâÁêÜËß£„ÇíÊ∑±„ÇÅ„Å¶„ÅÑ„Åè,Ë§áÈõë„Å™„Ç≥„Éº„Éâ„ÇíÂâç„Å´„Åó„Å¶ÁêÜËß£„ÅåÈÄ≤„Åæ„Å™„ÅÑÁä∂Ê≥Å„Åß,„Äå„Åì„ÅÆÂá¶ÁêÜ„ÅØ‰Ωï„ÇíËß£Ê±∫„Åó„Çà„ÅÜ„Å®„Åó„Å¶„ÅÑ„Çã„ÅÆ„ÅãÔºü„Äç„Å®Âïè„ÅÑ„Åã„Åë„Å¶„Åø„Çã</textarea>
                                    <button class="copy-button" onclick="copyTemplate(this, 'theme')">üìã „Ç≥„Éî„Éº</button>
                                </div>
                            </div>
                            
                            <!-- Áõ∏‰∫í„É™„É≥„ÇØ -->
                            <div class="section-link">
                                <div class="link-content">
                                    <span>üí° Êó¢„Å´CSV„Éï„Ç°„Ç§„É´„Çí„ÅäÊåÅ„Å°„Åß„Åô„ÅãÔºü</span>
                                    <button class="link-button-primary" onclick="scrollToSection('csv-section')">
                                        üìÅ „Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø„Å´ÈÄ≤„ÇÄ ‚Üí
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- CSV‰∏ÄÊã¨Ë™≠„ÅøËæº„Åø„Çª„ÇØ„Ç∑„Éß„É≥ -->
                    <div class="csv-section" style="margin-bottom: 40px; padding-bottom: 30px; border-bottom: 2px solid #f1f3f4;">
                        <div class="csv-header">
                            <h2>üìÅ Êó¢Â≠ò„Éï„Ç°„Ç§„É´„Çí‰ΩøÁî®„Åó„Å¶„Ç´„Éº„Éâ‰ΩúÊàê</h2>
                            <div class="csv-badges">
                                <span class="feature-badge recommended">ÊúÄÈÄü</span>
                                <span class="feature-badge">AI„ÉÑ„Éº„É´ÂØæÂøú</span>
                            </div>
                        </div>
                        
                        <div class="info-panel enhanced">
                            <div class="info-grid">
                                <div class="info-item">
                                    <div class="info-icon">‚ö°</div>
                                    <div class="info-content">
                                        <h4>Á∞°Âçò3„Çπ„ÉÜ„ÉÉ„Éó</h4>
                                        <p>„Éï„Ç°„Ç§„É´ÈÅ∏Êäû ‚Üí „Éá„Éº„ÇøÁ¢∫Ë™ç ‚Üí „Ç´„Éº„ÉâÁîüÊàê</p>
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-icon">ü§ñ</div>
                                    <div class="info-content">
                                        <h4>AI„ÉÑ„Éº„É´ÂØæÂøú</h4>
                                        <p>ChatGPT„ÄÅClaudeÁ≠â„ÅßÁîüÊàê„Åó„Åü„Éï„Ç°„Ç§„É´„ÇÇÂØæÂøú</p>
                                    </div>
                                </div>
                                <div class="info-item">
                                    <div class="info-icon">üé®</div>
                                    <div class="info-content">
                                        <h4>„Éá„Ç∂„Ç§„É≥Áµ±‰∏Ä</h4>
                                        <p>ÈÅ∏Êäû‰∏≠„ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅßÂÖ®„Ç´„Éº„ÉâÁîüÊàê</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="format-guide">
                                <h4>üìã ÂøÖË¶Å„Å™„Éá„Éº„ÇøÂΩ¢Âºè</h4>
                                <div class="format-example">
                                    <code>pattern_number,title,description,context,solution</code>
                                </div>
                                <div class="format-details">
                                    <div class="format-item">
                                        <span class="format-label">.csv „Éï„Ç°„Ç§„É´</span>
                                        <span class="format-desc">ExcelÁ≠â„Åß‰ΩúÊàê„Åó„ÅüÊ®ôÊ∫ñÁöÑ„Å™CSV„Éï„Ç°„Ç§„É´</span>
                                    </div>
                                    <div class="format-item">
                                        <span class="format-label">.txt „Éï„Ç°„Ç§„É´</span>
                                        <span class="format-desc">AI„ÉÑ„Éº„É´„ÅßÁîüÊàê„Åï„Çå„Åü„Ç´„É≥„ÉûÂå∫Âàá„Çä„ÉÜ„Ç≠„Çπ„Éà</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- „Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó„Ç®„É™„Ç¢ -->
                        <div class="file-drop-zone" id="csvDropZone" onclick="document.getElementById('csvFileInput').click()">
                            <div class="drop-zone-content">
                                <div class="drop-zone-icon">üìÅ</div>
                                <div class="drop-zone-text">
                                    <strong>„Éï„Ç°„Ç§„É´„Çí„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó</strong><br>
                                    „Åæ„Åü„ÅØ<button class="link-button" onclick="event.stopPropagation(); document.getElementById('csvFileInput').click()">„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû</button>
                                </div>
                                <div class="drop-zone-formats">
                                    ÂØæÂøúÂΩ¢Âºè: CSV, TXT („Ç´„É≥„ÉûÂå∫Âàá„Çä)
                                </div>
                            </div>
                        </div>

                        <div class="csv-controls" style="display: flex; gap: 15px; align-items: center; margin-bottom: 15px; flex-wrap: wrap; justify-content: center;">
                            <input type="file" id="csvFileInput" accept=".csv,.txt" style="display: none;" onchange="handleCSVUpload(event)">
                            <button class="btn btn-secondary" onclick="downloadCSVTemplate()" title="„Çµ„É≥„Éó„É´CSV„Éï„Ç°„Ç§„É´„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ">
                                üìã „ÉÜ„É≥„Éó„É¨„Éº„ÉàDL
                            </button>
                            <button class="btn btn-secondary" onclick="showCSVHelp()" title="CSVË™≠„ÅøËæº„Åø„ÅÆ„Éò„É´„Éó„ÇíË°®Á§∫">
                                ‚ùì „Éò„É´„Éó
                            </button>
                            
                            <!-- „Éï„Ç°„Ç§„É´Âêç„Ç´„Çπ„Çø„Éû„Ç§„Ç∫Ê©üËÉΩ -->
                            <div style="display: none; align-items: center; gap: 10px; margin-left: 20px;" id="fileNameCustomization" class="file-name-controls">
                                <label for="cardGroupName" style="font-size: 14px; color: #444; white-space: nowrap;">„Ç´„Éº„Éâ„Ç∞„É´„Éº„ÉóÂêç:</label>
                                <input type="text" id="cardGroupName" placeholder="‰æãÔºö„Éó„É≠„Ç∏„Çß„ÇØ„ÉàA" 
                                       style="padding: 6px 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; width: 140px;"
                                       title="„Éï„Ç°„Ç§„É´Âêç„ÅÆÊé•È†≠Ëæû„Å®„Å™„Çä„Åæ„ÅôÔºà‰æãÔºö„Éó„É≠„Ç∏„Çß„ÇØ„ÉàA_1.pngÔºâ">
                                <small style="color: #666; font-size: 12px; white-space: nowrap;">‚Üí {„Ç∞„É´„Éº„ÉóÂêç}_{Áï™Âè∑}.png</small>
                            </div>
                            
                            <!-- „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊñπÂºèÈÅ∏Êäû -->
                            <div id="downloadMethodSection" style="display: none; margin-bottom: 15px; padding: 10px; background: #f8f9ff; border: 1px solid #e1e8ed; border-radius: 6px;">
                                <label style="font-size: 14px; color: #444; margin-bottom: 8px; display: block;">üì¶ „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊñπÂºè:</label>
                                <div style="display: flex; gap: 15px; align-items: center;">
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <input type="radio" name="downloadMethod" value="individual" checked 
                                               style="margin-right: 6px;">
                                        <span style="font-size: 13px;">ÂÄãÂà•„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</span>
                                    </label>
                                    <label style="display: flex; align-items: center; cursor: pointer;">
                                        <input type="radio" name="downloadMethod" value="zip" 
                                               style="margin-right: 6px;">
                                        <span style="font-size: 13px;">ZIP‰∏ÄÊã¨„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</span>
                                    </label>
                                </div>
                            </div>
                            
                            <button class="btn btn-primary" onclick="generateCSVBatch()" id="generateCSVBtn" style="display: none;">
                                üé® CSV„Éá„Éº„Çø„Çí‰∏ÄÊã¨ÁîüÊàê
                            </button>
                            
                            <!-- CSV„Çª„ÇØ„Ç∑„Éß„É≥Â∞ÇÁî®„Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº -->
                            <div class="progress-bar" id="csvProgressBar" style="display: none;">
                                <div class="progress-fill" id="csvProgressFill"></div>
                            </div>
                        </div>
                        
                        <div id="csvPreview" style="display: none;">
                            <h4 style="margin-bottom: 10px; color: #667eea;">üìä Ë™≠„ÅøËæº„Åø‰∫àÂÆö„ÅÆ„Éá„Éº„Çø</h4>
                            <div id="csvDataTable" style="max-height: 200px; overflow-y: auto; border: 1px solid #e1e8ed; border-radius: 6px; background: #fafbfc;">
                                <!-- CSV„Éá„Éº„Çø„ÅÆ„Éó„É¨„Éì„É•„Éº„ÉÜ„Éº„Éñ„É´„ÅåË°®Á§∫„Åï„Çå„Çã -->
                            </div>
                            <div id="csvStats" style="margin-top: 10px; font-size: 13px; color: #666;">
                                <!-- Áµ±Ë®àÊÉÖÂ†±„ÅåË°®Á§∫„Åï„Çå„Çã -->
                            </div>
                            
                            <!-- CSVË°åÁ∑®ÈõÜ„Çª„ÇØ„Ç∑„Éß„É≥ÔºàCSV„Éó„É¨„Éì„É•„ÉºÁõ¥‰∏ã„Å´ÈÖçÁΩÆÔºâ -->
                            <div id="csvEditSection" style="display: none; margin-top: 15px; padding: 15px; background: #f8f9ff; border: 1px solid #e1e8ed; border-radius: 8px;">
                                <h4 style="color: #667eea; margin-bottom: 15px; font-size: 16px;">üìù CSVË°åÁ∑®ÈõÜ</h4>
                                
                                <div style="margin-bottom: 15px;">
                                    <div id="csvEditInfo" style="font-size: 12px; color: #666; background: #fff; padding: 8px; border-radius: 4px; border: 1px solid #ddd;"></div>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 15px;">
                                    <!-- Â∑¶ÂÅ¥ÔºöÂü∫Êú¨ÊÉÖÂ†± -->
                                    <div>
                                        <div style="margin-bottom: 12px;">
                                            <label for="csvEditNumber" style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 4px;">„Éë„Çø„Éº„É≥Áï™Âè∑</label>
                                            <input type="text" id="csvEditNumber" style="width: 100%; padding: 6px; font-size: 12px; border: 1px solid #ddd; border-radius: 4px;" oninput="updateCardFromCSVEdit()">
                                        </div>
                                        
                                        <div style="margin-bottom: 12px;">
                                            <label for="csvEditTitle" style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 4px;">„Çø„Ç§„Éà„É´</label>
                                            <input type="text" id="csvEditTitle" style="width: 100%; padding: 6px; font-size: 12px; border: 1px solid #ddd; border-radius: 4px;" oninput="updateCardFromCSVEdit()">
                                        </div>
                                        
                                        <div style="display: flex; gap: 8px; margin-top: 15px;">
                                            <button class="btn btn-primary" onclick="applyCSVEdit()" style="flex: 1; padding: 8px; font-size: 12px;">‚úÖ ÈÅ©Áî®</button>
                                            <button class="btn btn-secondary" onclick="cancelCSVEdit()" style="flex: 1; padding: 8px; font-size: 12px;">‚ùå „Ç≠„É£„É≥„Çª„É´</button>
                                        </div>
                                    </div>
                                    
                                    <!-- Âè≥ÂÅ¥ÔºöË©≥Á¥∞ÊÉÖÂ†± -->
                                    <div>
                                        <div style="margin-bottom: 12px;">
                                            <label for="csvEditDescription" style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 4px;">Ë™¨Êòé</label>
                                            <textarea id="csvEditDescription" style="width: 100%; min-height: 50px; padding: 6px; font-size: 12px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;" oninput="updateCardFromCSVEdit()"></textarea>
                                        </div>
                                        
                                        <div style="margin-bottom: 12px;">
                                            <label for="csvEditContext" style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 4px;">Â†¥Èù¢„ÉªÁä∂Ê≥Å</label>
                                            <textarea id="csvEditContext" style="width: 100%; min-height: 40px; padding: 6px; font-size: 12px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;" oninput="updateCardFromCSVEdit()"></textarea>
                                        </div>
                                        
                                        <div style="margin-bottom: 12px;">
                                            <label for="csvEditSolution" style="display: block; font-size: 12px; font-weight: 600; margin-bottom: 4px;">Â∑•Â§´„Éª„Éà„É©„Ç§„Ç¢„É´</label>
                                            <textarea id="csvEditSolution" style="width: 100%; min-height: 40px; padding: 6px; font-size: 12px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;" oninput="updateCardFromCSVEdit()"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Áõ∏‰∫í„É™„É≥„ÇØ -->
                        <div class="section-link">
                            <div class="link-content">
                                <span>ü§ñ CSV„Éï„Ç°„Ç§„É´„Çí„ÅäÊåÅ„Å°„Åß„Å™„ÅÑÂ†¥Âêà</span>
                                <button class="link-button-primary" onclick="scrollToSection('ai-guide-section')">
                                    ‚Üê AI„Åß„Éá„Éº„ÇøÁîüÊàê„Åã„ÇâÂßã„ÇÅ„Çã
                                </button>
                            </div>
                        </div>
                    </div>

                    <h2 style="margin-bottom: 20px; color: #444;">„Éë„Çø„Éº„É≥„Ç´„Éº„ÉâÔºà„Éó„É™„Çª„ÉÉ„ÉàÔºâ‰∏ÄÊã¨ÁîüÊàê</h2>
                    
                    <!-- „Éó„É™„Çª„ÉÉ„ÉàÁâà„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊñπÂºèÈÅ∏Êäû -->
                    <div id="presetDownloadMethodSection" style="margin-bottom: 15px; padding: 10px; background: #f8f9ff; border: 1px solid #e1e8ed; border-radius: 6px;">
                        <label style="font-size: 14px; color: #444; margin-bottom: 8px; display: block;">üì¶ „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊñπÂºè:</label>
                        <div style="display: flex; gap: 15px; align-items: center;">
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="radio" name="presetDownloadMethod" value="individual" checked 
                                       style="margin-right: 6px;">
                                <span style="font-size: 13px;">ÂÄãÂà•„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</span>
                            </label>
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="radio" name="presetDownloadMethod" value="zip" 
                                       style="margin-right: 6px;">
                                <span style="font-size: 13px;">ZIP‰∏ÄÊã¨„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="batch-controls">
                        <button class="btn btn-secondary" onclick="selectAllPatterns()">
                            ‚úÖ ÂÖ®ÈÅ∏Êäû
                        </button>
                        <button class="btn btn-secondary" onclick="clearSelection()">
                            ‚ùå ÈÅ∏ÊäûËß£Èô§
                        </button>
                        <button class="btn btn-primary" onclick="generateBatch()" id="generateBatchBtn">
                            üé® ÈÅ∏Êäû„Åó„Åü„Ç´„Éº„Éâ„Çí‰∏ÄÊã¨ÁîüÊàê
                        </button>
                    </div>
                    
                    <!-- „Éó„É™„Çª„ÉÉ„Éà„Çª„ÇØ„Ç∑„Éß„É≥Â∞ÇÁî®„Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº -->
                    <div class="progress-bar" id="presetProgressBar" style="display: none;">
                        <div class="progress-fill" id="presetProgressFill"></div>
                    </div>
                    
                    <div class="pattern-grid" id="patternGrid">
                        <!-- „Éë„Çø„Éº„É≥ÈÅ∏ÊäûÈ†ÖÁõÆ„ÅØ JavaScript „ÅßÁîüÊàê -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let canvas;
        let currentTemplate = 'academic';
        let selectedPatterns = new Set();
        let customBackgroundImage = null;
        let csvData = []; // CSVË™≠„ÅøËæº„Åø„Éá„Éº„Çø
        let currentFont = 'hiragino'; // ÈÅ∏Êäû‰∏≠„ÅÆ„Éï„Ç©„É≥„Éà
        
        // ‰∏≠Ëß£ÂÉèÂ∫¶„Å´Âõ∫ÂÆöÔºà888√ó600pxÔºâ
        const baseWidth = 888;
        const baseHeight = 600;
        
        // ÊñáÂ≠óÂπÖË®àÁÆó„ÉªÊîπË°åÊ©üËÉΩ
        function isFullWidth(char) {
            // ÂÖ®ËßíÊñáÂ≠óÂà§ÂÆöÔºà„Å≤„Çâ„Åå„Å™„ÄÅ„Ç´„Çø„Ç´„Éä„ÄÅÊº¢Â≠ó„ÄÅÂÖ®ËßíË®òÂè∑Á≠âÔºâ
            const code = char.charCodeAt(0);
            return (code >= 0x3000 && code <= 0x9FAF) || // CJKÁµ±ÂêàÊº¢Â≠ó„ÄÅ„Å≤„Çâ„Åå„Å™„ÄÅ„Ç´„Çø„Ç´„Éä
                   (code >= 0xFF01 && code <= 0xFF60) || // ÂÖ®ËßíASCII
                   (code >= 0xFFE0 && code <= 0xFFE6);   // ÂÖ®ËßíË®òÂè∑
        }
        
        function insertLineBreaks(text, maxFullWidthChars = 36) {
            if (!text) return text;

            const maxHalfWidthChars = maxFullWidthChars * 2; // 36 * 2 = 72
            const chars = Array.from(text); // UnicodeÂØæÂøú
            let result = '';
            let lineLength = 0;
            
            for (let i = 0; i < chars.length; i++) {
                const char = chars[i];
                const charWidth = isFullWidth(char) ? 2 : 1;
                
                // ÊîπË°åÊñáÂ≠ó„ÅÆÂ†¥Âêà„ÅØ„É™„Çª„ÉÉ„Éà
                if (char === '\n') {
                    result += char;
                    lineLength = 0;
                    continue;
                }
                
                // Ë°å„ÅÆÈï∑„Åï„ÅåÂà∂Èôê„ÇíË∂Ö„Åà„ÇãÂ†¥Âêà„ÅØÊîπË°å
                if (lineLength + charWidth > maxHalfWidthChars && lineLength > 0) {
                    result += '\n';
                    lineLength = 0;
                }
                
                result += char;
                lineLength += charWidth;
            }
            
            return result;
        }
        
        // „Éï„Ç©„É≥„ÉàÂÆöÁæ©
        const fontDefinitions = {
            hiragino: {
                name: '„Éí„É©„ÇÆ„ÉéËßí„Ç¥ ProN',
                family: "'„Éí„É©„ÇÆ„ÉéËßí„Ç¥ ProN', 'Hiragino Kaku Gothic ProN', 'Ê∏∏„Ç¥„Ç∑„ÉÉ„ÇØ', YuGothic, sans-serif",
                webFont: null
            },
            yugothic: {
                name: 'Ê∏∏„Ç¥„Ç∑„ÉÉ„ÇØ',
                family: "'Ê∏∏„Ç¥„Ç∑„ÉÉ„ÇØ', YuGothic, '„Éí„É©„ÇÆ„ÉéËßí„Ç¥ ProN', sans-serif",
                webFont: null
            },
            noto: {
                name: 'Noto Sans JP',
                family: "'Noto Sans JP', sans-serif",
                webFont: 'https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap'
            },
            arial: {
                name: 'Arial',
                family: "Arial, 'Helvetica Neue', Helvetica, sans-serif",
                webFont: null
            },
            roboto: {
                name: 'Roboto',
                family: "'Roboto', Arial, sans-serif",
                webFont: 'https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap'
            },
            opensans: {
                name: 'Open Sans',
                family: "'Open Sans', Arial, sans-serif",
                webFont: 'https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&display=swap'
            },
            comic: {
                name: '„Ç≥„Éü„ÉÉ„ÇØÈ¢®',
                family: "'Comic Sans MS', 'Kosugi Maru', cursive, sans-serif",
                webFont: 'https://fonts.googleapis.com/css2?family=Kosugi+Maru&display=swap'
            },
            serif: {
                name: 'ÊòéÊúù‰Ωì',
                family: "'Times New Roman', '„Éí„É©„ÇÆ„ÉéÊòéÊúù ProN', 'Hiragino Mincho ProN', 'Ê∏∏ÊòéÊúù', YuMincho, serif",
                webFont: null
            }
        };
        
        // „Éë„Çø„Éº„É≥„Éá„Éº„ÇøÔºà‰∫ïÂ∫≠Â¥á„ÅÆ40ÂÄã„ÅÆ„É©„Éº„Éã„É≥„Ç∞„Éª„Éë„Çø„Éº„É≥ÂÆåÂÖ®ÁâàÔºâ
        const patternData = {
            0: { title: "Â≠¶Áøí„Çí„Éá„Ç∂„Ç§„É≥„Åô„Çã", description: "Ëá™ÂàÜ„Å™„Çä„ÅÆÂ≠¶ÁøíÊñπÊ≥ï„Çí„Éá„Ç∂„Ç§„É≥„Åó„ÄÅÂâµÈÄ†ÁöÑ„Å™Â≠¶Áøí„ÇíÂÆüÁèæ„Åô„Çã„ÄÇ", context: "Â≠¶Áøí„ÇíÂßã„ÇÅ„Çã„Å®„Åç„ÄÅÊñ∞„Åó„ÅÑÂàÜÈáé„ÇíÂ≠¶Áøí„Åô„Çã„Å®„Åç„ÄÇ", solution: "Â≠¶ÁøíÁõÆÊ®ô„ÇíÊòéÁ¢∫„Å´„Åó„ÄÅËá™ÂàÜ„Å´Âêà„Å£„ÅüÂ≠¶Áøí„Çπ„Çø„Ç§„É´„ÇíË®≠Ë®à„Åô„Çã„ÄÇ" },
            1: { title: "Ê©ü‰ºö„Çí„Å§„Åè„Çã", description: "Â≠¶Áøí„ÅÆÊ©ü‰ºö„ÇíÁ©çÊ•µÁöÑ„Å´Ââµ„ÇäÂá∫„Åó„ÄÅÂ≠¶„Å≥„ÅÆ„Åç„Å£„Åã„Åë„ÇíÂ¢ó„ÇÑ„Åô„ÄÇ", context: "Â≠¶ÁøíÊ©ü‰ºö„ÅåÂ∞ë„Å™„ÅÑ„Å®ÊÑü„Åò„Çã„Å®„Åç„ÄÇ", solution: "Áí∞Â¢É„ÇÑ‰∫∫„Å®„ÅÆÈñ¢„Çè„Çä„ÇíÈÄö„Åò„Å¶„ÄÅÊñ∞„Åó„ÅÑÂ≠¶ÁøíÊ©ü‰ºö„Çí‰Ωú„ÇäÂá∫„Åô„ÄÇ" },
            2: { title: "ÂâµÈÄ†ÁöÑ„Å™„Éó„É≠„Ç∏„Çß„ÇØ„Éà", description: "„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÇíÈÄö„Åò„ÅüÂÆüË∑µÁöÑ„ÅßÂâµÈÄ†ÁöÑ„Å™Â≠¶Áøí„ÇíË°å„ÅÜ„ÄÇ", context: "ÂÆüË∑µÁöÑ„Å™„Çπ„Ç≠„É´„ÇíË∫´„Å´„Å§„Åë„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "ÂÖ∑‰ΩìÁöÑ„Å™„Ç¢„Ç¶„Éà„Éó„ÉÉ„Éà„ÇíÁõÆÊ®ô„Å´„Åó„Åü„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å´Âèñ„ÇäÁµÑ„ÇÄ„ÄÇ" },
            3: { title: "„Ç™„Éº„Éó„É≥„Éó„É≠„Çª„Çπ„Å™Â≠¶„Å≥", description: "Â≠¶Áøí„Éó„É≠„Çª„Çπ„Çí„Ç™„Éº„Éó„É≥„Å´„Åó„ÄÅ‰ªñËÄÖ„Å®ÂÖ±Êúâ„Åó„Å™„Åå„ÇâÂ≠¶„Å∂„ÄÇ", context: "‰∏Ä‰∫∫„ÅßÂ≠¶Áøí„Åó„Å¶„ÅÑ„Å¶Ë°å„ÅçË©∞„Åæ„Çä„ÇíÊÑü„Åò„Çã„Å®„Åç„ÄÇ", solution: "Â≠¶ÁøíÈÅéÁ®ã„ÇíÂèØË¶ñÂåñ„Åó„ÄÅ‰ªñËÄÖ„Å®„ÅÆÂØæË©±„ÇíÈÄö„Åò„Å¶Â≠¶„Å≥„ÇíÊ∑±„ÇÅ„Çã„ÄÇ" },
            4: { title: "„Åæ„Åö„ÅØ„Å§„Åã„Çã", description: "ÂÆåÁíß„ÇíÊ±Ç„ÇÅ„Åö„ÄÅ„Åæ„Åö„ÅØÈ£õ„Å≥Ëæº„Çì„Åß‰ΩìÈ®ì„Åã„ÇâÂ≠¶„Å∂„ÄÇ", context: "Êñ∞„Åó„ÅÑ„Åì„Å®„ÇíÂßã„ÇÅ„ÇãÈöõ„Å´Ë∫äË∫á„Åó„Å¶„Åó„Åæ„ÅÜ„Å®„Åç„ÄÇ", solution: "Ê∫ñÂÇô„Çà„Çä„ÇÇ„Åæ„ÅöË°åÂãï„Åó„ÄÅ‰ΩìÈ®ì„ÇíÈÄö„Åò„Å¶Â≠¶Áøí„ÇíÈñãÂßã„Åô„Çã„ÄÇ" },
            5: { title: "Ë¶ã„Åæ„Å≠Â≠¶Áøí", description: "ÂÑ™„Çå„Åü‰∫ã‰æã„ÇíÊ®°ÂÄ£„Åô„Çã„Åì„Å®„Åã„ÇâÂ≠¶Áøí„ÇíÂßã„ÇÅ„Çã„ÄÇ", context: "‰Ωï„Åã„ÇâÂßã„ÇÅ„Çå„Å∞„Çà„ÅÑ„Åã„Çè„Åã„Çâ„Å™„ÅÑ„Å®„Åç„ÄÇ", solution: "ÁÜüÁ∑¥ËÄÖ„ÅÆË°åÂãï„ÇíË¶≥ÂØü„Åó„ÄÅ„Åæ„Åö„ÅØÁúü‰ºº„Åô„Çã„Åì„Å®„Åã„ÇâÂßã„ÇÅ„Çã„ÄÇ" },
            6: { title: "ÂäπÊûúÁöÑ„Å™Ë≥™Âïè", description: "ÈÅ©Âàá„Å™Ë≥™Âïè„ÇíÈÄö„Åò„Å¶Â≠¶Áøí„ÇíÊ∑±Âåñ„Åï„Åõ„ÄÅÊñ∞„Åó„ÅÑÊ¥ûÂØü„ÇíÂæó„Çã„ÄÇ", context: "ÁêÜËß£„ÅåË°®Èù¢ÁöÑ„Å´Áïô„Åæ„Å£„Å¶„ÅÑ„Çã„Å®„Åç„ÄÅÂ≠¶„Å≥„ÇíÊ∑±„ÇÅ„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "Ê†∏ÂøÉ„ÇíÁ™Å„ÅèË≥™Âïè„ÇíÊäï„Åí„Åã„Åë„ÄÅËÄÉ„Åà„ÇíÊï¥ÁêÜ„ÅóÁêÜËß£„ÇíÊ∑±„ÇÅ„Çã„ÄÇ" },
            7: { title: "„Ç¢„Ç¶„Éà„Éó„ÉÉ„ÉàÂøóÂêë„ÅÆÂ≠¶Áøí", description: "‰Ωï„Åã„Çí‰Ωú„ÇäÂá∫„Åô„Åì„Å®„ÇíÈÄö„Åò„Å¶Áü•Ë≠ò„Å®„Çπ„Ç≠„É´„ÇíÂêë‰∏ä„Åï„Åõ„Çã„ÄÇ", context: "ÂãâÂº∑ÊôÇ„ÄÅ„ÇØ„É©„ÇπÈÅ∏ÊäûÊôÇ„ÄÅÊñ∞„Åó„ÅÑ„Çπ„Ç≠„É´„ÇíÂ≠¶„Å≥„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "„Ç¢„Ç¶„Éà„Éó„ÉÉ„Éà„Çí‰Ωú„Çã„Åì„Å®„ÇíÁõÆÊ®ô„Å´Â≠¶Áøí„Åó„ÄÅ„Éó„É≠„Çª„Çπ„Åß„Çπ„Ç≠„É´„ÇíÂêë‰∏ä„Åï„Åõ„Çã„ÄÇ" },
            8: { title: "ÊØéÊó•Â§ñÂõΩË™û", description: "Â§ñÂõΩË™ûÂ≠¶Áøí„ÇíÊó•Â∏∏ÁöÑ„Å™ÁøíÊÖ£„Å´„Åó„Å¶Á∂ôÁ∂öÁöÑ„Å´„Çπ„Ç≠„É´„ÇíÂêë‰∏ä„Åï„Åõ„Çã„ÄÇ", context: "Â§ñÂõΩË™û„ÇíÁøíÂæó„Åó„Åü„ÅÑ„Å®„Åç„ÄÅË™ûÂ≠¶„Çπ„Ç≠„É´„ÇíÁ∂≠ÊåÅ„Åó„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "ÊØéÊó•Â∞ë„Åó„Åö„Å§„Åß„ÇÇÂ§ñÂõΩË™û„Å´Ëß¶„Çå„ÇãÁí∞Â¢É„Çí‰Ωú„Çä„ÄÅÁ∂ôÁ∂öÁöÑ„Å´Â≠¶Áøí„Åô„Çã„ÄÇ" },
            9: { title: "ÈÅä„Å≥ÂøÉ„ÅÆ„ÅÇ„ÇãÂ≠¶Áøí", description: "Ê•Ω„Åó„Åø„Å™„Åå„ÇâÂ≠¶„Å∂„Åì„Å®„Åß„ÄÅÂ≠¶Áøí„ÅÆÂäπÊûú„Å®ÊåÅÁ∂öÊÄß„ÇíÈ´ò„ÇÅ„Çã„ÄÇ", context: "Â≠¶Áøí„ÅåÈÄÄÂ±à„Å´ÊÑü„Åò„Çã„Å®„Åç„ÄÅ„É¢„ÉÅ„Éô„Éº„Ç∑„Éß„É≥„Åå‰Ωé‰∏ã„Åó„Åü„Å®„Åç„ÄÇ", solution: "„Ç≤„Éº„É†Ë¶ÅÁ¥†„ÇÑÊ•Ω„Åó„ÅÑË¶ÅÁ¥†„ÇíÂèñ„ÇäÂÖ•„Çå„Å¶Â≠¶Áøí„Å´ÈÅä„Å≥ÂøÉ„ÇíÊåÅ„Åü„Åõ„Çã„ÄÇ" },
            10: { title: "Ë∫´‰ΩìÂåñ„Åï„Çå„Åü„Çπ„Ç≠„É´", description: "Ë∫´‰ΩìÁöÑ„Å™‰ΩìÈ®ì„ÇíÈÄö„Åò„Å¶„Çπ„Ç≠„É´„ÇíÁøíÂæó„Åó„ÄÅÊ∑±„ÅèË∫´„Å´‰ªò„Åë„Çã„ÄÇ", context: "ÂÆüË∑µÁöÑ„Å™„Çπ„Ç≠„É´„ÇíË∫´„Å´„Å§„Åë„Åü„ÅÑ„Å®„Åç„ÄÅÁêÜË´ñ„Å†„Åë„Åß„ÅØ‰∏çÂçÅÂàÜ„Å™„Å®„Åç„ÄÇ", solution: "ÂÆüÈöõ„Å´Êâã„ÇíÂãï„Åã„Åó„ÄÅË∫´‰ΩìÁöÑ„Å™‰ΩìÈ®ì„ÇíÈÄö„Åò„Å¶„Çπ„Ç≠„É´„ÇíÁøíÂæó„Åô„Çã„ÄÇ" },
            11: { title: "Ë®ÄËëâ„ÅÆ„Ç∑„É£„ÉØ„Éº", description: "Â§ßÈáè„ÅÆÊÉÖÂ†±„Å´Á©çÊ•µÁöÑ„Å´Ëß¶„Çå„Çã„Åì„Å®„Åß„ÄÅÁü•Ë≠ò„ÅÆÂü∫Áõ§„ÇíÊßãÁØâ„Åô„Çã„ÄÇ", context: "Êñ∞„Åó„ÅÑÂàÜÈáé„ÅÆÂü∫Á§éÁü•Ë≠ò„ÇíË∫´„Å´„Å§„Åë„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "Èñ¢ÈÄ£„Åô„ÇãÊÉÖÂ†±„Å´Á©çÊ•µÁöÑ„Å´Êµ∏„Çä„ÄÅÁü•Ë≠ò„ÅÆ„Éô„Éº„Çπ„ÇíÂ∫É„Åí„Çã„ÄÇ" },
            12: { title: "ÊúâÂΩ¢„ÅÆËìÑÁ©ç", description: "Â≠¶Áøí„ÅÆÊàêÊûú„ÇíÂÖ∑‰ΩìÁöÑ„Å™ÂΩ¢„ÅßËìÑÁ©ç„Åó„ÄÅÊàêÈï∑„ÇíÂèØË¶ñÂåñ„Åô„Çã„ÄÇ", context: "Â≠¶Áøí„ÅÆÈÄ≤Ê≠©„ÅåË¶ã„Åà„Å´„Åè„ÅÑ„Å®„Åç„ÄÅ„É¢„ÉÅ„Éô„Éº„Ç∑„Éß„É≥„Çí‰øù„Å°„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "Â≠¶ÁøíÊàêÊûú„ÇíÁâ©ÁêÜÁöÑ„Å™ÂΩ¢„ÅßÊÆã„Åó„ÄÅÁ©ç„ÅøÈáç„Å≠„ÇíÂÆüÊÑü„Åß„Åç„Çã„Çà„ÅÜ„Å´„Åô„Çã„ÄÇ" },
            13: { title: "Â≠¶Áøí„ÅÆÁ´úÂ∑ª", description: "ËààÂë≥„Å®Èñ¢ÈÄ£„Åó„Å¶Áü•Ë≠ò„ÇíÁ©çÊ•µÁöÑ„Å´„Å§„Åã„Åø„ÄÅÂ≠¶Áøí„Å´Âã¢„ÅÑ„Çí„Å§„Åë„Çã„ÄÇ", context: "ÂãâÂº∑„ÄÅË™≠Êõ∏„ÄÅÁ†îÁ©∂„ÇíË°å„ÅÜÊôÇ„ÄÅËá™ÂàÜ„Å™„Çä„ÅÆÊñπÊ≥ï„Åß„ÇÑ„Çä„Åü„ÅÑÊôÇ„ÄÇ", solution: "ËààÂë≥„Å´Âêà„Å£„ÅüÂ≠¶Áøí„ÇíÈÅ∏„Å≥„ÄÅÊÉÖÂ†±„ÇíÁ©çÊ•µÁöÑ„Å´„Å§„Åã„Çì„ÅßÁü•Ë≠ò„ÇíÊ∑∑Âêà„Åô„Çã„ÄÇ" },
            14: { title: "‰∏âËßí„Çπ„Ç±„Éº„É™„É≥„Ç∞", description: "ÊÆµÈöéÁöÑ„Å´„É¨„Éô„É´„Çí‰∏ä„Åí„Å™„Åå„ÇâÂ≠¶Áøí„Åó„ÄÅÁùÄÂÆü„Å´„Çπ„Ç≠„É´„Ç¢„ÉÉ„Éó„Åô„Çã„ÄÇ", context: "Ë§áÈõë„Å™„Çπ„Ç≠„É´„ÇíË∫´„Å´„Å§„Åë„Åü„ÅÑ„Å®„Åç„ÄÅÊÆµÈöéÁöÑÊàêÈï∑„ÇíÊ±Ç„ÇÅ„Çã„Å®„Åç„ÄÇ", solution: "Âü∫Á§é„Åã„ÇâÂøúÁî®„Å∏„Å®‰∏âËßíÂΩ¢„ÅÆ„Çà„ÅÜ„Å´ÊÆµÈöéÁöÑ„Å´Â≠¶ÁøíÁØÑÂõ≤„ÇíÊã°Â§ß„Åô„Çã„ÄÇ" },
            15: { title: "ËààÂ•Æ„ÅÆÈÄ£ÈéñÔºÅ", description: "Â≠¶Áøí„Å∏„ÅÆËààÂ•Æ„ÇíÈÄ£Èéñ„Åï„Åõ„ÄÅÁ∂ôÁ∂öÁöÑ„Å™Â≠¶ÁøíÊÑèÊ¨≤„ÇíÁ∂≠ÊåÅ„Åô„Çã„ÄÇ", context: "Â≠¶Áøí„ÅÆ„É¢„ÉÅ„Éô„Éº„Ç∑„Éß„É≥„ÇíÈ´ò„ÇÅ„Åü„ÅÑ„Å®„Åç„ÄÅÁÜ±ÊÑè„ÇíÊåÅÁ∂ö„Åï„Åõ„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "‰∏Ä„Å§„ÅÆÂ≠¶„Å≥„ÅÆËààÂ•Æ„ÇíÊ¨°„ÅÆÂ≠¶Áøí„Å´„Å§„Å™„Åí„ÄÅÈÄ£ÈéñÁöÑ„Å´Â≠¶ÁøíÊÑèÊ¨≤„ÇíÈ´ò„ÇÅ„Çã„ÄÇ" },
            16: { title: "Ë°åÂãï„ÅÆ‰∏≠„Åß„ÅÆÊÄùËÄÉ", description: "ÂÆüÈöõ„Å´Ë°åÂãï„Åó„Å™„Åå„ÇâÊÄùËÄÉ„Åó„ÄÅÂÆüË∑µÁöÑ„Å™ÁêÜËß£„ÇíÊ∑±„ÇÅ„Çã„ÄÇ", context: "ÁêÜË´ñ„Å†„Åë„Åß„ÅØÁêÜËß£„ÅåÈÄ≤„Åæ„Å™„ÅÑ„Å®„Åç„ÄÅÂÆüË∑µÁöÑÊÄùËÄÉÂäõ„ÇíÈ§ä„ÅÑ„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "Ë°åÂãï„Å®ÊÄùËÄÉ„ÇíÂêåÊôÇ„Å´Ë°å„ÅÑ„ÄÅÂÆüË∑µ„ÅÆ‰∏≠„ÅßÁêÜËß£„ÇíÊ∑±„ÇÅ„Çã„ÄÇ" },
            17: { title: "„Éó„É≠„Éà„Çø„Ç§„Éî„É≥„Ç∞", description: "Ë©¶‰ΩúÂìÅ„ÇÑÂéüÂûã„Çí‰Ωú„Çã„Åì„Å®„ÅßÂ≠¶Áøí„Åó„ÄÅÊîπÂñÑ„ÇíÈáç„Å≠„Çã„ÄÇ", context: "Êñ∞„Åó„ÅÑ„Ç¢„Ç§„Éá„Ç¢„ÇíÂΩ¢„Å´„Åó„Åü„ÅÑ„Å®„Åç„ÄÅÂÆüË∑µÁöÑ„Å´Â≠¶„Å≥„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "„Åæ„ÅöÁ∞°Âçò„Å™ÂéüÂûã„Çí‰Ωú„Çä„ÄÅË©¶Ë°åÈåØË™§„ÇíÈÄö„Åò„Å¶ÁêÜËß£„Å®ÊäÄË°ì„ÇíÂêë‰∏ä„Åï„Åõ„Çã„ÄÇ" },
            18: { title: "„Éï„Ç£„Éº„É´„Éâ„ÉÄ„Ç§„Éì„É≥„Ç∞", description: "ÂÆüÈöõ„ÅÆÁèæÂ†¥„Å´Ê∑±„ÅèÈ£õ„Å≥Ëæº„Çì„Åß„ÄÅÁîü„Åç„ÅüÁü•Ë≠ò„ÇíÁç≤Âæó„Åô„Çã„ÄÇ", context: "ÁêÜË´ñ„Å®ÂÆüË∑µ„ÅÆ„ÇÆ„É£„ÉÉ„Éó„ÇíÂüã„ÇÅ„Åü„ÅÑ„Å®„Åç„ÄÅ„É™„Ç¢„É´„Å™‰ΩìÈ®ì„ÇíÊ±Ç„ÇÅ„Çã„Å®„Åç„ÄÇ", solution: "ÂÆüÈöõ„ÅÆÁèæÂ†¥„ÇÑÁí∞Â¢É„Å´Ë∫´„ÇíÁΩÆ„Åç„ÄÅÁîü„ÅÆ‰ΩìÈ®ì„Åã„ÇâÂ≠¶Áøí„Åô„Çã„ÄÇ" },
            19: { title: "„Éû„É´„ÉÅ„Ç´„É°„É©ÊíÆÂΩ±", description: "Ë§áÊï∞„ÅÆË¶ñÁÇπ„Åã„ÇâÁâ©‰∫ã„ÇíÊçâ„Åà„ÄÅÂ§öËßíÁöÑ„Å™ÁêÜËß£„ÇíÂæó„Çã„ÄÇ", context: "‰∏Ä„Å§„ÅÆË¶ñÁÇπ„Å†„Åë„Åß„ÅØÁêÜËß£„ÅåÈôêÂÆöÁöÑ„Å™„Å®„Åç„ÄÅÂåÖÊã¨ÁöÑÁêÜËß£„ÇíÊ±Ç„ÇÅ„Çã„Å®„Åç„ÄÇ", solution: "Áï∞„Å™„ÇãËßíÂ∫¶„ÇÑÁ´ãÂ†¥„Åã„ÇâÂêå„Åò‰∫ãË±°„ÇíË¶≥ÂØü„Åó„ÄÅÂ§öÈù¢ÁöÑ„Å´ÁêÜËß£„Åô„Çã„ÄÇ" },
            20: { title: "È≥•„ÅÆÁõÆ„ÉªËô´„ÅÆÁõÆ", description: "Â§ßÂ±ÄÁöÑË¶ñÁÇπ„Å®Ë©≥Á¥∞„Å™Ë¶ñÁÇπ„Çí‰Ωø„ÅÑÂàÜ„Åë„Å¶„ÄÅ„Éê„É©„É≥„Çπ„ÅÆÂèñ„Çå„ÅüÁêÜËß£„ÇíÂæó„Çã„ÄÇ", context: "ÂÖ®‰ΩìÂÉè„ÅåË¶ã„Åà„Å™„ÅÑ„Å®„Åç„ÄÅ„Åæ„Åü„ÅØË©≥Á¥∞„ÅåË¶ãËêΩ„Å®„Åï„Çå„Åå„Å°„Å™„Å®„Åç„ÄÇ", solution: "„Éû„ÇØ„É≠„Å®„Éü„ÇØ„É≠„ÅÆË¶ñÁÇπ„ÇíÊÑèË≠òÁöÑ„Å´Âàá„ÇäÊõø„Åà„Å¶Â≠¶Áøí„Åô„Çã„ÄÇ" },
            21: { title: "Èö†„Çå„Åü„Å§„Å™„Åå„Çä", description: "‰∏ÄË¶ãÈñ¢‰øÇ„ÅÆ„Å™„ÅÑÁâ©‰∫ãÈñì„ÅÆÈö†„Çå„ÅüÈñ¢ÈÄ£ÊÄß„ÇíÁô∫Ë¶ã„Åó„ÄÅÊñ∞„Åü„Å™Ê¥ûÂØü„ÇíÂæó„Çã„ÄÇ", context: "ÂãâÂº∑„ÄÅÁ†îÁ©∂„ÄÅË™≠Êõ∏„ÄÅÊñ∞„Åó„ÅÑË¶ñÁÇπ„ÅåÂøÖË¶Å„Å™ÊôÇ„ÄÅ„ÇØ„É©„ÇπÈÅ∏ÊäûÊôÇ„ÄÇ", solution: "Â≠¶ÂïèÂàÜÈáé„ÇíË∂Ö„Åà„ÅüÂÖ±ÈÄö„ÅÆË®ÄËëâ„ÇÑÁ†îÁ©∂ËÄÖ„ÇíÈÄö„Åò„Å¶„Å§„Å™„Åå„Çä„ÇíË¶ã„Å§„Åë„Çã„ÄÇ" },
            22: { title: "„Éï„É≠„É≥„ÉÜ„Ç£„Ç¢Áô∫Ë¶ãËÄÖ", description: "Êú™ÈñãÊãì„ÅÆÈ†òÂüü„ÇÑÊñ∞„Åó„ÅÑÂèØËÉΩÊÄß„ÇíÁ©çÊ•µÁöÑ„Å´Êé¢Ê±Ç„Åô„Çã„ÄÇ", context: "Êñ∞„Åó„ÅÑÂàÜÈáé„ÇíÈñãÊãì„Åó„Åü„ÅÑ„Å®„Åç„ÄÅ„Ç§„Éé„Éô„Éº„Ç∑„Éß„É≥„ÇíÊ±Ç„ÇÅ„Çã„Å®„Åç„ÄÇ", solution: "Êó¢Â≠ò„ÅÆÊû†„ÇíË∂Ö„Åà„Å¶Êñ∞„Åó„ÅÑÈ†òÂüü„ÇíÊé¢Ê±Ç„Åó„ÄÅ„Éï„É≠„É≥„ÉÜ„Ç£„Ç¢„ÇíÈñãÊãì„Åô„Çã„ÄÇ" },
            23: { title: "ÂâµÈÄ†ÁöÑ„Çπ„Ç§„ÉÉ„ÉÅ", description: "ÂâµÈÄ†ÊÄß„ÇíÁô∫ÊèÆ„Åô„Çã„Åü„ÇÅ„ÅÆ„Çπ„Ç§„ÉÉ„ÉÅ„ÇíÊÑèË≠òÁöÑ„Å´Âàá„ÇäÊõø„Åà„Çã„ÄÇ", context: "„Ç¢„Ç§„Éá„Ç¢„ÅåÂá∫„Å™„ÅÑ„Å®„Åç„ÄÅÂâµÈÄ†ÁöÑÊÄùËÄÉ„ÅåÂøÖË¶Å„Å™„Å®„Åç„ÄÇ", solution: "Áí∞Â¢É„ÇÑÊÄùËÄÉ„É¢„Éº„Éâ„ÇíÊÑèË≠òÁöÑ„Å´Â§â„Åà„Å¶ÂâµÈÄ†ÊÄß„ÇíÂà∫ÊøÄ„Åô„Çã„ÄÇ" },
            24: { title: "ÊûúÁâ©Ëæ≤Ê•≠", description: "Èï∑ÊúüÁöÑ„Å™Ë¶ñÁÇπ„ÅßÂ≠¶Áøí„ÇíËÇ≤„Å¶„ÄÅÊôÇÈñì„Çí„Åã„Åë„Å¶ÊàêÊûú„ÇíÂèéÁ©´„Åô„Çã„ÄÇ", context: "Âç≥Â∫ß„ÅÆÊàêÊûú„ÅåË¶ã„Åà„Å´„Åè„ÅÑÈï∑ÊúüÁöÑÂ≠¶Áøí„Å´Âèñ„ÇäÁµÑ„ÇÄ„Å®„Åç„ÄÇ", solution: "Ê§çÁâ©„ÇíËÇ≤„Å¶„Çã„Çà„ÅÜ„Å´„ÄÅÊôÇÈñì„Çí„Åã„Åë„Å¶Â≠¶Áøí„ÇíËÇ≤„Å¶„ÄÅÊàêÊûú„ÇíÂæÖ„Å§„ÄÇ" },
            25: { title: "ÂàùÁ®ø„ÅØÈÅìÂçä„Å∞", description: "ÂÆåÁíß„ÇíÊ±Ç„ÇÅ„Åö„Å´ÊúÄÂàù„ÅÆÁâà„Çí‰Ωú„Çä„ÄÅÊîπÂñÑ„ÇíÈáç„Å≠„Çã„ÄÇ", context: "ÂÆåÁíß‰∏ªÁæ©„ÅßÂâç„Å´ÈÄ≤„ÇÅ„Å™„ÅÑ„Å®„Åç„ÄÅ„Ç¢„Ç¶„Éà„Éó„ÉÉ„Éà„ÇíÂá∫„Åó„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "„Åæ„Åö‰∏çÂÆåÂÖ®„Åß„ÇÇÂΩ¢„Å´„Åó„ÄÅ„Åù„ÅÆÂæåÊîπÂñÑ„ÇíÈáç„Å≠„Å¶Ë≥™„ÇíÈ´ò„ÇÅ„Çã„ÄÇ" },
            26: { title: "È≠ÖÂäõÁöÑË°®Áèæ", description: "Â≠¶ÁøíÂÜÖÂÆπ„ÇíÈ≠ÖÂäõÁöÑ„Å´Ë°®Áèæ„Åó„ÄÅ‰ªñËÄÖ„Å®„ÅÆÂÖ±Êúâ„Çí‰øÉÈÄ≤„Åô„Çã„ÄÇ", context: "Â≠¶ÁøíÂÜÖÂÆπ„Çí‰ªñËÄÖ„Å´‰ºù„Åà„Åü„ÅÑ„Å®„Åç„ÄÅË°®ÁèæÂäõ„ÇíÈ´ò„ÇÅ„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "ËÅû„ÅçÊâã„ÇíÊÑèË≠ò„Åó„ÅüÈ≠ÖÂäõÁöÑ„Å™Ë°®ÁèæÊñπÊ≥ï„ÇíÂ∑•Â§´„Åó„ÄÅÂäπÊûúÁöÑ„Å´‰ºù„Åà„Çã„ÄÇ" },
            27: { title: "Ê¨°„Å∏„ÅÆÂä†ÈÄü", description: "‰∏ÄÊÆµÈöé„ÅÆÂ≠¶ÁøíÂÆå‰∫Ü„ÇíÊ¨°„ÅÆÂ≠¶Áøí„Å∏„ÅÆÊé®ÈÄ≤Âäõ„Å´Â§â„Åà„Çã„ÄÇ", context: "Â≠¶Áøí„ÅÆÂå∫Âàá„Çä„Åå„Å§„ÅÑ„Åü„Å®„Åç„ÄÅÊ¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó„Å´ÈÄ≤„Åø„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "ÈÅîÊàêÊÑü„ÇíÂéüÂãïÂäõ„Å®„Åó„Å¶„ÄÅ„Çà„ÇäÈ´ò„ÅÑ„É¨„Éô„É´„ÅÆÂ≠¶Áøí„Å´ÊåëÊà¶„Åô„Çã„ÄÇ" },
            28: { title: "Â≠¶Áøí„ÅÆ„Ç≥„Éü„É•„Éã„ÉÜ„Ç£", description: "Âêå„ÅòÁõÆÊ®ô„ÇíÊåÅ„Å§‰ª≤Èñì„Å®„Ç≥„Éü„É•„Éã„ÉÜ„Ç£„ÇíÂΩ¢Êàê„Åó„ÄÅÂÖ±„Å´Â≠¶Áøí„Åô„Çã„ÄÇ", context: "‰∏Ä‰∫∫„Åß„ÅÆÂ≠¶Áøí„Å´ÈôêÁïå„ÇíÊÑü„Åò„Çã„Å®„Åç„ÄÅ‰ª≤Èñì„Å®Â≠¶„Å≥„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "Â≠¶Áøí„Ç≥„Éü„É•„Éã„ÉÜ„Ç£„ÇíÂΩ¢Êàê„Åó„ÄÅ„É°„É≥„Éê„ÉºÈñì„ÅßÊîØÊè¥„ÅóÂêà„ÅÑ„Å™„Åå„ÇâÂ≠¶Áøí„Åô„Çã„ÄÇ" },
            29: { title: "ÂÅ∂ÁÑ∂„ÅÆÂá∫‰ºö„ÅÑ", description: "‰∫àÊúü„Åó„Å™„ÅÑÂá∫‰ºö„ÅÑ„ÇÑÁô∫Ë¶ã„Åã„ÇâÂ≠¶ÁøíÊ©ü‰ºö„ÇíÂâµ„ÇäÂá∫„Åô„ÄÇ", context: "Êñ∞„Åó„ÅÑÂà∫ÊøÄ„ÇÑÁô∫Ë¶ã„ÇíÊ±Ç„ÇÅ„Çã„Å®„Åç„ÄÅÂ≠¶Áøí„ÅÆÂπÖ„ÇíÂ∫É„Åí„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "ÂÅ∂ÁÑ∂„ÅÆÂá∫‰ºö„ÅÑ„Å´ÂøÉ„ÇíÈñã„Åç„ÄÅ„Åù„Åì„Åã„ÇâÂ≠¶Áøí„ÅÆ„Åç„Å£„Åã„Åë„ÇíË¶ã„Å§„Åë„Çã„ÄÇ" },
            30: { title: "ËâØ„Åç„É©„Ç§„Éê„É´", description: "‰∫í„ÅÑ„Å´È´ò„ÇÅÂêà„Åà„ÇãÁ´∂‰∫âÁõ∏Êâã„Å®„ÅÆÈñ¢‰øÇ„ÇíÂ≠¶Áøí„Å´Ê¥ªÁî®„Åô„Çã„ÄÇ", context: "Â≠¶Áøí„ÅÆ„É¢„ÉÅ„Éô„Éº„Ç∑„Éß„É≥„ÇíÈ´ò„ÇÅ„Åü„ÅÑ„Å®„Åç„ÄÅÂàáÁ£ãÁê¢Á£®„Åó„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "ËâØ„ÅÑÁ´∂‰∫âÁõ∏Êâã„ÇíË¶ã„Å§„Åë„ÄÅ‰∫í„ÅÑ„Å´Âà∫ÊøÄ„ÅóÂêà„ÅÑ„Å™„Åå„ÇâÊàêÈï∑„Åô„Çã„ÄÇ" },
            31: { title: "Ë©±„ÅôÊÄùËÄÉËÄÖ", description: "Â£∞„Å´Âá∫„Åó„Å¶ËÄÉ„Åà„Çã„Åì„Å®„ÅßÊÄùËÄÉ„ÇíÊï¥ÁêÜ„Åó„ÄÅÁêÜËß£„ÇíÊ∑±„ÇÅ„Çã„ÄÇ", context: "ËÄÉ„Åà„Åå„Åæ„Å®„Åæ„Çâ„Å™„ÅÑ„Å®„Åç„ÄÅÊÄùËÄÉ„ÇíÊï¥ÁêÜ„Åó„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "ËÄÉ„Åà„ÇíÂ£∞„Å´Âá∫„Åó„Å¶Êï¥ÁêÜ„Åó„ÄÅÂØæË©±„ÇíÈÄö„Åò„Å¶ÁêÜËß£„ÇíÊ∑±„ÇÅ„Çã„ÄÇ" },
            32: { title: "Êïô„Åà„Çã„Åì„Å®„Å´„Çà„ÇãÂ≠¶Áøí", description: "‰ªñËÄÖ„Å´Êïô„Åà„Çã„Åì„Å®„ÅßËá™ÂàÜ„ÅÆÁêÜËß£„ÇíÊ∑±„ÇÅ„ÄÅÁü•Ë≠ò„ÇíÂÆöÁùÄ„Åï„Åõ„Çã„ÄÇ", context: "Áü•Ë≠ò„ÇíÂÆöÁùÄ„Åï„Åõ„Åü„ÅÑ„Å®„Åç„ÄÅÁêÜËß£„ÅÆÊ∑±Âåñ„ÇíÂõ≥„Çä„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "Â≠¶„Çì„Å†„Åì„Å®„Çí‰ªñËÄÖ„Å´Êïô„Åà„ÇãÊ©ü‰ºö„Çí‰Ωú„Çä„ÄÅÊïô„Åà„ÇãÈÅéÁ®ã„ÅßÂ≠¶Áøí„Åô„Çã„ÄÇ" },
            33: { title: "Á¢∫Âõ∫„Åü„ÇãÊ±∫ÊÑè", description: "ÊòéÁ¢∫„Å™ÊÑèÂøó„ÇíÊåÅ„Å£„Å¶Â≠¶Áøí„Å´Âèñ„ÇäÁµÑ„Åø„ÄÅÂõ∞Èõ£„Çí‰πó„ÇäË∂ä„Åà„Çã„ÄÇ", context: "Âõ∞Èõ£„Å™Â≠¶Áøí„Å´ÊåëÊà¶„Åô„Çã„Å®„Åç„ÄÅÊÑèÂøó„ÇíÂº∑„ÅèÊåÅ„Å°„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "Â≠¶Áøí„Å∏„ÅÆÂº∑„ÅÑÊ±∫ÊÑè„ÇíÊåÅ„Å°„ÄÅÁõÆÊ®ôÈÅîÊàê„Åæ„ÅßË´¶„ÇÅ„Åö„Å´Âèñ„ÇäÁµÑ„ÇÄ„ÄÇ" },
            34: { title: "ÁñëÂïè„ÇíÊåÅ„Å§ÂøÉ", description: "Â∏∏„Å´ÁñëÂïè„ÇíÊåÅ„Å°Á∂ö„Åë„ÄÅÊâπÂà§ÁöÑÊÄùËÄÉ„ÅßÂ≠¶Áøí„ÇíÊ∑±„ÇÅ„Çã„ÄÇ", context: "ÂèóÂãïÁöÑ„Å™Â≠¶Áøí„Å´„Å™„Å£„Å¶„ÅÑ„Çã„Å®„Åç„ÄÅÊâπÂà§ÁöÑÊÄùËÄÉÂäõ„ÇíÈ§ä„ÅÑ„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "‰∏é„Åà„Çâ„Çå„ÅüÊÉÖÂ†±„Å´ÁñëÂïè„ÇíÊåÅ„Å°„ÄÅËá™ÂàÜ„Å™„Çä„Å´ËÄÉ„ÅàÊäú„ÅèÂßøÂã¢„Çí‰øù„Å§„ÄÇ" },
            35: { title: "Ê≠£„Åó„ÅÑÊñπÊ≥ï", description: "ÂäπÊûúÁöÑ„ÅßÊ≠£Á¢∫„Å™Â≠¶ÁøíÊñπÊ≥ï„ÇíË¶ã„Å§„Åë„ÄÅË≥™„ÅÆÈ´ò„ÅÑÂ≠¶Áøí„ÇíÂÆüÁèæ„Åô„Çã„ÄÇ", context: "Â≠¶ÁøíÂäπÁéá„Çí‰∏ä„Åí„Åü„ÅÑ„Å®„Åç„ÄÅÊ≠£Á¢∫„Å™Áü•Ë≠ò„ÇíË∫´„Å´„Å§„Åë„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "Ê§úË®ºÊ∏à„Åø„ÅÆÂäπÊûúÁöÑ„Å™Â≠¶ÁøíÊñπÊ≥ï„ÇíÊé°Áî®„Åó„ÄÅË≥™„ÅÆÈ´ò„ÅÑÂ≠¶Áøí„ÇíË°å„ÅÜ„ÄÇ" },
            36: { title: "ÂãáÊï¢„Å™Â§âÂåñ", description: "Êó¢Â≠ò„ÅÆÊñπÊ≥ï„Å´Âõ∫Âü∑„Åõ„Åö„ÄÅÂãáÊ∞ó„ÇíÊåÅ„Å£„Å¶Êñ∞„Åó„ÅÑÂ≠¶ÁøíÊ≥ï„Å´ÊåëÊà¶„Åô„Çã„ÄÇ", context: "Â≠¶ÁøíÊñπÊ≥ï„ÇíÂ§â„Åà„ÇãÂøÖË¶Å„Åå„ÅÇ„Çã„Å®„Åç„ÄÅÊñ∞„Åó„ÅÑÊåëÊà¶„Çí„Åó„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "ÁèæÁä∂„Å´Ê∫ÄË∂≥„Åõ„Åö„ÄÅÂãáÊ∞ó„ÇíÊåÅ„Å£„Å¶Êñ∞„Åó„ÅÑÂ≠¶ÁøíÊñπÊ≥ï„Å´ÊåëÊà¶„Åô„Çã„ÄÇ" },
            37: { title: "Êé¢Ê§úÂÆ∂„ÅÆÊÉÖÁÜ±", description: "Êú™Áü•„ÅÆÈ†òÂüü„Å∏„ÅÆÊé¢Ê±ÇÂøÉ„ÇíÊåÅ„Å°Á∂ö„Åë„ÄÅÂ≠¶Áøí„Å∏„ÅÆÊÉÖÁÜ±„ÇíÁ∂≠ÊåÅ„Åô„Çã„ÄÇ", context: "Â≠¶Áøí„Å∏„ÅÆÊÉÖÁÜ±„ÇíÁ∂≠ÊåÅ„Åó„Åü„ÅÑ„Å®„Åç„ÄÅÊé¢Ê±ÇÂøÉ„ÇíÂ§±„ÅÑ„Åã„Åë„Å¶„ÅÑ„Çã„Å®„Åç„ÄÇ", solution: "Êé¢Ê§úÂÆ∂„ÅÆ„Çà„ÅÜ„Å™ÊÉÖÁÜ±„Å®Â•ΩÂ•áÂøÉ„ÇíÊåÅ„Å°Á∂ö„Åë„ÄÅÂ≠¶Áøí„Å´Âèñ„ÇäÁµÑ„ÇÄ„ÄÇ" },
            38: { title: "Ëá™Â∑±„Éó„É≠„Éá„É•„Éº„Çµ„Éº", description: "Ëá™ÂàÜËá™Ë∫´„ÅÆÂ≠¶Áøí„Çí„Éó„É≠„Éá„É•„Éº„Çπ„Åó„ÄÅ‰∏ª‰ΩìÁöÑ„Å´Â≠¶ÁøíÁí∞Â¢É„ÇíÂâµÈÄ†„Åô„Çã„ÄÇ", context: "‰∏ª‰ΩìÁöÑ„Å™Â≠¶Áøí„ÇíÂÆüÁèæ„Åó„Åü„ÅÑ„Å®„Åç„ÄÅÂ≠¶ÁøíÁí∞Â¢É„ÇíÊîπÂñÑ„Åó„Åü„ÅÑ„Å®„Åç„ÄÇ", solution: "Ëá™ÂàÜ„ÅÆÂ≠¶Áøí„ÇíÂÆ¢Ë¶≥Ë¶ñ„Åó„ÄÅ„Éó„É≠„Éá„É•„Éº„Çµ„Éº„ÅÆË¶ñÁÇπ„ÅßÊúÄÈÅ©Âåñ„Åô„Çã„ÄÇ" },
            39: { title: "Ê•µÁ´Ø„Å´„Å™„ÇåÔºÅ", description: "ÊôÇ„Å´„ÅØÊ•µÁ´Ø„Å™„Ç¢„Éó„É≠„Éº„ÉÅ„ÇíÂèñ„Çä„ÄÅÂæìÊù•„ÅÆÊû†„ÇíÁ†¥„Å£„Å¶Â≠¶Áøí„Åô„Çã„ÄÇ", context: "ÂæìÊù•„ÅÆÊñπÊ≥ï„Åß„ÅØÊàêÊûú„ÅåÂá∫„Å™„ÅÑ„Å®„Åç„ÄÅ„Éñ„É¨„Ç§„ÇØ„Çπ„É´„Éº„ÅåÂøÖË¶Å„Å™„Å®„Åç„ÄÇ", solution: "Â∏∏Ë≠ò„Å´„Å®„Çâ„Çè„Çå„Åö„ÄÅÊôÇ„Å´„ÅØÊ•µÁ´Ø„Å™„Ç¢„Éó„É≠„Éº„ÉÅ„ÅßÂ≠¶Áøí„Å´Âèñ„ÇäÁµÑ„ÇÄ„ÄÇ" }
        };
        
        // ÂäπÁéáÁöÑ„Å™„É¨„Çπ„Éù„É≥„Ç∑„Éñ„Ç≠„É£„É≥„Éê„Çπ„Çµ„Ç§„Ç∫Ë®àÁÆó
        function getResponsiveCanvasSize() {
            const containerElement = document.querySelector('.canvas-container');
            if (!containerElement) return { width: 888, height: 600 };
            
            // „Ç≥„É≥„ÉÜ„Éä„ÅÆÂà©Áî®ÂèØËÉΩ„Çµ„Ç§„Ç∫„ÇíÂèñÂæóÔºàÂàùÊúüÂåñÊôÇ„ÅÆÂÆâÂÖ®ÊÄß„ÇíÂêë‰∏äÔºâ
            const containerRect = containerElement.getBoundingClientRect();
            let containerWidth = containerRect.width - 40; // paddingËÄÉÊÖÆ
            let containerHeight = Math.min(containerRect.height - 40, window.innerHeight * 0.8); // ÊúÄÂ§ß80vh
            
            // ÂàùÊúüÂåñÊôÇ„Å´„Ç≥„É≥„ÉÜ„Éä„Çµ„Ç§„Ç∫„Åå0„ÅÆÂ†¥Âêà„ÅÆÂØæÂá¶
            if (containerWidth <= 0 || containerHeight <= 0) {
                // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÔºö„Éì„É•„Éº„Éù„Éº„Éà„Çµ„Ç§„Ç∫„Åã„ÇâÊé®ÂÆö
                const viewportWidth = window.innerWidth || document.documentElement.clientWidth;
                const viewportHeight = window.innerHeight || document.documentElement.clientHeight;
                
                if (viewportWidth > 1024) {
                    containerWidth = Math.min(viewportWidth * 0.6, 950); // 60%„ÅÆÂπÖ„ÄÅÊúÄÂ§ß950px
                    containerHeight = Math.min(viewportHeight * 0.8, 700); // 80%„ÅÆÈ´ò„Åï„ÄÅÊúÄÂ§ß700px
                } else {
                    containerWidth = viewportWidth - 60; // „É¢„Éê„Ç§„É´„Éª„Çø„Éñ„É¨„ÉÉ„ÉàÂØæÂøú
                    containerHeight = viewportHeight * 0.6;
                }
            }
            
            const aspectRatio = 888 / 600; // 1.48
            const maxWidth = 888;
            const maxHeight = 600;
            
            // Âà©Áî®ÂèØËÉΩ„Çπ„Éö„Éº„Çπ„Å´Âü∫„Å•„ÅÑ„Å¶ÊúÄÈÅ©„Çµ„Ç§„Ç∫„ÇíË®àÁÆó
            let width = Math.min(containerWidth, maxWidth);
            let height = width / aspectRatio;
            
            // È´ò„Åï„ÅåÂà∂Èôê„ÇíË∂Ö„Åà„ÇãÂ†¥Âêà„ÅØÈ´ò„ÅïÂü∫Ê∫ñ„ÅßË™øÊï¥
            if (height > Math.min(containerHeight, maxHeight)) {
                height = Math.min(containerHeight, maxHeight);
                width = height * aspectRatio;
            }
            
            // ÊúÄÂ∞è„Çµ„Ç§„Ç∫Âà∂Èôê
            width = Math.max(width, 280);
            height = Math.max(height, width / aspectRatio);
            
            return { 
                width: Math.round(width), 
                height: Math.round(height) 
            };
        }
        
        // „Ç≠„É£„É≥„Éê„Çπ„Çµ„Ç§„Ç∫„ÇíÂãïÁöÑ„Å´Ë™øÊï¥
        function updateCanvasSize() {
            if (!canvas) return;
            
            const { width, height } = getResponsiveCanvasSize();
            const scaleFactor = width / baseWidth; // 888px„ÇíÂü∫Ê∫ñ„Å®„Åó„Åü„Çπ„Ç±„Éº„É´
            
            // Fabric.jsÂÜÖÈÉ®„Çµ„Ç§„Ç∫„ÇíË®≠ÂÆö
            canvas.setDimensions({ 
                width: width, 
                height: height 
            });
            
            // DOMË¶ÅÁ¥†„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂÆåÂÖ®ÂêåÊúü
            const canvasElement = document.getElementById('cardCanvas');
            const upperCanvasElement = canvas.upperCanvasEl;
            const lowerCanvasElement = canvas.lowerCanvasEl;
            
            // Ë¶™canvas„ÅÆ„Çµ„Ç§„Ç∫Ë®≠ÂÆö
            canvasElement.width = width;
            canvasElement.height = height;
            canvasElement.style.width = width + 'px';
            canvasElement.style.height = height + 'px';
            
            // upper-canvas„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂº∑Âà∂Êõ¥Êñ∞
            if (upperCanvasElement) {
                upperCanvasElement.width = width;
                upperCanvasElement.height = height;
                upperCanvasElement.style.width = width + 'px';
                upperCanvasElement.style.height = height + 'px';
            }
            
            // lower-canvas„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂº∑Âà∂Êõ¥Êñ∞
            if (lowerCanvasElement) {
                lowerCanvasElement.width = width;
                lowerCanvasElement.height = height;
                lowerCanvasElement.style.width = width + 'px';
                lowerCanvasElement.style.height = height + 'px';
            }
            
            // „Ç≠„É£„É≥„Éê„Çπ„ÅÆ„Éì„É•„Éº„Éù„Éº„Éà„ÇíË®≠ÂÆö
            canvas.setViewportTransform([1, 0, 0, 1, 0, 0]);
            
            // „Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅØÂÜçÁîüÊàê„Åô„Çã„Åü„ÇÅ„ÄÅÊó¢Â≠ò„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆË™øÊï¥„ÅØË°å„Çè„Å™„ÅÑ
            // ‰ª£„Çè„Çä„Å´updateCard()„ÇíÂëº„Å≥Âá∫„Åó„Å¶„Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÇíÂÜçÊßãÁØâ
            updateCard();
        }
        
        // „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫ÊôÇ„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        let resizeTimer;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(() => {
                updateCanvasSize();
            }, 250);
        });

        // CanvasÂàùÊúüÂåñ
        function initCanvas() {
            try {
                const canvasElement = document.getElementById('cardCanvas');
                if (!canvasElement) {
                    console.error('CanvasË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
                    return;
                }
                
                // „É¨„Çπ„Éù„É≥„Ç∑„Éñ„Çµ„Ç§„Ç∫„ÇíÂèñÂæó
                const { width, height } = getResponsiveCanvasSize();
                
                // „Çµ„Ç§„Ç∫„ÅÆÂ¶•ÂΩìÊÄß„Çí„ÉÅ„Çß„ÉÉ„ÇØ
                if (width < 280 || height < 189) {
                    console.warn('ÂàùÊúüÂåñÊôÇ„ÅÆ„Ç≠„É£„É≥„Éê„Çπ„Çµ„Ç§„Ç∫„ÅåÂ∞è„Åï„Åô„Åé„Åæ„Åô„ÄÇÂÜçË©¶Ë°å„Åó„Åæ„Åô„ÄÇ', { width, height });
                    setTimeout(() => {
                        initCanvas();
                    }, 200);
                    return;
                }
                
                // CanvasÂàùÊúüÂåñÔºàÈ´òËß£ÂÉèÂ∫¶ÂØæÂøúÔºâ
                const dpr = window.devicePixelRatio || 1;
                const scaleFactor = Math.min(dpr, 3); // DPR‰∏äÈôê3„Å´Âà∂Èôê
                const scaledWidth = width * scaleFactor;
                const scaledHeight = height * scaleFactor;
                
                canvas = new fabric.Canvas('cardCanvas', {
                    width: scaledWidth,
                    height: scaledHeight,
                    backgroundColor: '#ffffff'
                });
                
                // È´òËß£ÂÉèÂ∫¶„É¨„É≥„ÉÄ„É™„É≥„Ç∞Ë®≠ÂÆö
                canvas.contextContainer.imageSmoothingEnabled = true;
                canvas.contextContainer.imageSmoothingQuality = 'high';
                if (canvas.contextTop) {
                    canvas.contextTop.imageSmoothingEnabled = true;
                    canvas.contextTop.imageSmoothingQuality = 'high';
                }
                
                // Ë°®Á§∫„Çµ„Ç§„Ç∫„ÅØÂÖÉ„ÅÆ„Çµ„Ç§„Ç∫„ÇíÁ∂≠ÊåÅ
                canvas.getElement().style.width = width + 'px';
                canvas.getElement().style.height = height + 'px';
                canvas.setZoom(scaleFactor);
                
                // DOMË¶ÅÁ¥†„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂÆåÂÖ®ÂêåÊúü
                const upperCanvasElement = canvas.upperCanvasEl;
                const lowerCanvasElement = canvas.lowerCanvasEl;
                
                // Ë°®Á§∫„Çµ„Ç§„Ç∫„ÇíË®≠ÂÆöÔºàÈ´òËß£ÂÉèÂ∫¶ÂØæÂøúÁâàÔºâ
                canvasElement.style.width = width + 'px';
                canvasElement.style.height = height + 'px';
                
                // upper-canvas„Å®lower-canvas„ÅÆÈ´òËß£ÂÉèÂ∫¶ÂØæÂøú
                if (upperCanvasElement) {
                    upperCanvasElement.width = scaledWidth;
                    upperCanvasElement.height = scaledHeight;
                    upperCanvasElement.style.width = width + 'px';
                    upperCanvasElement.style.height = height + 'px';
                }
                
                if (lowerCanvasElement) {
                    lowerCanvasElement.width = scaledWidth;
                    lowerCanvasElement.height = scaledHeight;
                    lowerCanvasElement.style.width = width + 'px';
                    lowerCanvasElement.style.height = height + 'px';
                }
                
                updateCard();
            } catch (error) {
                console.error('CanvasÂàùÊúüÂåñ„Ç®„É©„Éº:', error);
                alert('CanvasÂàùÊúüÂåñ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ„Éö„Éº„Ç∏„Çí„É™„É≠„Éº„Éâ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
            }
        }
        
        // 16ÈÄ≤Êï∞„Ç´„É©„Éº„ÇíRGBA„Å´Â§âÊèõ„Åô„Çã„Éò„É´„Éë„ÉºÈñ¢Êï∞
        function hexToRgba(hex, alpha = 1) {
            // #„ÇíÈô§Âéª
            hex = hex.replace('#', '');
            
            // 3Ê°Å„ÅÆÂ†¥Âêà„ÅØ6Ê°Å„Å´Êã°Âºµ
            if (hex.length === 3) {
                hex = hex.split('').map(char => char + char).join('');
            }
            
            // RGB„Å´Â§âÊèõ
            const r = parseInt(hex.substr(0, 2), 16);
            const g = parseInt(hex.substr(2, 2), 16);
            const b = parseInt(hex.substr(4, 2), 16);
            
            return `rgba(${r}, ${g}, ${b}, ${alpha})`;
        }
        
        // Ëß£ÂÉèÂ∫¶Êõ¥Êñ∞ÔºàÂõ∫ÂÆö„ÅÆ„Åü„ÇÅÁÑ°ÂäπÂåñÔºâ
        function updateResolution() {
            // ‰∏≠Ëß£ÂÉèÂ∫¶Âõ∫ÂÆö„ÅÆ„Åü„ÇÅÂá¶ÁêÜ„Å™„Åó
        }
        
        // „ÉÜ„É≥„Éó„É¨„Éº„ÉàÈÅ∏Êäû
        function selectTemplate(template) {
            document.querySelectorAll('.template-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-template="${template}"]`).classList.add('active');
            currentTemplate = template;
            
            // „Ç´„Çπ„Çø„É†ËÉåÊôØ„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÊ¨Ñ„ÅÆË°®Á§∫/ÈùûË°®Á§∫
            const customGroup = document.getElementById('customBackgroundGroup');
            if (template === 'custom') {
                customGroup.style.display = 'block';
            } else {
                customGroup.style.display = 'none';
            }
            
            // „Ç´„Çπ„Çø„É†„Ç´„É©„Éº„ÅåÊúâÂäπ„Å™Â†¥Âêà„ÅØÁÑ°ÂäπÂåñ
            if (document.getElementById('enableCustomColors').checked) {
                document.getElementById('enableCustomColors').checked = false;
                toggleCustomColors();
            }
            
            updateCard();
        }

        // „Ç´„É©„Éº„Ç´„Çπ„Çø„Éû„Ç§„Ç∫Ê©üËÉΩ
        let customColors = null;
        let savedPalettes = JSON.parse(localStorage.getItem('learning-pattern-palettes') || '[]');

        function toggleCustomColors() {
            const checkbox = document.getElementById('enableCustomColors');
            const panel = document.getElementById('customColorsPanel');
            const toggle = document.querySelector('.custom-color-toggle');
            
            if (checkbox.checked) {
                panel.style.display = 'block';
                toggle.classList.add('active');
                // ÁèæÂú®„ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅÆËâ≤„ÇíÂàùÊúüÂÄ§„Å®„Åó„Å¶Ë®≠ÂÆö
                const templateColors = {
                    academic: { primary: '#ffffff', secondary: '#d0d0d0', accent: '#ffffff' },
                    nature: { primary: '#259e56', secondary: '#f4f269', accent: '#ffffff' },
                    warm: { primary: '#fff95b', secondary: '#ff930f', accent: '#ffffff' },
                    elegant: { primary: '#d4af37', secondary: '#c0c0c0', accent: '#ffffff' },
                    pastel: { primary: '#e9e9b7', secondary: '#d3f3f1', accent: '#ffffff' },
                    spring: { primary: '#fce9d7', secondary: '#eed4e8', accent: '#ffffff' },
                    summer: { primary: '#f6f6f6', secondary: '#2c6cbc', accent: '#ffffff' },
                    autumn: { primary: '#fdd57e', secondary: '#924e8c', accent: '#ffffff' },
                    winter: { primary: '#f1f5f9', secondary: '#475569', accent: '#ffffff' },
                    custom: { primary: '#f5f5f5', secondary: '#e8e8e8', accent: '#ffffff' }
                };
                
                const colors = templateColors[currentTemplate] || templateColors.academic;
                document.getElementById('primaryColor').value = colors.primary;
                document.getElementById('secondaryColor').value = colors.secondary;
                document.getElementById('accentColor').value = colors.accent;
                updateCustomColors();
            } else {
                panel.style.display = 'none';
                toggle.classList.remove('active');
                customColors = null;
                updateCard();
            }
        }
        
        // UIÁî®„ÅÆ„Éà„Ç∞„É´Èñ¢Êï∞Ôºà„É©„Éô„É´„ÇØ„É™„ÉÉ„ÇØÂØæÂøúÔºâ
        function toggleCustomColorsUI() {
            const checkbox = document.getElementById('enableCustomColors');
            checkbox.checked = !checkbox.checked;
            toggleCustomColors();
        }

        function updateCustomColors() {
            customColors = {
                primary: document.getElementById('primaryColor').value,
                secondary: document.getElementById('secondaryColor').value,
                accent: document.getElementById('accentColor').value
            };
            updateCard();
        }

        function saveCustomPalette() {
            const nameInput = document.getElementById('paletteNameInput');
            const name = nameInput.value.trim();
            
            if (!name) {
                alert('„Éë„É¨„ÉÉ„ÉàÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            if (!customColors) {
                alert('„Ç´„Çπ„Çø„É†„Ç´„É©„Éº„ÇíË®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            if (savedPalettes.length >= 6) {
                alert('„Éë„É¨„ÉÉ„Éà„ÅØÊúÄÂ§ß6ÂÄã„Åæ„Åß‰øùÂ≠ò„Åß„Åç„Åæ„Åô');
                return;
            }
            
            if (savedPalettes.find(p => p.name === name)) {
                alert('Âêå„ÅòÂêçÂâç„ÅÆ„Éë„É¨„ÉÉ„Éà„ÅåÊó¢„Å´Â≠òÂú®„Åó„Åæ„Åô');
                return;
            }
            
            savedPalettes.push({
                name: name,
                colors: { ...customColors }
            });
            
            localStorage.setItem('learning-pattern-palettes', JSON.stringify(savedPalettes));
            nameInput.value = '';
            renderSavedPalettes();
        }

        function loadCustomPalette(index) {
            const palette = savedPalettes[index];
            if (!palette) return;
            
            document.getElementById('enableCustomColors').checked = true;
            toggleCustomColors();
            
            document.getElementById('primaryColor').value = palette.colors.primary;
            document.getElementById('secondaryColor').value = palette.colors.secondary;
            document.getElementById('accentColor').value = palette.colors.accent;
            updateCustomColors();
        }

        function deleteCustomPalette(index) {
            if (confirm('„Åì„ÅÆ„Éë„É¨„ÉÉ„Éà„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                savedPalettes.splice(index, 1);
                localStorage.setItem('learning-pattern-palettes', JSON.stringify(savedPalettes));
                renderSavedPalettes();
            }
        }

        function renderSavedPalettes() {
            const container = document.getElementById('savedPalettes');
            container.innerHTML = '';
            
            savedPalettes.forEach((palette, index) => {
                const div = document.createElement('div');
                div.className = 'saved-palette';
                div.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <span>${palette.name}</span>
                        <div class="palette-colors">
                            <div class="palette-color-dot" style="background: ${palette.colors.primary}"></div>
                            <div class="palette-color-dot" style="background: ${palette.colors.secondary}"></div>
                            <div class="palette-color-dot" style="background: ${palette.colors.accent}"></div>
                        </div>
                    </div>
                    <div class="palette-actions">
                        <button class="palette-action-btn" onclick="loadCustomPalette(${index})">ÈÅ©Áî®</button>
                        <button class="palette-action-btn" onclick="deleteCustomPalette(${index})">ÂâäÈô§</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // ÂàùÊúüÂåñÊôÇ„Å´‰øùÂ≠òÊ∏à„Åø„Éë„É¨„ÉÉ„Éà„ÇíË°®Á§∫
        document.addEventListener('DOMContentLoaded', function() {
            renderSavedPalettes();
        });

        // ËÉåÊôØÁîªÂÉè„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÂá¶ÁêÜ
        function handleBackgroundUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                fabric.Image.fromURL(e.target.result, function(img) {
                    // È´òËß£ÂÉèÂ∫¶ÁîªÂÉèÂá¶ÁêÜË®≠ÂÆö
                    img.set({
                        crossOrigin: 'anonymous'
                    });
                    
                    // ÁîªÂÉèË£úÈñìÊñπÂºè„ÇíÈ´òÂìÅË≥™„Å´Ë®≠ÂÆö
                    if (img.getElement()) {
                        img.getElement().style.imageRendering = 'high-quality';
                    }
                    
                    customBackgroundImage = img;
                    updateCard();
                });
            };
            reader.readAsDataURL(file);
        }
        
        // „Éë„Çø„Éº„É≥„Éá„Éº„ÇøË™≠„ÅøËæº„Åø
        function loadPatternData() {
            const select = document.getElementById('patternSelect');
            const patternId = select.value;
            
            if (patternId && patternData[patternId]) {
                const data = patternData[patternId];
                document.getElementById('patternTitle').value = data.title;
                document.getElementById('patternDescription').value = data.description;
                document.getElementById('patternContext').value = data.context;
                document.getElementById('patternSolution').value = data.solution;
                updateCard();
            }
        }
        
        // „Ç´„Éº„ÉâÊõ¥Êñ∞
        function updateCard() {
            if (!canvas) {
                console.warn('CanvasÊú™ÂàùÊúüÂåñ„ÅÆ„Åü„ÇÅ„ÄÅ„Ç´„Éº„ÉâÊõ¥Êñ∞„Çí„Çπ„Ç≠„ÉÉ„Éó„Åó„Åæ„Åô');
                return;
            }
            
            try {
                const title = document.getElementById('patternTitle').value || '„Éë„Çø„Éº„É≥Âêç';
                const description = document.getElementById('patternDescription').value || '';
                const context = document.getElementById('patternContext').value || '';
                const solution = document.getElementById('patternSolution').value || '';
                const patternNumber = document.getElementById('patternSelect').value || '';
                
                canvas.clear();
                
                // „ÉÜ„É≥„Éó„É¨„Éº„ÉàÂà•„ÅÆËâ≤Ë®≠ÂÆöÔºà„Éó„É™„Çª„ÉÉ„ÉàÊã°ÂºµÔºâ
                const templateColors = {
                    academic: { primary: '#ffffff', secondary: '#d0d0d0', accent: '#ffffff' },
                    nature: { primary: '#259e56', secondary: '#f4f269', accent: '#ffffff' },
                    warm: { primary: '#fff95b', secondary: '#ff930f', accent: '#ffffff' },
                    elegant: { primary: '#d4af37', secondary: '#c0c0c0', accent: '#ffffff' },
                    pastel: { primary: '#e9e9b7', secondary: '#d3f3f1', accent: '#ffffff' },
                    spring: { primary: '#fce9d7', secondary: '#eed4e8', accent: '#ffffff' },
                    summer: { primary: '#f6f6f6', secondary: '#2c6cbc', accent: '#ffffff' },
                    autumn: { primary: '#fdd57e', secondary: '#924e8c', accent: '#ffffff' },
                    winter: { primary: '#f1f5f9', secondary: '#475569', accent: '#ffffff' },
                    custom: { primary: '#f5f5f5', secondary: '#e8e8e8', accent: '#ffffff' }
                };
                
                // „Ç´„Çπ„Çø„É†„Ç´„É©„Éº„ÅåË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØÂÑ™ÂÖà‰ΩøÁî®
                const colors = customColors || templateColors[currentTemplate] || templateColors.academic;
                
                // ÁèæÂú®„ÅÆ„Ç≠„É£„É≥„Éê„Çπ„Çµ„Ç§„Ç∫„ÇíÂèñÂæó
                const currentSize = getResponsiveCanvasSize();
                const scaleFactor = currentSize.width / baseWidth;
                
                // Âü∫Ê∫ñ„Çµ„Ç§„Ç∫Ôºà888√ó600pxÔºâ„Å®„Çπ„Ç±„Éº„É´„Éï„Ç°„ÇØ„Çø„Éº„ÇíË®≠ÂÆö
                const width = baseWidth;
                const height = baseHeight;
            
            // ËÉåÊôØ‰ΩúÊàê
            let background;
            if (currentTemplate === 'custom' && customBackgroundImage) {
                // „Ç´„Çπ„Çø„É†ËÉåÊôØÁîªÂÉè„Çí‰ΩøÁî®ÔºàÈ´òËß£ÂÉèÂ∫¶ÂØæÂøúÔºâ
                background = fabric.util.object.clone(customBackgroundImage);
                
                // È´òËß£ÂÉèÂ∫¶ÁîªÂÉè„ÅÆË£úÈñìË®≠ÂÆö
                if (background.getElement()) {
                    background.getElement().style.imageRendering = 'high-quality';
                }
                
                background.set({
                    left: 0,
                    top: 0,
                    scaleX: width / background.width,
                    scaleY: height / background.height,
                    selectable: false,
                    // „Çπ„Ç±„Éº„É´ÊôÇ„ÅÆÂìÅË≥™‰øùÊåÅ
                    strokeWidth: 0
                });
            } else {
                // „Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥ËÉåÊôØ
                const gradient = new fabric.Gradient({
                    type: 'linear',
                    coords: { x1: 0, y1: 0, x2: width, y2: height },
                    colorStops: [
                        { offset: 0, color: colors.primary },
                        { offset: 1, color: colors.secondary }
                    ]
                });
                
                background = new fabric.Rect({
                    left: 0,
                    top: 0,
                    width: width,
                    height: height,
                    fill: gradient,
                    selectable: false
                });
            }
            canvas.add(background);
            
            // „Éë„Çø„Éº„É≥Áï™Âè∑ÔºàÂ∑¶‰∏äÔºâ- „Çπ„Ç±„Éº„É´Ë™øÊï¥ÂØæÂøú
            if (patternNumber) {
                const numberCircle = new fabric.Circle({
                    left: 45 * scaleFactor,
                    top: 38 * scaleFactor,
                    radius: 30 * scaleFactor,
                    fill: colors.accent,
                    selectable: false
                });
                canvas.add(numberCircle);
                
                const numberText = new fabric.Text(patternNumber, {
                    left: 75 * scaleFactor,
                    top: 52 * scaleFactor,
                    fontSize: 32 * scaleFactor,
                    fill: '#333333',
                    fontFamily: getCurrentFontFamily(),
                    fontWeight: 'bold',
                    textAlign: 'center',
                    originX: 'center',
                    originY: 'top',
                    selectable: false
                });
                canvas.add(numberText);
            }
            
            // „Çø„Ç§„Éà„É´ËÉåÊôØÔºàÁôΩ„ÅÑËßí‰∏∏Ôºâ- „Çπ„Ç±„Éº„É´Ë™øÊï¥ÂØæÂøú
            const titleWidth = (patternNumber ? 728 : 798) * scaleFactor;
            const titleLeft = (patternNumber ? 115 : 45) * scaleFactor;
            
            // Êõ≤Á∑öÁöÑ„Å™ÈÄèÊòéÂ∫¶Â§âÂåñ„Çí‰Ωú„Çã„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥
            const titleGradient = new fabric.Gradient({
                type: 'linear',
                coords: { x1: 0, y1: 0, x2: titleWidth, y2: 0 },
                colorStops: [
                    { offset: 0, color: hexToRgba(colors.accent, 0.9) },
                    { offset: 0.4, color: hexToRgba(colors.accent, 0.9) },
                    { offset: 0.6, color: hexToRgba(colors.accent, 0.8) },
                    { offset: 0.8, color: hexToRgba(colors.accent, 0.4) },
                    { offset: 1, color: hexToRgba(colors.accent, 0.0) }
                ]
            });
            
            const titleBg = new fabric.Rect({
                left: titleLeft,
                top: 38 * scaleFactor,
                width: titleWidth,
                height: 60 * scaleFactor,
                fill: titleGradient,
                rx: 12 * scaleFactor,
                ry: 12 * scaleFactor,
                shadow: {
                    color: 'rgba(0,0,0,0.1)',
                    blur: 15 * scaleFactor,
                    offsetX: 0,
                    offsetY: 3 * scaleFactor
                },
                selectable: false
            });
            canvas.add(titleBg);
            
            // „Çø„Ç§„Éà„É´ - „Çπ„Ç±„Éº„É´Ë™øÊï¥ÂØæÂøú
            const titleText = new fabric.Text(title, {
                left: (patternNumber ? 125 : 60) * scaleFactor,
                top: 52 * scaleFactor,
                fontSize: 36 * scaleFactor,
                fill: '#333333',
                fontFamily: getCurrentFontFamily(),
                fontWeight: 'bold',
                selectable: false
            });
            canvas.add(titleText);
            
            // „Ç≥„É≥„ÉÜ„É≥„ÉÑ„Ç®„É™„Ç¢ÔºàÁôΩ„ÅÑËÉåÊôØÔºâ- „Çπ„Ç±„Éº„É´Ë™øÊï¥ÂØæÂøú
            const contentWidth = 798 * scaleFactor;
            
            // Êõ≤Á∑öÁöÑ„Å™ÈÄèÊòéÂ∫¶Â§âÂåñ„Çí‰Ωú„Çã„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥
            const contentGradient = new fabric.Gradient({
                type: 'linear',
                coords: { x1: 0, y1: 0, x2: contentWidth, y2: 0 },
                colorStops: [
                    { offset: 0, color: hexToRgba(colors.accent, 0.9) },
                    { offset: 0.4, color: hexToRgba(colors.accent, 0.9) },
                    { offset: 0.6, color: hexToRgba(colors.accent, 0.8) },
                    { offset: 0.8, color: hexToRgba(colors.accent, 0.4) },
                    { offset: 1, color: hexToRgba(colors.accent, 0.1) }
                ]
            });
            
            const contentBg = new fabric.Rect({
                left: 45 * scaleFactor,
                top: 120 * scaleFactor,
                width: contentWidth,
                height: 435 * scaleFactor,
                fill: contentGradient,
                rx: 18 * scaleFactor,
                ry: 18 * scaleFactor,
                shadow: {
                    color: 'rgba(0,0,0,0.2)',
                    blur: 23 * scaleFactor,
                    offsetX: 0,
                    offsetY: 8 * scaleFactor
                },
                selectable: false
            });
            canvas.add(contentBg);
            
            let yPosition = 150 * scaleFactor;
            
            // Ë™¨Êòé - „Çπ„Ç±„Éº„É´Ë™øÊï¥ÂØæÂøú
            if (description) {
                const formattedDescription = insertLineBreaks(description);
                const descText = new fabric.Textbox(formattedDescription, {
                    left: 75 * scaleFactor,
                    top: yPosition,
                    width: 738 * scaleFactor,
                    fontSize: 21 * scaleFactor,
                    fill: '#333333',
                    fontFamily: getCurrentFontFamily(),
                    selectable: false
                });
                canvas.add(descText);
                // „ÉÜ„Ç≠„Çπ„Éà„Éú„ÉÉ„ÇØ„Çπ„ÅÆÂÆüÈöõ„ÅÆÈ´ò„Åï„ÇíÂèñÂæó
                canvas.renderAll();
                const actualHeight = descText.calcTextHeight();
                yPosition += Math.max(90 * scaleFactor, actualHeight + 30 * scaleFactor);
            }
            
            // „Ç≥„É≥„ÉÜ„ÇØ„Çπ„Éà - „Çπ„Ç±„Éº„É´Ë™øÊï¥ÂØæÂøú
            if (context) {
                const contextLabel = new fabric.Text('üìç Â†¥Èù¢„ÉªÁä∂Ê≥Å', {
                    left: 75 * scaleFactor,
                    top: yPosition,
                    fontSize: 18 * scaleFactor,
                    fill: '#333333',
                    fontFamily: getCurrentFontFamily(),
                    fontWeight: 'bold',
                    selectable: false
                });
                canvas.add(contextLabel);
                
                const contextText = new fabric.Textbox(insertLineBreaks(context), {
                    left: 75 * scaleFactor,
                    top: yPosition + 30 * scaleFactor,
                    width: 738 * scaleFactor,
                    fontSize: 18 * scaleFactor,
                    fill: '#555555',
                    fontFamily: getCurrentFontFamily(),
                    selectable: false
                });
                canvas.add(contextText);
                canvas.renderAll();
                const contextHeight = contextText.calcTextHeight();
                yPosition += Math.max(105 * scaleFactor, contextHeight + 60 * scaleFactor);
            }
            
            // Ëß£Ê±∫Á≠ñ - „Çπ„Ç±„Éº„É´Ë™øÊï¥ÂØæÂøú
            if (solution && yPosition < 480 * scaleFactor) {
                const solutionLabel = new fabric.Text('üí° Â∑•Â§´„Éª„Éà„É©„Ç§„Ç¢„É´', {
                    left: 75 * scaleFactor,
                    top: yPosition,
                    fontSize: 18 * scaleFactor,
                    fill: '#333333',
                    fontFamily: getCurrentFontFamily(),
                    fontWeight: 'bold',
                    selectable: false
                });
                canvas.add(solutionLabel);
                
                const solutionText = new fabric.Textbox(insertLineBreaks(solution), {
                    left: 75 * scaleFactor,
                    top: yPosition + 30 * scaleFactor,
                    width: 738 * scaleFactor,
                    fontSize: 18 * scaleFactor,
                    fill: '#555555',
                    fontFamily: getCurrentFontFamily(),
                    selectable: false
                });
                canvas.add(solutionText);
            }
            
            canvas.renderAll();
        } catch (error) {
            console.error('„Ç´„Éº„ÉâÊõ¥Êñ∞„Ç®„É©„Éº:', error);
        }
    }
        
        // È´òËß£ÂÉèÂ∫¶„Åß„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Åô„Çã„Åü„ÇÅ„ÅÆ„Éò„É´„Éë„ÉºÈñ¢Êï∞
        function exportCanvasAtHighResolution(targetCanvas, multiplier = 2) {
            const currentWidth = targetCanvas.getWidth();
            const currentHeight = targetCanvas.getHeight();
            
            // È´òËß£ÂÉèÂ∫¶„ÅÆÂü∫Ê∫ñ„Çµ„Ç§„Ç∫Ôºà888√ó600Ôºâ„Çí‰ΩøÁî®
            const exportWidth = baseWidth;
            const exportHeight = baseHeight;
            const scale = exportWidth / currentWidth;
            
            // ‰∏ÄÊôÇÁöÑ„Å™È´òËß£ÂÉèÂ∫¶„Ç≠„É£„É≥„Éê„Çπ„Çí‰ΩúÊàê
            const tempCanvas = new fabric.Canvas(null, {
                width: exportWidth * multiplier,
                height: exportHeight * multiplier,
                backgroundColor: targetCanvas.backgroundColor
            });
            
            // È´òËß£ÂÉèÂ∫¶„É¨„É≥„ÉÄ„É™„É≥„Ç∞Ë®≠ÂÆö
            tempCanvas.contextContainer.imageSmoothingEnabled = true;
            tempCanvas.contextContainer.imageSmoothingQuality = 'high';
            
            // „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÇíÈ´òËß£ÂÉèÂ∫¶„Åß„Ç≥„Éî„Éº
            targetCanvas.getObjects().forEach(obj => {
                obj.clone((clonedObj) => {
                    // È´òËß£ÂÉèÂ∫¶Áî®„Å´„Çπ„Ç±„Éº„É´„ÇíË™øÊï¥
                    const originalScale = obj.originalScale || 1;
                    const finalScale = originalScale * scale * multiplier;
                    
                    clonedObj.set({
                        scaleX: finalScale,
                        scaleY: finalScale,
                        left: (obj.originalLeft || obj.left) * scale * multiplier,
                        top: (obj.originalTop || obj.top) * scale * multiplier
                    });
                    
                    tempCanvas.add(clonedObj);
                });
            });
            
            tempCanvas.renderAll();
            
            // „Éá„Éº„ÇøURL„ÇíÂèñÂæó
            const dataURL = tempCanvas.toDataURL('image/png', 1.0);
            
            // ‰∏ÄÊôÇ„Ç≠„É£„É≥„Éê„Çπ„ÇíÁ†¥Ê£Ñ
            tempCanvas.dispose();
            
            return dataURL;
        }
        
        // ÁèæÂú®„ÅÆ„Ç´„Éº„Éâ„Çí„Ç®„ÇØ„Çπ„Éù„Éº„ÉàÔºàÈ´òËß£ÂÉèÂ∫¶ÂØæÂøúÔºâ
        function exportCurrentCard() {
            if (!canvas) {
                alert('„Ç´„Éº„Éâ„ÅåÁîüÊàê„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ');
                return;
            }
            
            try {
                const title = document.getElementById('patternTitle').value || 'pattern-card';
                const safeTitle = title.replace(/[^\w\s-]/g, '').replace(/\s+/g, '-');
                const link = document.createElement('a');
                link.download = `${safeTitle}.png`;
                
                // È´òËß£ÂÉèÂ∫¶„Åß„Ç®„ÇØ„Çπ„Éù„Éº„ÉàÔºà2ÂÄçËß£ÂÉèÂ∫¶Ôºâ
                link.href = exportCanvasAtHighResolution(canvas, 2.0);
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
            } catch (error) {
                console.error('„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Ç®„É©„Éº:', error);
                alert('„Ç´„Éº„Éâ„ÅÆ„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ');
            }
        }
        
        // „Éë„Çø„Éº„É≥„Ç∞„É™„ÉÉ„ÉâÂàùÊúüÂåñ
        function initPatternGrid() {
            const grid = document.getElementById('patternGrid');
            for (let i = 0; i <= 39; i++) {
                const item = document.createElement('div');
                item.className = 'pattern-item';
                
                // „Éë„Çø„Éº„É≥Áï™Âè∑„Å®„Çø„Ç§„Éà„É´„ÇíË°®Á§∫
                const patternTitle = patternData[i] ? patternData[i].title : '„Éë„Çø„Éº„É≥';
                item.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 2px;">${i}</div>
                    <div style="font-size: 9px; line-height: 1.2; text-align: center;">${patternTitle}</div>
                `;
                
                item.onclick = () => togglePatternSelection(i, item);
                grid.appendChild(item);
            }
        }
        
        // „Éë„Çø„Éº„É≥ÈÅ∏ÊäûÂàá„ÇäÊõø„Åà
        function togglePatternSelection(patternId, element) {
            if (selectedPatterns.has(patternId)) {
                selectedPatterns.delete(patternId);
                element.classList.remove('selected');
            } else {
                selectedPatterns.add(patternId);
                element.classList.add('selected');
            }
            updateBatchButton();
        }
        
        // ÂÖ®ÈÅ∏Êäû
        function selectAllPatterns() {
            selectedPatterns.clear();
            for (let i = 0; i <= 39; i++) {
                selectedPatterns.add(i);
            }
            document.querySelectorAll('.pattern-item').forEach(item => item.classList.add('selected'));
            updateBatchButton();
        }
        
        // ÈÅ∏ÊäûËß£Èô§
        function clearSelection() {
            selectedPatterns.clear();
            document.querySelectorAll('.pattern-item').forEach(item => item.classList.remove('selected'));
            updateBatchButton();
        }
        
        // ‰∏ÄÊã¨ÁîüÊàê„Éú„Çø„É≥Êõ¥Êñ∞
        function updateBatchButton() {
            const btn = document.getElementById('generateBatchBtn');
            btn.textContent = `üé® ÈÅ∏Êäû„Åó„Åü„Ç´„Éº„Éâ„Çí‰∏ÄÊã¨ÁîüÊàê (${selectedPatterns.size})`;
            btn.disabled = selectedPatterns.size === 0;
        }
        
        // ‰∏ÄÊã¨ÁîüÊàê
        async function generateBatch() {
            if (selectedPatterns.size === 0) return;
            
            // „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊñπÂºè„ÅÆÂèñÂæó
            const downloadMethod = document.querySelector('input[name="presetDownloadMethod"]:checked').value;
            
            // „Éñ„É©„Ç¶„Ç∂„ÅÆËá™Âãï„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂà∂ÈôêË≠¶Âëä
            if (selectedPatterns.size > 5 && downloadMethod === 'individual') {
                const userConfirm = confirm(`${selectedPatterns.size}ÂÄã„ÅÆ„Éï„Ç°„Ç§„É´„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Åæ„Åô„ÄÇ„Éñ„É©„Ç¶„Ç∂„Åå„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó„Çí„Éñ„É≠„ÉÉ„ÇØ„Åô„ÇãÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇÁ∂öË°å„Åó„Åæ„Åô„ÅãÔºü`);
                if (!userConfirm) return;
            }
            
            let confirmMessage = `${selectedPatterns.size}Êûö„ÅÆ„Éó„É™„Çª„ÉÉ„Éà„Ç´„Éº„Éâ„ÇíÁîüÊàê„Åó„Åæ„Åô„ÄÇ\n`;
            
            if (downloadMethod === 'zip') {
                confirmMessage += `\n„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊñπÂºèÔºöZIP‰∏ÄÊã¨„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ\nZIP„Éï„Ç°„Ç§„É´ÂêçÔºölearning_patterns.zip`;
            } else {
                confirmMessage += `\n„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊñπÂºèÔºöÂÄãÂà•„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ`;
            }
            
            confirmMessage += `\n\n„Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºü`;
            
            const confirmed = confirm(confirmMessage);
            if (!confirmed) return;
            
            if (downloadMethod === 'zip') {
                await generatePresetZipBatch();
            } else {
                await generatePresetIndividualBatch();
            }
        }
        
        // „Éó„É™„Çª„ÉÉ„ÉàÂÄãÂà•„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂá¶ÁêÜ
        async function generatePresetIndividualBatch() {
            const progressBar = document.getElementById('presetProgressBar');
            const progressFill = document.getElementById('presetProgressFill');
            
            progressBar.style.display = 'block';
            
            let completed = 0;
            const total = selectedPatterns.size;
            
            try {
                for (const patternId of selectedPatterns) {
                    // „Éë„Çø„Éº„É≥„Éá„Éº„Çø„ÇíÈÅ©Áî®
                    if (patternData[patternId]) {
                        const data = patternData[patternId];
                        document.getElementById('patternTitle').value = data.title;
                        document.getElementById('patternDescription').value = data.description;
                        document.getElementById('patternContext').value = data.context;
                        document.getElementById('patternSolution').value = data.solution;
                        document.getElementById('patternSelect').value = patternId;
                    }
                    
                    // „Ç´„Éº„ÉâÁîüÊàê
                    updateCard();
                    
                    // „É¨„É≥„ÉÄ„É™„É≥„Ç∞ÂÆå‰∫Ü„ÇíÂæÖ„Å§
                    await new Promise(resolve => setTimeout(resolve, 150));
                    
                    // „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÔºàÈ´òËß£ÂÉèÂ∫¶ÂØæÂøúÔºâ
                    try {
                        const link = document.createElement('a');
                        const filename = `learning_patterns_${patternId}`;
                        link.download = `${filename}.png`;
                        link.href = exportCanvasAtHighResolution(canvas, 2.0);
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                    } catch (error) {
                        console.error(`„Éë„Çø„Éº„É≥${patternId}„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Å´Â§±Êïó:`, error);
                    }
                    
                    completed++;
                    const progress = (completed / total) * 100;
                    progressFill.style.width = progress + '%';
                    
                    // „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÈñìÈöî„ÇíË™øÊï¥Ôºà„Éñ„É©„Ç¶„Ç∂Âà∂ÈôêÂõûÈÅøÔºâ
                    await new Promise(resolve => setTimeout(resolve, 300));
                }
                
                alert(`„Éó„É™„Çª„ÉÉ„Éà„Ç´„Éº„Éâ‰∏ÄÊã¨ÁîüÊàê„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ\nÁîüÊàêÊï∞: ${completed}Êûö`);
                
            } catch (error) {
                console.error('‰∏ÄÊã¨ÁîüÊàê„Ç®„É©„Éº:', error);
                alert('‰∏ÄÊã¨ÁîüÊàê‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ„Éñ„É©„Ç¶„Ç∂„ÅÆ„Ç≥„É≥„ÇΩ„Éº„É´„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
            }
            
            // ÂÆå‰∫ÜÂæå„Å´„Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº„ÇíÈö†„Åô
            setTimeout(() => {
                progressBar.style.display = 'none';
                progressFill.style.width = '0%';
            }, 1000);
        }
        
        // „Éó„É™„Çª„ÉÉ„ÉàZIP‰∏ÄÊã¨„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂá¶ÁêÜ
        async function generatePresetZipBatch() {
            const progressBar = document.getElementById('presetProgressBar');
            const progressFill = document.getElementById('presetProgressFill');
            
            progressBar.style.display = 'block';
            
            let completed = 0;
            const total = selectedPatterns.size;
            
            // JSZip„Ç§„É≥„Çπ„Çø„É≥„Çπ„Çí‰ΩúÊàê
            const zip = new JSZip();
            
            try {
                for (const patternId of selectedPatterns) {
                    // „Éë„Çø„Éº„É≥„Éá„Éº„Çø„ÇíÈÅ©Áî®
                    if (patternData[patternId]) {
                        const data = patternData[patternId];
                        document.getElementById('patternTitle').value = data.title;
                        document.getElementById('patternDescription').value = data.description;
                        document.getElementById('patternContext').value = data.context;
                        document.getElementById('patternSolution').value = data.solution;
                        document.getElementById('patternSelect').value = patternId;
                    }
                    
                    // „Ç´„Éº„ÉâÁîüÊàê
                    updateCard();
                    
                    // „É¨„É≥„ÉÄ„É™„É≥„Ç∞ÂÆå‰∫Ü„ÇíÂæÖ„Å§
                    await new Promise(resolve => setTimeout(resolve, 150));
                    
                    // ÁîªÂÉè„Éá„Éº„Çø„ÇíZIP„Å´ËøΩÂä†ÔºàÈ´òËß£ÂÉèÂ∫¶ÂØæÂøúÔºâ
                    try {
                        const dataURL = exportCanvasAtHighResolution(canvas, 2.0);
                        const base64Data = dataURL.split(',')[1]; // data:image/png;base64, „ÇíÈô§Âéª
                        
                        // „Éï„Ç°„Ç§„É´ÂêçÔºölearning_patterns_{Áï™Âè∑}.png
                        const filename = `learning_patterns_${patternId}.png`;
                        
                        zip.file(filename, base64Data, {base64: true});
                        
                    } catch (error) {
                        console.error(`„Éë„Çø„Éº„É≥${patternId}„ÅÆZIPËøΩÂä†„Å´Â§±Êïó:`, error);
                    }
                    
                    completed++;
                    const progress = (completed / total) * 100;
                    progressFill.style.width = progress + '%';
                    
                    // Âá¶ÁêÜÈñìÈöî„ÇíË™øÊï¥ÔºàZIP„ÅÆÂ†¥Âêà„ÅØÁü≠„ÅèÔºâ
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                // ZIPÁîüÊàê„Å®„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                progressFill.innerHTML = '<span style="color: white; font-size: 12px;">ZIPÁîüÊàê‰∏≠...</span>';
                
                const content = await zip.generateAsync({
                    type: "blob",
                    compression: "DEFLATE",
                    compressionOptions: {
                        level: 6
                    }
                });
                
                // ZIP„Éï„Ç°„Ç§„É´„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                const link = document.createElement('a');
                link.download = 'learning_patterns.zip';
                link.href = URL.createObjectURL(content);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // „Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàURL„ÇíËß£Êîæ
                URL.revokeObjectURL(link.href);
                
                alert(`„Éó„É™„Çª„ÉÉ„Éà„Ç´„Éº„ÉâZIP‰∏ÄÊã¨ÁîüÊàê„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ\nÁîüÊàêÊï∞: ${completed}Êûö\nZIP„Éï„Ç°„Ç§„É´: learning_patterns.zip`);
                
            } catch (error) {
                console.error('ZIP‰∏ÄÊã¨ÁîüÊàê„Ç®„É©„Éº:', error);
                alert('ZIP‰∏ÄÊã¨ÁîüÊàê‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ');
            }
            
            // ÂÆå‰∫ÜÂæå„Å´„Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº„ÇíÈö†„Åô
            setTimeout(() => {
                progressBar.style.display = 'none';
                progressFill.style.width = '0%';
                progressFill.innerHTML = '';
            }, 1000);
        }
        
        // „Éï„Ç©„É≥„ÉàÈñ¢ÈÄ£Ê©üËÉΩ
        
        // WebFont„ÅÆÂãïÁöÑË™≠„ÅøËæº„Åø
        function loadWebFont(fontKey) {
            const font = fontDefinitions[fontKey];
            if (!font.webFont) return Promise.resolve(); // WebFont„Åå‰∏çË¶Å„Å™Â†¥Âêà
            
            return new Promise((resolve, reject) => {
                // Êó¢„Å´Ë™≠„ÅøËæº„ÅøÊ∏à„Åø„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                const existingLink = document.querySelector(`link[href="${font.webFont}"]`);
                if (existingLink) {
                    resolve();
                    return;
                }
                
                // WebFontË™≠„ÅøËæº„Åø
                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = font.webFont;
                link.onload = () => {
                    console.log(`WebFont loaded: ${font.name}`);
                    // „Éï„Ç©„É≥„ÉàË™≠„ÅøËæº„ÅøÂÆå‰∫Ü„Åæ„ÅßÂ∞ë„ÅóÂæÖ„Å§
                    setTimeout(resolve, 200);
                };
                link.onerror = () => {
                    console.warn(`WebFont load failed: ${font.name}`);
                    resolve(); // „Ç®„É©„Éº„Åß„ÇÇÁ∂öË°å
                };
                
                document.head.appendChild(link);
            });
        }
        
        // „Éï„Ç©„É≥„ÉàÂ§âÊõ¥
        async function changeFont() {
            const fontSelect = document.getElementById('fontSelect');
            const selectedFont = fontSelect.value;
            
            try {
                // WebFontË™≠„ÅøËæº„Åø
                await loadWebFont(selectedFont);
                
                // ÁèæÂú®„ÅÆ„Éï„Ç©„É≥„Éà„ÇíÊõ¥Êñ∞
                currentFont = selectedFont;
                
                // „Ç´„Éº„Éâ„ÇíÂÜçÊèèÁîª
                updateCard();
                
                console.log(`„Éï„Ç©„É≥„ÉàÂ§âÊõ¥ÂÆå‰∫Ü: ${fontDefinitions[selectedFont].name}`);
                
            } catch (error) {
                console.error('„Éï„Ç©„É≥„ÉàÂ§âÊõ¥„Ç®„É©„Éº:', error);
                alert('„Éï„Ç©„É≥„Éà„ÅÆÂ§âÊõ¥„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ');
            }
        }
        
        // „Éï„Ç©„É≥„Éà„Éï„Ç°„Éü„É™„Éº„ÇíÂèñÂæó
        function getCurrentFontFamily() {
            return fontDefinitions[currentFont]?.family || fontDefinitions.hiragino.family;
        }
        function resetAll() {
            document.getElementById('patternSelect').value = '';
            document.getElementById('patternTitle').value = '';
            document.getElementById('patternDescription').value = '';
            document.getElementById('patternContext').value = '';
            document.getElementById('patternSolution').value = '';
            document.getElementById('fontSelect').value = 'hiragino'; // „Éï„Ç©„É≥„Éà„ÇÇ„É™„Çª„ÉÉ„Éà
            currentFont = 'hiragino';
            clearSelection();
            clearCSVData(); // CSV„Éá„Éº„Çø„ÇÇ„ÇØ„É™„Ç¢ÔºàÁ∑®ÈõÜ„Çª„ÇØ„Ç∑„Éß„É≥„ÇÇÈùûË°®Á§∫„Å´„Å™„ÇãÔºâ
            updateCard();
        }
        
        // CSVÈñ¢ÈÄ£Ê©üËÉΩ
        
        // CSV„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
        function downloadCSVTemplate() {
            const csvContent = 'pattern_number,title,description,context,solution\n' +
                              '1,„Çµ„É≥„Éó„É´„Éë„Çø„Éº„É≥1,Â≠¶Áøí„Å´Èñ¢„Åô„ÇãË™¨ÊòéÊñá,ÈÅ©Áî®„Åï„Çå„ÇãÂ†¥Èù¢„ÉªÁä∂Ê≥Å,Â∑•Â§´„ÇÑ„Éà„É©„Ç§„Ç¢„É´ÂÜÖÂÆπ\n' +
                              '2,„Çµ„É≥„Éó„É´„Éë„Çø„Éº„É≥2,Â≠¶Áøí„Å´Èñ¢„Åô„ÇãË™¨ÊòéÊñá2,ÈÅ©Áî®„Åï„Çå„ÇãÂ†¥Èù¢„ÉªÁä∂Ê≥Å2,Â∑•Â§´„ÇÑ„Éà„É©„Ç§„Ç¢„É´ÂÜÖÂÆπ2\n' +
                              ',Áã¨Ëá™„Éë„Çø„Éº„É≥,Ë™¨ÊòéÊñáÔºà„Éë„Çø„Éº„É≥Áï™Âè∑„ÅØ‰ªªÊÑèÔºâ,Â†¥Èù¢„ÉªÁä∂Ê≥Å,Â∑•Â§´„Éª„Éà„É©„Ç§„Ç¢„É´';
            
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'pattern_card_template.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // CSV„Éï„Ç°„Ç§„É´„Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÂá¶ÁêÜ
        async function handleCSVUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // „Éï„Ç°„Ç§„É´ÂΩ¢Âºè„ÉÅ„Çß„ÉÉ„ÇØÔºà.csv „Å® .txt ‰∏°ÊñπÂØæÂøúÔºâ
            if (!file.name.match(/\.(csv|txt)$/i)) {
                alert('CSV„Åæ„Åü„ÅØTXT„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\n\nÂØæÂøúÂΩ¢ÂºèÔºö\n‚Ä¢ .csv „Éï„Ç°„Ç§„É´ÔºàExcelÁ≠â„Åß‰ΩúÊàêÔºâ\n‚Ä¢ .txt „Éï„Ç°„Ç§„É´ÔºàClaudeÁ≠â„ÅÆAI„ÉÑ„Éº„É´„Åß‰ΩúÊàêÔºâ');
                return;
            }
            
            try {
                const text = await readFileAsText(file);
                
                // CSVÂΩ¢Âºè„ÅÆÂü∫Êú¨Ê§úË®ºÔºà„Ç´„É≥„ÉûÂå∫Âàá„Çä„Åã„ÉÅ„Çß„ÉÉ„ÇØÔºâ
                if (!text.includes(',')) {
                    alert('„Éï„Ç°„Ç§„É´„ÅåCSVÂΩ¢ÂºèÔºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ\n\nAI„ÉÑ„Éº„É´„Åß‰ΩúÊàê„Åó„ÅüÂ†¥Âêà„ÅØ„ÄÅCSVÂΩ¢Âºè„ÅßÂá∫Âäõ„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\n\nÊ≠£„Åó„ÅÑÂΩ¢Âºè‰æãÔºö\ntitle,description,context,solution,pattern_number');
                    return;
                }
                
                const data = parseCSV(text);
                const validatedData = validateCSVData(data);
                
                if (validatedData.length === 0) {
                    alert('ÊúâÂäπ„Å™„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ\n\n„Éï„Ç°„Ç§„É´„ÅåCSVÂΩ¢Âºè„Åß„ÄÅÂøÖË¶Å„Å™ÂàóÔºàtitle, description, context, solutionÔºâ„ÅåÂê´„Åæ„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                    return;
                }
                
                csvData = validatedData;
                displayCSVPreview(validatedData);
                document.getElementById('generateCSVBtn').style.display = 'inline-flex';
                document.getElementById('fileNameCustomization').style.display = 'flex';
                
            } catch (error) {
                alert('„Éá„Éº„Çø„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ\n\n„Ç®„É©„ÉºË©≥Á¥∞: ' + error.message + '\n\n„Éï„Ç°„Ç§„É´„ÅåCSVÂΩ¢ÂºèÔºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ„Åß‰øùÂ≠ò„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                console.error('„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº:', error);
            }
        }
        
        // „Éï„Ç°„Ç§„É´„Çí„ÉÜ„Ç≠„Çπ„Éà„Å®„Åó„Å¶Ë™≠„ÅøËæº„Åø
        function readFileAsText(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.onerror = () => reject(new Error('„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº'));
                reader.readAsText(file, 'UTF-8');
            });
        }
        
        // CSVËß£Êûê
        function parseCSV(text) {
            const lines = text.split('\n').filter(line => line.trim());
            if (lines.length < 2) {
                throw new Error('CSV„Éï„Ç°„Ç§„É´„Å´„ÅØ„Éò„ÉÉ„ÉÄ„ÉºË°å„Å®„Éá„Éº„ÇøË°å„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ');
            }
            
            const headers = lines[0].split(',').map(h => h.trim().replace(/["']/g, ''));
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = parseCSVLine(lines[i]);
                if (values.length === headers.length) {
                    const row = {};
                    headers.forEach((header, index) => {
                        row[header] = values[index].trim().replace(/["']/g, '');
                    });
                    data.push(row);
                }
            }
            
            return data;
        }
        
        // CSVË°å„ÅÆËß£ÊûêÔºà„Ç´„É≥„Éû„Å®„ÇØ„Ç©„Éº„ÉàÂá¶ÁêÜÔºâ
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"' || char === "'") {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result;
        }
        
        // CSV„Éá„Éº„Çø„Éê„É™„Éá„Éº„Ç∑„Éß„É≥
        function validateCSVData(data) {
            const requiredFields = ['title', 'description', 'context', 'solution'];
            const validated = [];
            
            for (const row of data) {
                // ÂøÖÈ†à„Éï„Ç£„Éº„É´„Éâ„ÉÅ„Çß„ÉÉ„ÇØ
                let isValid = true;
                for (const field of requiredFields) {
                    if (!row[field] || row[field].trim() === '') {
                        console.warn(`Ë°å„Çπ„Ç≠„ÉÉ„Éó: ${field}„ÅåÁ©∫„Åß„Åô`, row);
                        isValid = false;
                        break;
                    }
                }
                
                if (!isValid) continue;
                
                // „Éë„Çø„Éº„É≥Áï™Âè∑„ÅÆÊ≠£Ë¶èÂåñ
                if (!row.pattern_number || row.pattern_number.trim() === '') {
                    row.pattern_number = null;
                } else {
                    // „Éë„Çø„Éº„É≥Áï™Âè∑„ÇíÊñáÂ≠óÂàó„Å®„Åó„Å¶‰øùÊåÅ
                    row.pattern_number = row.pattern_number.trim();
                }
                
                validated.push(row);
            }
            
            return validated;
        }
        
        // CSV„Éó„É¨„Éì„É•„ÉºË°®Á§∫
        function displayCSVPreview(data) {
            const preview = document.getElementById('csvPreview');
            const table = document.getElementById('csvDataTable');
            const stats = document.getElementById('csvStats');
            
            // „ÉÜ„Éº„Éñ„É´ÁîüÊàê
            let html = '<table style="width: 100%; border-collapse: collapse; font-size: 12px;">';
            html += '<thead><tr style="background: #667eea; color: white;">';
            html += '<th style="padding: 8px; border: 1px solid #ddd;">Áï™Âè∑</th>';
            html += '<th style="padding: 8px; border: 1px solid #ddd;">„Çø„Ç§„Éà„É´</th>';
            html += '<th style="padding: 8px; border: 1px solid #ddd;">Ë™¨Êòé</th>';
            html += '<th style="padding: 8px; border: 1px solid #ddd;">Â†¥Èù¢„ÉªÁä∂Ê≥Å</th>';
            html += '<th style="padding: 8px; border: 1px solid #ddd;">Â∑•Â§´„Éª„Éà„É©„Ç§„Ç¢„É´</th>';
            html += '<th style="padding: 8px; border: 1px solid #ddd;">Êìç‰Ωú</th>';
            html += '</tr></thead><tbody>';
            
            data.forEach((row, index) => {
                html += `<tr id="csvRow${index}" style="background: ${index % 2 === 0 ? '#ffffff' : '#f8f9ff'};">`;
                html += `<td style="padding: 6px; border: 1px solid #ddd; text-align: center;">${row.pattern_number || '-'}</td>`;
                html += `<td style="padding: 6px; border: 1px solid #ddd;">${row.title}</td>`;
                html += `<td style="padding: 6px; border: 1px solid #ddd;">${row.description.substring(0, 30)}${row.description.length > 30 ? '...' : ''}</td>`;
                html += `<td style="padding: 6px; border: 1px solid #ddd;">${row.context.substring(0, 25)}${row.context.length > 25 ? '...' : ''}</td>`;
                html += `<td style="padding: 6px; border: 1px solid #ddd;">${row.solution.substring(0, 25)}${row.solution.length > 25 ? '...' : ''}</td>`;
                html += `<td style="padding: 6px; border: 1px solid #ddd; text-align: center;">`;
                html += `<button onclick="editCSVRow(${index})" class="csv-edit-button">‚úèÔ∏è</button>`;
                html += `</td>`;
                html += '</tr>';
            });
            
            html += '</tbody></table>';
            table.innerHTML = html;
            
            // Áµ±Ë®àÊÉÖÂ†±
            const withNumbers = data.filter(row => row.pattern_number).length;
            const withoutNumbers = data.length - withNumbers;
            
            stats.innerHTML = `üìä Ë™≠„ÅøËæº„Åø‰ª∂Êï∞: ${data.length}‰ª∂ | Áï™Âè∑‰ªò„Åç: ${withNumbers}‰ª∂, Áï™Âè∑„Å™„Åó: ${withoutNumbers}‰ª∂ | ‰ΩøÁî®„ÉÜ„É≥„Éó„É¨„Éº„Éà: ${currentTemplate}`;
            
            preview.style.display = 'block';
            document.getElementById('downloadMethodSection').style.display = 'block';
        }
        
        // CSV„Éá„Éº„Çø„ÇØ„É™„Ç¢
        function clearCSVData() {
            csvData = [];
            document.getElementById('csvPreview').style.display = 'none';
            document.getElementById('downloadMethodSection').style.display = 'none';
            document.getElementById('generateCSVBtn').style.display = 'none';
            document.getElementById('fileNameCustomization').style.display = 'none';
            document.getElementById('csvFileInput').value = '';
            document.getElementById('cardGroupName').value = '';
            
            // CSVÁ∑®ÈõÜ„Çª„ÇØ„Ç∑„Éß„É≥„ÇÇÈùûË°®Á§∫„Éª„Éè„Ç§„É©„Ç§„ÉàËß£Èô§
            document.getElementById('csvEditSection').style.display = 'none';
            document.querySelectorAll('.csv-row-editing').forEach(row => {
                row.classList.remove('csv-row-editing');
            });
            editingCSVIndex = -1;
            originalCSVData = null;
        }
        
        // CSV‰∏ÄÊã¨ÁîüÊàê
        async function generateCSVBatch() {
            if (csvData.length === 0) {
                alert('CSV „Éá„Éº„Çø„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ');
                return;
            }
            
            // „Ç´„Éº„Éâ„Ç∞„É´„Éº„ÉóÂêç„ÅÆÂèñÂæó„Å®Ê§úË®º
            const cardGroupName = document.getElementById('cardGroupName').value.trim();
            if (!cardGroupName) {
                alert('„Ç´„Éº„Éâ„Ç∞„É´„Éº„ÉóÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ\n\n‰æãÔºö„Éó„É≠„Ç∏„Çß„ÇØ„ÉàA\n‚Üí„Éï„Ç°„Ç§„É´ÂêçÔºö„Éó„É≠„Ç∏„Çß„ÇØ„ÉàA_1.png');
                document.getElementById('cardGroupName').focus();
                return;
            }
            
            // „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊñπÂºè„ÅÆÂèñÂæó
            const downloadMethod = document.querySelector('input[name="downloadMethod"]:checked').value;
            
            // „Éï„Ç°„Ç§„É´Âêç„Å´‰ΩøÁî®„Åß„Åç„Å™„ÅÑÊñáÂ≠ó„ÇíÂÆâÂÖ®„Å™ÊñáÂ≠ó„Å´Â§âÊèõ
            const safeGroupName = cardGroupName.replace(/[<>:"/\\|?*]/g, '-').replace(/\s+/g, '_');
            
            let confirmMessage = `${csvData.length}Êûö„ÅÆ„Ç´„Éº„Éâ„ÇíÁîüÊàê„Åó„Åæ„Åô„ÄÇ\nÁèæÂú®ÈÅ∏Êäû‰∏≠„ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„Éà„Äå${currentTemplate}„Äç„ÇíÂÖ®„Ç´„Éº„Éâ„Å´ÈÅ©Áî®„Åó„Åæ„Åô„ÄÇ\n„Éï„Ç°„Ç§„É´ÂêçÂΩ¢ÂºèÔºö${safeGroupName}_1.png, ${safeGroupName}_2.png...\n`;
            
            if (downloadMethod === 'zip') {
                confirmMessage += `\n„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊñπÂºèÔºöZIP‰∏ÄÊã¨„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ\nZIP„Éï„Ç°„Ç§„É´ÂêçÔºö${safeGroupName}_pattern_cards.zip`;
            } else {
                confirmMessage += `\n„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÊñπÂºèÔºöÂÄãÂà•„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ`;
            }
            
            confirmMessage += `\n\n„Çà„Çç„Åó„ÅÑ„Åß„Åô„ÅãÔºü\n\n‚Äª„Éñ„É©„Ç¶„Ç∂„Å´„Çà„Å£„Å¶„ÅØ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„ÅåÂà∂Èôê„Åï„Çå„ÇãÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ`;
            
            const confirmed = confirm(confirmMessage);
            if (!confirmed) return;
            
            if (downloadMethod === 'zip') {
                await generateZipBatch(safeGroupName);
            } else {
                await generateIndividualBatch(safeGroupName);
            }
        }
        
        // ÂÄãÂà•„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂá¶ÁêÜ
        async function generateIndividualBatch(safeGroupName) {
            const progressBar = document.getElementById('csvProgressBar');
            const progressFill = document.getElementById('csvProgressFill');
            
            progressBar.style.display = 'block';
            
            // UIÁä∂ÊÖã‰øùÂ≠òÔºà‰∏ÄÊã¨ÁîüÊàê‰∏≠„ÅÆ„Éë„Çø„Éº„É≥ÈÅ∏ÊäûË°®Á§∫Âõ∫ÂÆö„ÅÆ„Åü„ÇÅÔºâ
            const originalPatternValue = document.getElementById('patternSelect').value;
            
            let completed = 0;
            const total = csvData.length;
            
            try {
                for (const [index, row] of csvData.entries()) {
                    // „Éá„Éº„Çø„ÇíÂÖ•Âäõ„Éï„Ç£„Éº„É´„Éâ„Å´Ë®≠ÂÆö
                    document.getElementById('patternTitle').value = row.title;
                    document.getElementById('patternDescription').value = row.description;
                    document.getElementById('patternContext').value = row.context;
                    document.getElementById('patternSolution').value = row.solution;
                    
                    // „Éë„Çø„Éº„É≥Áï™Âè∑„ÇíË®≠ÂÆöÔºàUI„Å´„ÅØÂèçÊò†„Åï„Åõ„Å™„ÅÑÔºâ
                    // Ê≥®ÊÑè: „Éë„Çø„Éº„É≥ÈÅ∏ÊäûUI„ÅØÂ§âÊõ¥„Åõ„Åö„ÄÅÂÜÖÈÉ®ÁöÑ„Å´„ÅÆ„ÅøÂá¶ÁêÜ
                    if (row.pattern_number) {
                        // ÂÜÖÈÉ®ÁöÑ„Å´„Éë„Çø„Éº„É≥Áï™Âè∑„Çí‰øùÊåÅÔºàUI„ÅØÂ§âÊõ¥„Åó„Å™„ÅÑÔºâ
                        // updateCard()„ÅßÂøÖË¶Å„Å™Â†¥Âêà„ÅØÂà•ÈÄîÂØæÂøú
                    }
                    
                    // ÁèæÂú®ÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Çã„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÁ∂≠ÊåÅÔºàÂ§âÊõ¥„Åó„Å™„ÅÑÔºâ
                    // selectTemplate(currentTemplate); // ‰∏çË¶ÅÔºöÊó¢„Å´ÈÅ∏ÊäûÊ∏à„Åø
                    
                    // „Ç´„Éº„ÉâÁîüÊàê
                    updateCard();
                    
                    // „É¨„É≥„ÉÄ„É™„É≥„Ç∞ÂÆå‰∫Ü„ÇíÂæÖ„Å§
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÔºàÊñ∞„Åó„ÅÑ„Éï„Ç°„Ç§„É´ÂëΩÂêçË¶èÂâáÔºâ
                    try {
                        const link = document.createElement('a');
                        // „Ç´„Éº„ÉâÁï™Âè∑„ÅÆÊ±∫ÂÆöÔºàCSVÁï™Âè∑„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØ„Åù„Çå„Çí‰ΩøÁî®„ÄÅ„Å™„Åë„Çå„Å∞ÈÄ£Áï™Ôºâ
                        const cardNumber = row.pattern_number || (index + 1);
                        // Êñ∞„Åó„ÅÑ„Éï„Ç°„Ç§„É´ÂëΩÂêçË¶èÂâáÔºö{„Ç∞„É´„Éº„ÉóÂêç}_{„Ç´„Éº„ÉâÁï™Âè∑}.png
                        const filename = `${safeGroupName}_${cardNumber}`;
                        link.download = `${filename}.png`;
                        link.href = canvas.toDataURL('image/png');
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                    } catch (error) {
                        console.error(`CSVË°å${index + 1}„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Å´Â§±Êïó:`, error);
                    }
                    
                    completed++;
                    const progress = (completed / total) * 100;
                    progressFill.style.width = progress + '%';
                    
                    // „ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÈñìÈöî„ÇíË™øÊï¥
                    await new Promise(resolve => setTimeout(resolve, 400));
                }
                
                alert(`CSV‰∏ÄÊã¨ÁîüÊàê„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ\nÁîüÊàêÊï∞: ${completed}Êûö\n„ÉÜ„É≥„Éó„É¨„Éº„Éà: ${currentTemplate}`);
                
            } catch (error) {
                console.error('CSV‰∏ÄÊã¨ÁîüÊàê„Ç®„É©„Éº:', error);
                alert('CSV‰∏ÄÊã¨ÁîüÊàê‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ');
            }
            
            // UIÁä∂ÊÖãÂæ©ÂÖÉÔºà„Éë„Çø„Éº„É≥ÈÅ∏Êäû„ÇíÂÖÉ„ÅÆÁä∂ÊÖã„Å´Êàª„ÅôÔºâ
            document.getElementById('patternSelect').value = originalPatternValue;
            // ÂÖÉ„ÅÆÁä∂ÊÖã„Åß„Ç´„Éº„ÉâË°®Á§∫„ÇíÊõ¥Êñ∞
            updateCard();
            
            // ÂÆå‰∫ÜÂæå„Å´„Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº„ÇíÈö†„Åô
            setTimeout(() => {
                progressBar.style.display = 'none';
                progressFill.style.width = '0%';
            }, 1000);
        }
        
        // ZIP‰∏ÄÊã¨„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÂá¶ÁêÜ
        async function generateZipBatch(safeGroupName) {
            const progressBar = document.getElementById('csvProgressBar');
            const progressFill = document.getElementById('csvProgressFill');
            
            progressBar.style.display = 'block';
            
            // UIÁä∂ÊÖã‰øùÂ≠òÔºà‰∏ÄÊã¨ÁîüÊàê‰∏≠„ÅÆ„Éë„Çø„Éº„É≥ÈÅ∏ÊäûË°®Á§∫Âõ∫ÂÆö„ÅÆ„Åü„ÇÅÔºâ
            const originalPatternValue = document.getElementById('patternSelect').value;
            
            let completed = 0;
            const total = csvData.length;
            
            // JSZip„Ç§„É≥„Çπ„Çø„É≥„Çπ„Çí‰ΩúÊàê
            const zip = new JSZip();
            
            try {
                for (const [index, row] of csvData.entries()) {
                    // „Éá„Éº„Çø„ÇíÂÖ•Âäõ„Éï„Ç£„Éº„É´„Éâ„Å´Ë®≠ÂÆö
                    document.getElementById('patternTitle').value = row.title;
                    document.getElementById('patternDescription').value = row.description;
                    document.getElementById('patternContext').value = row.context;
                    document.getElementById('patternSolution').value = row.solution;
                    
                    // „Éë„Çø„Éº„É≥Áï™Âè∑„ÇíË®≠ÂÆöÔºàUI„Å´„ÅØÂèçÊò†„Åï„Åõ„Å™„ÅÑÔºâ
                    // Ê≥®ÊÑè: „Éë„Çø„Éº„É≥ÈÅ∏ÊäûUI„ÅØÂ§âÊõ¥„Åõ„Åö„ÄÅÂÜÖÈÉ®ÁöÑ„Å´„ÅÆ„ÅøÂá¶ÁêÜ
                    if (row.pattern_number) {
                        // ÂÜÖÈÉ®ÁöÑ„Å´„Éë„Çø„Éº„É≥Áï™Âè∑„Çí‰øùÊåÅÔºàUI„ÅØÂ§âÊõ¥„Åó„Å™„ÅÑÔºâ
                        // updateCard()„ÅßÂøÖË¶Å„Å™Â†¥Âêà„ÅØÂà•ÈÄîÂØæÂøú
                    }
                    
                    // „Ç´„Éº„ÉâÁîüÊàê
                    updateCard();
                    
                    // „É¨„É≥„ÉÄ„É™„É≥„Ç∞ÂÆå‰∫Ü„ÇíÂæÖ„Å§
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // ÁîªÂÉè„Éá„Éº„Çø„ÇíZIP„Å´ËøΩÂä†
                    try {
                        const dataURL = canvas.toDataURL('image/png');
                        const base64Data = dataURL.split(',')[1]; // data:image/png;base64, „ÇíÈô§Âéª
                        
                        // „Ç´„Éº„ÉâÁï™Âè∑„ÅÆÊ±∫ÂÆöÔºàCSVÁï™Âè∑„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅØ„Åù„Çå„Çí‰ΩøÁî®„ÄÅ„Å™„Åë„Çå„Å∞ÈÄ£Áï™Ôºâ
                        const cardNumber = row.pattern_number || (index + 1);
                        // „Éï„Ç°„Ç§„É´ÂêçÔºö{„Ç∞„É´„Éº„ÉóÂêç}_{„Ç´„Éº„ÉâÁï™Âè∑}.png
                        const filename = `${safeGroupName}_${cardNumber}.png`;
                        
                        zip.file(filename, base64Data, {base64: true});
                        
                    } catch (error) {
                        console.error(`CSVË°å${index + 1}„ÅÆZIPËøΩÂä†„Å´Â§±Êïó:`, error);
                    }
                    
                    completed++;
                    const progress = (completed / total) * 100;
                    progressFill.style.width = progress + '%';
                    
                    // Âá¶ÁêÜÈñìÈöî„ÇíË™øÊï¥ÔºàZIP„ÅÆÂ†¥Âêà„ÅØÁü≠„ÅèÔºâ
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                // ZIPÁîüÊàê„Å®„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                progressFill.innerHTML = '<span style="color: white; font-size: 12px;">ZIPÁîüÊàê‰∏≠...</span>';
                
                const content = await zip.generateAsync({
                    type: "blob",
                    compression: "DEFLATE",
                    compressionOptions: {
                        level: 6
                    }
                });
                
                // ZIP„Éï„Ç°„Ç§„É´„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                const link = document.createElement('a');
                link.download = `${safeGroupName}_pattern_cards.zip`;
                link.href = URL.createObjectURL(content);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // „Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàURL„ÇíËß£Êîæ
                URL.revokeObjectURL(link.href);
                
                alert(`ZIP‰∏ÄÊã¨ÁîüÊàê„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ\nÁîüÊàêÊï∞: ${completed}Êûö\n„ÉÜ„É≥„Éó„É¨„Éº„Éà: ${currentTemplate}\nZIP„Éï„Ç°„Ç§„É´: ${safeGroupName}_pattern_cards.zip`);
                
            } catch (error) {
                console.error('ZIP‰∏ÄÊã¨ÁîüÊàê„Ç®„É©„Éº:', error);
                alert('ZIP‰∏ÄÊã¨ÁîüÊàê‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü„ÄÇ');
            }
            
            // UIÁä∂ÊÖãÂæ©ÂÖÉÔºà„Éë„Çø„Éº„É≥ÈÅ∏Êäû„ÇíÂÖÉ„ÅÆÁä∂ÊÖã„Å´Êàª„ÅôÔºâ
            document.getElementById('patternSelect').value = originalPatternValue;
            // ÂÖÉ„ÅÆÁä∂ÊÖã„Åß„Ç´„Éº„ÉâË°®Á§∫„ÇíÊõ¥Êñ∞
            updateCard();
            
            // ÂÆå‰∫ÜÂæå„Å´„Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº„ÇíÈö†„Åô
            setTimeout(() => {
                progressBar.style.display = 'none';
                progressFill.style.width = '0%';
                progressFill.innerHTML = '';
            }, 1000);
        }
        
        // CSVË°åÁ∑®ÈõÜÊ©üËÉΩ
        let editingCSVIndex = -1;
        let originalCSVData = null;
        
        function editCSVRow(index) {
            if (index < 0 || index >= csvData.length) return;
            
            editingCSVIndex = index;
            const row = csvData[index];
            
            // ‰ª•Ââç„ÅÆÁ∑®ÈõÜË°å„ÅÆ„Éè„Ç§„É©„Ç§„Éà„ÇíÂâäÈô§
            document.querySelectorAll('.csv-row-editing').forEach(row => {
                row.classList.remove('csv-row-editing');
            });
            
            // ÁèæÂú®„ÅÆÁ∑®ÈõÜË°å„Çí„Éè„Ç§„É©„Ç§„Éà
            const currentRow = document.getElementById(`csvRow${index}`);
            if (currentRow) {
                currentRow.classList.add('csv-row-editing');
            }
            
            // Á∑®ÈõÜ„Çª„ÇØ„Ç∑„Éß„É≥„ÇíË°®Á§∫
            document.getElementById('csvEditSection').style.display = 'block';
            
            // Á∑®ÈõÜÊÉÖÂ†±„ÇíË°®Á§∫
            document.getElementById('csvEditInfo').textContent = `Ë°å ${index + 1} / ${csvData.length} „ÇíÁ∑®ÈõÜ‰∏≠ - „É™„Ç¢„É´„Çø„Ç§„É†„Åß„Ç´„Éº„Éâ„Éó„É¨„Éì„É•„Éº„ÅåÊõ¥Êñ∞„Åï„Çå„Åæ„Åô`;
            
            // „Éï„Ç£„Éº„É´„Éâ„Å´ÂÄ§„ÇíË®≠ÂÆö
            document.getElementById('csvEditNumber').value = row.pattern_number || '';
            document.getElementById('csvEditTitle').value = row.title || '';
            document.getElementById('csvEditDescription').value = row.description || '';
            document.getElementById('csvEditContext').value = row.context || '';
            document.getElementById('csvEditSolution').value = row.solution || '';
            
            // ÂÖÉ„ÅÆ„É°„Ç§„É≥„Éï„Ç©„Éº„É†„ÅÆÂÄ§„Çí‰øùÂ≠ò
            originalCSVData = {
                patternSelect: document.getElementById('patternSelect').value,
                patternTitle: document.getElementById('patternTitle').value,
                patternDescription: document.getElementById('patternDescription').value,
                patternContext: document.getElementById('patternContext').value,
                patternSolution: document.getElementById('patternSolution').value
            };
            
            // Á∑®ÈõÜ‰∏≠„ÅÆ„Éá„Éº„Çø„Åß„Ç´„Éº„Éâ„ÇíÊõ¥Êñ∞
            updateCardFromCSVEdit();
            
            // Á∑®ÈõÜ„Çª„ÇØ„Ç∑„Éß„É≥„Å´„Çπ„É†„Éº„Ç∫„Çπ„ÇØ„É≠„Éº„É´
            document.getElementById('csvEditSection').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'nearest' 
            });
        }
        
        function updateCardFromCSVEdit() {
            if (editingCSVIndex === -1) return;
            
            // Á∑®ÈõÜ‰∏≠„ÅÆÂÄ§„Çí„É°„Ç§„É≥„Éï„Ç©„Éº„É†„Å´ÂèçÊò†
            document.getElementById('patternSelect').value = document.getElementById('csvEditNumber').value;
            document.getElementById('patternTitle').value = document.getElementById('csvEditTitle').value;
            document.getElementById('patternDescription').value = document.getElementById('csvEditDescription').value;
            document.getElementById('patternContext').value = document.getElementById('csvEditContext').value;
            document.getElementById('patternSolution').value = document.getElementById('csvEditSolution').value;
            
            // „Ç´„Éº„Éâ„ÇíÊõ¥Êñ∞
            updateCard();
        }
        
        function applyCSVEdit() {
            if (editingCSVIndex === -1) return;
            
            // CSV„Éá„Éº„Çø„ÇíÊõ¥Êñ∞
            csvData[editingCSVIndex] = {
                pattern_number: document.getElementById('csvEditNumber').value || null,
                title: document.getElementById('csvEditTitle').value,
                description: document.getElementById('csvEditDescription').value,
                context: document.getElementById('csvEditContext').value,
                solution: document.getElementById('csvEditSolution').value
            };
            
            // „Éó„É¨„Éì„É•„Éº„ÉÜ„Éº„Éñ„É´„ÇíÊõ¥Êñ∞
            displayCSVPreview(csvData);
            
            // Á∑®ÈõÜÂÆå‰∫Ü
            cancelCSVEdit();
            
            alert('Á∑®ÈõÜÂÜÖÂÆπ„ÇíCSV„Éá„Éº„Çø„Å´ÈÅ©Áî®„Åó„Åæ„Åó„Åü„ÄÇ');
        }
        
        function cancelCSVEdit() {
            // Á∑®ÈõÜË°å„ÅÆ„Éè„Ç§„É©„Ç§„Éà„ÇíÂâäÈô§
            document.querySelectorAll('.csv-row-editing').forEach(row => {
                row.classList.remove('csv-row-editing');
            });
            
            // Á∑®ÈõÜ„Çª„ÇØ„Ç∑„Éß„É≥„ÇíÈùûË°®Á§∫
            document.getElementById('csvEditSection').style.display = 'none';
            editingCSVIndex = -1;
            
            // ÂÖÉ„ÅÆ„Éï„Ç©„Éº„É†ÂÄ§„ÇíÂæ©ÂÖÉ
            if (originalCSVData) {
                document.getElementById('patternSelect').value = originalCSVData.patternSelect;
                document.getElementById('patternTitle').value = originalCSVData.patternTitle;
                document.getElementById('patternDescription').value = originalCSVData.patternDescription;
                document.getElementById('patternContext').value = originalCSVData.patternContext;
                document.getElementById('patternSolution').value = originalCSVData.patternSolution;
                
                // „Ç´„Éº„Éâ„ÇíÂÖÉ„Å´Êàª„Åô
                updateCard();
                
                originalCSVData = null;
            }
        }
        
        // ÂàùÊúüÂåñÔºà„É¨„É≥„ÉÄ„É™„É≥„Ç∞ÂÆå‰∫Ü„ÇíÂæÖ„Å§ÊîπËâØÁâàÔºâ
        function initialize() {
            // Fabric.js„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
            if (typeof fabric === 'undefined') {
                setTimeout(initialize, 100);
                return;
            }
            
            // „É¨„É≥„ÉÄ„É™„É≥„Ç∞ÂÆå‰∫Ü„ÇíÂæÖ„Å£„Å¶„Åã„ÇâÂàùÊúüÂåñ
            requestAnimationFrame(() => {
                setTimeout(() => {
                    initCanvas();
                    initPatternGrid();
                    updateBatchButton();
                    
                    // CSVÊ©üËÉΩ„ÅÆÂàùÊúüÂåñ
                    clearCSVData();
                    
                    // „Éï„Ç©„É≥„ÉàÂàùÊúüÂåñ
                    currentFont = 'hiragino';
                    document.getElementById('fontSelect').value = 'hiragino';
                    
                    // ÂàùÊúüÂåñÂÆå‰∫ÜÂæå„ÄÅ„Åï„Çâ„Å´‰∏ÄÂ∫¶„Ç≠„É£„É≥„Éê„Çπ„Çµ„Ç§„Ç∫„ÇíË™øÊï¥
                    setTimeout(() => {
                        if (canvas) {
                            updateCanvasSize();
                        }
                    }, 100);
                }, 50);
            });
        }
        
        // „Çà„ÇäÁ¢∫ÂÆü„Å™ÂàùÊúüÂåñ„ÅÆ„Åü„ÇÅ„ÅÆË§áÊï∞„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        window.addEventListener('load', initialize);
        
        // DOMÊ∫ñÂÇôÂÆå‰∫ÜÂæå„Å´„ÇÇ‰∫àÂÇôÁöÑ„ÉÅ„Çß„ÉÉ„ÇØ
        document.addEventListener('DOMContentLoaded', () => {
            // load„Ç§„Éô„É≥„Éà„ÅßÂàùÊúüÂåñ„Åó„Å¶„ÅÑ„Å™„Åë„Çå„Å∞ÂÆüË°å
            setTimeout(() => {
                if (!canvas) {
                    console.log('DOMContentLoadedÂæå„ÅÆ‰∫àÂÇôÁöÑÂàùÊúüÂåñ„ÇíÂÆüË°å');
                    initialize();
                }
            }, 100);
        });

        // AIÊ¥ªÁî®„Ç¨„Ç§„ÉâÈñ¢ÈÄ£„ÅÆÈñ¢Êï∞
        function toggleAIGuide() {
            const content = document.getElementById('aiGuideContent');
            const toggle = document.getElementById('aiGuideToggle');
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                toggle.classList.remove('expanded');
                toggle.textContent = '‚ñº';
            } else {
                content.classList.add('expanded');
                toggle.classList.add('expanded');
                toggle.textContent = '‚ñ≤';
            }
        }

        function copyTemplate(button, type) {
            const textarea = button.previousElementSibling;
            const text = textarea.value;
            
            // „ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº
            navigator.clipboard.writeText(text).then(() => {
                // „Éú„Çø„É≥„ÅÆË°®Á§∫„ÇíÂ§âÊõ¥
                const originalText = button.textContent;
                button.textContent = '‚úì „Ç≥„Éî„ÉºÂÆå‰∫Ü!';
                button.classList.add('copied');
                
                // „Çπ„ÉÜ„ÉÉ„Éó2„Å´ÈÄ≤„ÇÄ
                updateStepIndicator(2);
                
                // 3ÁßíÂæå„Å´ÂÖÉ„Å´Êàª„Åó„Å¶„Çπ„ÉÜ„ÉÉ„Éó3„Å´ÈÄ≤„ÇÄ
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                    updateStepIndicator(3);
                }, 3000);
            }).catch(err => {
                // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ: „ÉÜ„Ç≠„Çπ„Éà„ÇíÈÅ∏Êäû
                textarea.select();
                textarea.setSelectionRange(0, 99999);
                document.execCommand('copy');
                
                const originalText = button.textContent;
                button.textContent = '‚úì „Ç≥„Éî„ÉºÂÆå‰∫Ü!';
                button.classList.add('copied');
                
                // „Çπ„ÉÜ„ÉÉ„Éó2„Å´ÈÄ≤„ÇÄ
                updateStepIndicator(2);
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.classList.remove('copied');
                    updateStepIndicator(3);
                }, 3000);
            });
        }

        // Êñ∞„Åó„ÅÑÊîπÂñÑÊ©üËÉΩ

        // „Çπ„ÉÜ„ÉÉ„ÉóË°®Á§∫„ÅÆÊõ¥Êñ∞
        function updateStepIndicator(currentStep) {
            document.querySelectorAll('.step-item').forEach((item, index) => {
                item.classList.remove('active', 'completed');
                if (index + 1 < currentStep) {
                    item.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    item.classList.add('active');
                }
            });
            
            // ÁèæÂú®„ÅÆ„Çπ„ÉÜ„ÉÉ„ÉóÊÉÖÂ†±„ÇíÊõ¥Êñ∞
            const stepInfo = document.getElementById('currentStepInfo');
            if (stepInfo) {
                const stepTexts = {
                    1: {
                        icon: 'üìù',
                        title: '„Çπ„ÉÜ„ÉÉ„Éó1Ôºö„Éó„É≠„É≥„Éó„Éà„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÈÅ∏Êäû',
                        description: '‰ª•‰∏ã„Åã„ÇâÁõÆÁöÑ„Å´Âêà„Å£„Åü„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑ„ÄÇÊõ∏Á±çÂêç„ÇÑ„ÉÜ„Éº„Éû„ÇíÊåáÂÆö„Åô„Çã„Å†„Åë„Åß„ÄÅAI„ÅåËá™ÂãïÁöÑ„Å´„Éë„Çø„Éº„É≥„Ç´„Éº„Éâ„ÅÆ„Éá„Éº„Çø„ÇíÁîüÊàê„Åó„Åæ„Åô„ÄÇ'
                    },
                    2: {
                        icon: 'ü§ñ',
                        title: '„Çπ„ÉÜ„ÉÉ„Éó2ÔºöAI„ÉÑ„Éº„É´„Åß„Éó„É≠„É≥„Éó„Éà„ÇíÂÆüË°å',
                        description: '„Ç≥„Éî„Éº„Åó„Åü„Éó„É≠„É≥„Éó„Éà„ÇíChatGPT„ÇÑClaudeÁ≠â„ÅÆAI„ÉÑ„Éº„É´„Å´Ë≤º„Çä‰ªò„Åë„Å¶ÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ'
                    },
                    3: {
                        icon: 'üìÅ',
                        title: '„Çπ„ÉÜ„ÉÉ„Éó3ÔºöÁîüÊàê„Åï„Çå„Åü„Éï„Ç°„Ç§„É´„ÇíË™≠„ÅøËæº„Åø',
                        description: 'AI„ÅåÁîüÊàê„Åó„ÅüCSV„Éï„Ç°„Ç§„É´„Çí‰∏ãË®ò„ÅÆ„Ç®„É™„Ç¢„Å´„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó„Åô„Çã„Åã„ÄÅ„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ'
                    },
                    4: {
                        icon: 'üé®',
                        title: '„Çπ„ÉÜ„ÉÉ„Éó4Ôºö„Éë„Çø„Éº„É≥„Ç´„Éº„Éâ„ÇíÁîüÊàê',
                        description: '„Éá„Éº„Çø„ÅåÊ≠£Â∏∏„Å´Ë™≠„ÅøËæº„Åæ„Çå„Åæ„Åó„Åü„ÄÇ„ÄåCSV„Éá„Éº„Çø„Çí‰∏ÄÊã¨ÁîüÊàê„Äç„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Ç´„Éº„Éâ„Çí‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ'
                    }
                };
                
                const stepData = stepTexts[currentStep];
                if (stepData) {
                    stepInfo.innerHTML = `
                        <div class="step-icon">${stepData.icon}</div>
                        <div class="step-description">
                            <strong>${stepData.title}</strong>
                            <p>${stepData.description}</p>
                        </div>
                    `;
                }
            }
        }

        // „ÉÜ„É≥„Éó„É¨„Éº„Éà„É¢„Éº„ÉâÂàá„ÇäÊõø„Åà
        function switchTemplateMode(mode) {
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[onclick*="${mode}"]`).classList.add('active');
            
            if (mode === 'simple') {
                document.getElementById('simpleTemplates').style.display = 'block';
                document.getElementById('detailedTemplates').style.display = 'none';
            } else {
                document.getElementById('simpleTemplates').style.display = 'none';
                document.getElementById('detailedTemplates').style.display = 'block';
            }
        }

        // Ë©≥Á¥∞„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíË°®Á§∫
        function showDetailedTemplate(type) {
            switchTemplateMode('detailed');
            // Ë©≤ÂΩì„Åô„Çã„ÉÜ„É≥„Éó„É¨„Éº„Éà„Å´„Çπ„ÇØ„É≠„Éº„É´
            const detailedSection = document.getElementById('detailedTemplates');
            detailedSection.scrollIntoView({ behavior: 'smooth' });
        }

        // AI„Éò„É´„ÉóË°®Á§∫
        function showAIHelp() {
            const helpContent = `
                <h3>ü§ñ AI„ÇíÊ¥ªÁî®„Åó„Åü„Éë„Çø„Éº„É≥„Ç´„Éº„Éâ‰ΩúÊàê„ÅÆÊµÅ„Çå</h3>
                
                <h3>1Ô∏è‚É£ „ÉÜ„É≥„Éó„É¨„Éº„ÉàÈÅ∏Êäû</h3>
                <ul>
                    <li>ÁõÆÁöÑ„Å´Âøú„Åò„Åü„Éó„É≠„É≥„Éó„Éà„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÈÅ∏Êäû</li>
                    <li>Êõ∏Á±çÂêç„ÄÅURL„ÄÅ„ÉÜ„Éº„Éû„Å™„Å©„ÇíÂÖ∑‰ΩìÁöÑ„Å´ÊåáÂÆö</li>
                </ul>

                <h3>2Ô∏è‚É£ AI„ÉÑ„Éº„É´„ÅßÂÆüË°å</h3>
                <ul>
                    <li>ChatGPT„ÄÅClaude„ÄÅGeminiÁ≠â„ÅÆAI„ÉÑ„Éº„É´„Çí‰ΩøÁî®</li>
                    <li>„Éó„É≠„É≥„Éó„Éà„Çí„Åù„ÅÆ„Åæ„ÅæË≤º„Çä‰ªò„Åë„Å¶ÂÆüË°å</li>
                    <li>CSV„Éï„Ç°„Ç§„É´„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Çí‰æùÈ†º</li>
                </ul>

                <h3>3Ô∏è‚É£ „Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø</h3>
                <ul>
                    <li>ÁîüÊàê„Åï„Çå„ÅüCSV„Åæ„Åü„ÅØTXT„Éï„Ç°„Ç§„É´„ÇíË™≠„ÅøËæº„Åø</li>
                    <li>„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó„Åæ„Åü„ÅØ„Éï„Ç°„Ç§„É´ÈÅ∏Êäû</li>
                </ul>

                <h3>4Ô∏è‚É£ „Ç´„Éº„ÉâÁîüÊàê</h3>
                <ul>
                    <li>„Éá„Éº„ÇøÁ¢∫Ë™çÂæå„ÄÅ‰∏ÄÊã¨ÁîüÊàê„Éú„Çø„É≥„Çí„ÇØ„É™„ÉÉ„ÇØ</li>
                    <li>„ÅäÂ•Ω„Åø„ÅÆ„Éá„Ç∂„Ç§„É≥„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅßÂá∫Âäõ</li>
                </ul>

                <h3>üí° „Çà„Åè„ÅÇ„ÇãË≥™Âïè</h3>
                <ul>
                    <li><strong>Q: „Å©„ÅÆAI„ÉÑ„Éº„É´„Åå‰Ωø„Åà„Åæ„Åô„ÅãÔºü</strong><br>
                        A: ChatGPT„ÄÅClaude„ÄÅGeminiÁ≠â„ÄÅ‰∏ªË¶Å„Å™AI„ÉÑ„Éº„É´„ÅßÂà©Áî®ÂèØËÉΩ</li>
                    <li><strong>Q: .txt„Éï„Ç°„Ç§„É´„Åß„ÇÇÂ§ß‰∏àÂ§´Ôºü</strong><br>
                        A: „ÅØ„ÅÑ„ÄÇCSVÂΩ¢Âºè„ÅÆÂÜÖÂÆπ„Åß„ÅÇ„Çå„Å∞.txt„Éï„Ç°„Ç§„É´„ÇÇË™≠„ÅøËæº„ÅøÂèØËÉΩ</li>
                    <li><strong>Q: „Ç®„É©„Éº„ÅåÂá∫„ÅüÂ†¥Âêà„ÅØÔºü</strong><br>
                        A: „Éï„Ç°„Ç§„É´ÂΩ¢Âºè„ÇÑ„Éá„Éº„ÇøÂΩ¢Âºè„ÇíÁ¢∫Ë™ç„Åó„ÄÅ„ÉÜ„É≥„Éó„É¨„Éº„Éà„Å®Âêå„ÅòÂΩ¢Âºè„Åã„ÉÅ„Çß„ÉÉ„ÇØ</li>
                </ul>
            `;
            
            showModal('AI„ÇíÊ¥ªÁî®„Åó„Åü„Éë„Çø„Éº„É≥„Ç´„Éº„Éâ‰ΩúÊàê„Ç¨„Ç§„Éâ', helpContent);
        }

        // CSV„Éò„É´„ÉóË°®Á§∫
        function showCSVHelp() {
            const helpContent = `
                <h3>üìÅ CSVË™≠„ÅøËæº„ÅøÊ©üËÉΩ„ÅÆ‰Ωø„ÅÑÊñπ</h3>
                
                <h3>üìÅ ÂØæÂøú„Éï„Ç°„Ç§„É´ÂΩ¢Âºè</h3>
                <ul>
                    <li><strong>.csv „Éï„Ç°„Ç§„É´:</strong> ExcelÁ≠â„Åß‰ΩúÊàê„Åó„ÅüÊ®ôÊ∫ñÁöÑ„Å™CSV„Éï„Ç°„Ç§„É´</li>
                    <li><strong>.txt „Éï„Ç°„Ç§„É´:</strong> AI„ÉÑ„Éº„É´„Åß‰ΩúÊàê„Åï„Çå„Åü„ÉÜ„Ç≠„Çπ„Éà„Éï„Ç°„Ç§„É´</li>
                </ul>
                <p>‚Äª„Å©„Å°„Çâ„ÇÇCSVÂΩ¢ÂºèÔºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ„ÅÆÂÜÖÂÆπ„ÅåÂøÖË¶Å</p>

                <h3>üìã ÂøÖË¶Å„Å™„Éá„Éº„ÇøÂΩ¢Âºè</h3>
                <p><code>pattern_number,title,description,context,solution</code></p>

                <h3>üîß „Éà„É©„Éñ„É´„Ç∑„É•„Éº„ÉÜ„Ç£„É≥„Ç∞</h3>
                <ul>
                    <li><strong>„Éï„Ç°„Ç§„É´„ÅåË™≠„ÅøËæº„ÇÅ„Å™„ÅÑÂ†¥Âêà</strong><br>
                        ‚Üí „Éï„Ç°„Ç§„É´ÂΩ¢Âºè„Å®„Éá„Éº„ÇøÂΩ¢Âºè„ÇíÁ¢∫Ë™ç<br>
                        ‚Üí ÊñáÂ≠ó„Ç®„É≥„Ç≥„Éº„Éâ„ÇíUTF-8„Å´Ë®≠ÂÆö</li>
                    <li><strong>„Éá„Éº„Çø„ÅåÊ≠£„Åó„ÅèË°®Á§∫„Åï„Çå„Å™„ÅÑÂ†¥Âêà</strong><br>
                        ‚Üí CSVÂΩ¢ÂºèÔºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ„Å´„Å™„Å£„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç<br>
                        ‚Üí ÂêÑÈ†ÖÁõÆ„Å´„ÉÄ„Éñ„É´„ÇØ„Ç©„Éº„Éà„ÅåÂê´„Åæ„Çå„Å¶„ÅÑ„Å™„ÅÑ„ÅãÁ¢∫Ë™ç</li>
                    <li><strong>ÊñáÂ≠óÂåñ„Åë„Åô„ÇãÂ†¥Âêà</strong><br>
                        ‚Üí „Éï„Ç°„Ç§„É´„Çí‰∏ÄÂ∫¶„ÉÜ„Ç≠„Çπ„Éà„Ç®„Éá„Ç£„Çø„ÅßÈñã„Åç„ÄÅUTF-8„Åß‰øùÂ≠ò„ÅóÁõ¥„Åô</li>
                </ul>
            `;
            
            showModal('CSVË™≠„ÅøËæº„ÅøÊ©üËÉΩ„Ç¨„Ç§„Éâ', helpContent);
        }

        // „Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„ÉóÊ©üËÉΩ
        function setupDragAndDrop() {
            const dropZone = document.getElementById('csvDropZone');
            
            dropZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                dropZone.classList.add('dragover');
            });
            
            dropZone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
            });
            
            dropZone.addEventListener('drop', (e) => {
                e.preventDefault();
                dropZone.classList.remove('dragover');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    const file = files[0];
                    if (file.name.match(/\.(csv|txt)$/i)) {
                        // „Éï„Ç°„Ç§„É´ÂÖ•ÂäõË¶ÅÁ¥†„Å´Ë®≠ÂÆö
                        const input = document.getElementById('csvFileInput');
                        const dt = new DataTransfer();
                        dt.items.add(file);
                        input.files = dt.files;
                        
                        // „Ç¢„ÉÉ„Éó„É≠„Éº„ÉâÂá¶ÁêÜ„ÇíÂÆüË°å
                        handleCSVUpload({ target: input });
                    } else {
                        showError('CSV„Åæ„Åü„ÅØTXT„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ', 'ÂØæÂøúÂΩ¢ÂºèÔºö.csv„ÄÅ.txtÔºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÂΩ¢ÂºèÔºâ');
                    }
                }
            });
        }

        // „Ç®„É©„ÉºË°®Á§∫„ÅÆÊîπÂñÑ
        function showError(message, solution = '') {
            const errorPanel = document.createElement('div');
            errorPanel.className = 'error-panel';
            errorPanel.innerHTML = `
                <div class="error-icon">‚ö†Ô∏è</div>
                <div class="error-content">
                    <div class="error-message">${message}</div>
                    ${solution ? `<div class="error-solution">üí° ${solution}</div>` : ''}
                </div>
            `;
            
            // Êó¢Â≠ò„ÅÆ„Ç®„É©„Éº„Éë„Éç„É´„ÇíÂâäÈô§
            const existingError = document.querySelector('.error-panel');
            if (existingError) {
                existingError.remove();
            }
            
            // CSV„Çª„ÇØ„Ç∑„Éß„É≥„ÅÆÊúÄÂàù„Å´ÊåøÂÖ•
            const csvSection = document.querySelector('.csv-section');
            csvSection.insertBefore(errorPanel, csvSection.children[1]);
            
            // 3ÁßíÂæå„Å´Ëá™ÂãïÂâäÈô§
            setTimeout(() => {
                if (errorPanel.parentNode) {
                    errorPanel.remove();
                }
            }, 5000);
        }

        // ÊàêÂäü„É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫
        function showSuccess(message) {
            const successPanel = document.createElement('div');
            successPanel.className = 'success-panel';
            successPanel.innerHTML = `
                <div class="success-icon">‚úÖ</div>
                <div class="error-content">
                    <div class="error-message" style="color: #38a169;">${message}</div>
                </div>
            `;
            
            // Êó¢Â≠ò„ÅÆ„Éë„Éç„É´„ÇíÂâäÈô§
            const existingPanels = document.querySelectorAll('.error-panel, .success-panel');
            existingPanels.forEach(panel => panel.remove());
            
            // CSV„Çª„ÇØ„Ç∑„Éß„É≥„ÅÆÊúÄÂàù„Å´ÊåøÂÖ•
            const csvSection = document.querySelector('.csv-section');
            csvSection.insertBefore(successPanel, csvSection.children[1]);
            
            // 3ÁßíÂæå„Å´Ëá™ÂãïÂâäÈô§
            setTimeout(() => {
                if (successPanel.parentNode) {
                    successPanel.remove();
                }
            }, 3000);
        }

        // „Çª„ÇØ„Ç∑„Éß„É≥Èñì„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥
        function scrollToSection(sectionId) {
            const section = document.querySelector(`.${sectionId}`);
            if (section) {
                section.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
                
                // „Çª„ÇØ„Ç∑„Éß„É≥„Çí„Éè„Ç§„É©„Ç§„Éà
                section.style.transition = 'all 0.5s ease';
                section.style.transform = 'scale(1.02)';
                section.style.boxShadow = '0 8px 25px rgba(102, 126, 234, 0.15)';
                
                setTimeout(() => {
                    section.style.transform = 'scale(1)';
                    section.style.boxShadow = 'none';
                }, 1000);
            }
        }

        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            setupDragAndDrop();
            updateStepIndicator(1);
        });

        // Êó¢Â≠ò„ÅÆhandleCSVUploadÈñ¢Êï∞„ÇíÊã°ÂºµÔºàÊàêÂäüÊôÇ„ÅÆÂá¶ÁêÜ„ÇíËøΩÂä†Ôºâ
        const originalHandleCSVUpload = handleCSVUpload;
        handleCSVUpload = async function(event) {
            try {
                await originalHandleCSVUpload(event);
                // ÊàêÂäüÊôÇ„Å´„Çπ„ÉÜ„ÉÉ„Éó4„Å´ÈÄ≤„ÇÄ
                if (csvData.length > 0) {
                    updateStepIndicator(4);
                    showSuccess(`‚úÖ ${csvData.length}‰ª∂„ÅÆ„Éá„Éº„Çø„ÇíÊ≠£Â∏∏„Å´Ë™≠„ÅøËæº„Åø„Åæ„Åó„Åü`);
                }
            } catch (error) {
                showError('„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ', '„Éï„Ç°„Ç§„É´ÂΩ¢Âºè„Å®„Éá„Éº„ÇøÂÜÖÂÆπ„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                updateStepIndicator(3);
            }
        };

        // „Ç´„Çπ„Çø„É†„É¢„Éº„ÉÄ„É´Ë°®Á§∫
        function showModal(title, content) {
            document.getElementById('modalTitle').innerText = title;
            document.getElementById('modalBody').innerHTML = content;
            document.getElementById('customModal').style.display = 'block';
        }

        // „É¢„Éº„ÉÄ„É´Èñâ„Åò„Çã
        function closeModal() {
            document.getElementById('customModal').style.display = 'none';
        }

        // „É¢„Éº„ÉÄ„É´Â§ñ„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã
        window.onclick = function(event) {
            const modal = document.getElementById('customModal');
            if (event.target === modal) {
                closeModal();
            }
        };
    </script>

    <!-- „Ç´„Çπ„Çø„É†„É¢„Éº„ÉÄ„É´ -->
    <div id="customModal" class="custom-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">„Éò„É´„Éó</div>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- „Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅåJavaScript„ÅßÊåøÂÖ•„Åï„Çå„Çã -->
            </div>
        </div>
    </div>

</body>
</html>
